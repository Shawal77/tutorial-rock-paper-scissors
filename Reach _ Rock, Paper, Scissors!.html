<!DOCTYPE html>
<!-- saved from url=(0030)https://docs.reach.sh/tut/rps/ -->
<html lang="en" class="night"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Reach &gt; Rock, Paper, Scissors!</title><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-149147406-2"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-149147406-2")</script><script>window.addEventListener("keydown",e=>{var e=e["code"];"Slash"===e&&document.getElementById("search-icon").click()});const initializeThemeSwitcher=()=>{const e=document.documentElement["classList"],t=document.getElementById("themeToggler");window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?(e.add("night"),t.innerHTML='<i class="fas fa-sun fa-lg"></i>'):(e.add("day"),t.innerHTML='<i class="fas fa-moon fa-lg"></i>')},setDisplayStyleFor=e=>{var t=localStorage.getItem(e);document.getElementById(e).style.display=t};window.onload=e=>{initializeThemeSwitcher(),setDisplayStyleFor("book-col"),setDisplayStyleFor("otp-col")};const setItemToBlock=(e,t)=>{localStorage.setItem(t,"block")},setItemToNone=(e,t)=>{localStorage.setItem(t,"none")},toggleTheme=()=>{const e=document.documentElement["classList"],t=document.getElementById("themeToggler");e.contains("day")?(e.replace("day","night"),t.innerHTML='<i class="fas fa-sun fa-lg"></i>'):e.contains("night")&&(e.replace("night","day"),t.innerHTML='<i class="fas fa-moon fa-lg"></i>')}</script><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/png" href="https://docs.reach.sh/assets/favicon.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="./Reach _ Rock, Paper, Scissors!_files/reset-min.css" integrity="sha256-t2ATOGCtAIZNnzER679jwcFcKYfLlw01gli6F6oszk8=" crossorigin="anonymous"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"><link rel="stylesheet" href="./Reach _ Rock, Paper, Scissors!_files/styles.css"></head><body class="container-fluid noscroll"><div class="row"><header class="navbar navbar-expand-lg navbar-dark bg-dark" role="navigation"><a class="navbar-brand" href="https://docs.reach.sh/#reach-top"><img src="./Reach _ Rock, Paper, Scissors!_files/logo.png" width="32" height="26" alt="logo"></a><a id="mi-home" class="navbar-brand" href="https://docs.reach.sh/#reach-top">Reach</a> <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-expanded="false"><span class="navbar-toggler-icon"></span></button><div class="navbar-collapse collapse" id="navbar-collapse" style=""><div class="navbar-nav me-auto"><a class="nav-link follow" href="https://docs.reach.sh/rsh/#ref-programs">Language</a> <a class="nav-link follow" href="https://docs.reach.sh/frontend/#ref-frontends">Frontends</a> <a class="nav-link follow" href="https://docs.reach.sh/tut/#tuts">Tutorials</a> <a class="nav-link follow" href="https://docs.reach.sh/changelog/#guide-changelog">Changelog</a></div><div class="navbar-nav"><a class="nav-link follow" href="https://reach.sh/">reach.sh</a></div><div class="navbar-nav" style="cursor:pointer"><li class="nav-item nav-link"><a class="nav-link-a" id="themeToggler" onclick="toggleTheme()"><i class="fas fa-sun fa-lg"></i></a> <a class="nav-link-a follow" href="https://github.com/reach-sh/reach-lang/discussions"><i class="fas fa-comments fa-lg"></i></a> <a class="nav-link-a follow" href="https://discord.com/invite/AZsgcXu"><i class="fab fa-discord fa-lg"></i></a> <a class="nav-link-a follow" href="https://github.com/reach-sh/reach-lang"><i class="fab fa-github fa-lg"></i></a> <a class="nav-link-a follow" href="https://twitter.com/reachlang"><i class="fab fa-twitter fa-lg"></i></a> <a class="nav-link-a follow" href="https://www.youtube.com/c/Reachsh"><i class="fab fa-youtube fa-lg"></i></a> <a class="nav-link-a follow" href="https://www.reddit.com/r/reach_sh"><i class="fab fa-reddit-square fa-lg"></i></a></li></div><div class="navbar-nav ms-1 ms-lg-2" style="cursor:pointer"><a class="nav-link follow" href="https://docs.reach.sh/search/#search"><i class="fas fa-search fa-lg" id="search-icon"></i></a></div></div></header></div><main class="row"><div id="book-col" class="col display" style="display: none; max-width: 280px;"><div class="col-auto x-icon-col" style="float:right;display:flex"><button class="btn btn-outline-secondary btn-sm hide-book-icon" onclick="setItemToNone(event,&quot;book-col&quot;)"><img alt="close left sidebar" src="./Reach _ Rock, Paper, Scissors!_files/Colorway=Light Mode, State=Hover, Action=Collapse.svg"></button></div><div class="bookCrumbs dynamic"><div class="row chapter dynamic"><div class="col-auto chapter-icon-col"><i class="fas fa-angle-down"></i></div><div class="col my-auto"><a class="book-title" href="https://docs.reach.sh/">Reach</a></div></div><div class="row chapter dynamic"><div class="col-auto chapter-icon-col"><i class="fas fa-angle-down"></i></div><div class="col my-auto"><a class="book-title" href="https://docs.reach.sh/tut/">Tutorials</a></div></div></div><div class="row chapter dynamic"><div class="col-auto chapter-empty-col"></div><div class="col"><a class="chapter-title" href="https://docs.reach.sh/tut/overview/">Overview</a></div></div><div class="row chapter dynamic"><div class="col-auto chapter-empty-col"></div><div class="col"><a class="chapter-title" href="https://docs.reach.sh/tut/wfs/">Wisdom For Sale</a></div></div><div class="row chapter dynamic"><div class="col-auto chapter-icon-col"><i class="chapter-icon fas fa-angle-down"></i></div><div class="col"><a class="chapter-title active" href="https://docs.reach.sh/tut/rps/">Rock, Paper, Scissors!</a><div class="pages" style="display: block;"><div class="row chapter dynamic"><div class="col-auto chapter-empty-col"></div><div class="col"><a class="chapter-title" href="https://docs.reach.sh/tut/rps/7-rpc/">Rock, Paper, Scissors in Python</a></div></div></div></div></div></div><div id="page-col" class="col display" style="display: block;"><div id="hh-viewer-wrapper" style="margin-right:auto;margin-left:auto"><div id="hh-page-header" style="display: block;"><div class="row"><div class="col-auto show-book-col pe-0" style="display: block;"><button class="btn btn-outline-secondary btn-sm show-book-col" onclick="setItemToBlock(event,&quot;book-col&quot;)"><img alt="expand left sidebar" src="./Reach _ Rock, Paper, Scissors!_files/Colorway=Dark Mode, State=Hover, Action=Expand.svg"></button></div><div class="col"><div class="row"><div class="col"><span class="title refHeader refHeader" id="tut">Rock, Paper, Scissors!<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut"><span class="icon icon-link"></span></a></span></div><div class="col-auto"><div class="btn-group btn-group-sm" role="group" aria-label=""><a id="edit-btn" class="btn btn-outline-secondary btn-sm" href="https://github.com/reach-sh/reach-lang/tree/master/docs/src/tut/rps/index.md"><i class="fas fa-pencil-alt"></i></a> <button class="btn btn-outline-secondary btn-sm show-otp-col" onclick="setItemToBlock(event,&quot;otp-col&quot;)" style="display: block;"><img alt="open right sidebar" src="./Reach _ Rock, Paper, Scissors!_files/Colorway=Light Mode, State=Hover, Action=Collapse.svg"></button></div></div></div></div></div></div><div id="hh-viewer">
<p>
  <i id="p_0" class="pid"></i>This tutorial walks through the creation of a simple decentralized application.
  It contains everything you need to know to build and test this application and assumes no prior experience with DApp/blockchain development of any kind.
  If you want a broad overview before diving in it, we recommend reading <a href="https://docs.reach.sh/tut/overview/#overview">the overview</a> first.
  On the other hand, if this is too simple, then you may want to start <a href="https://docs.reach.sh/workshop/#workshop">the workshop</a> for larger and less constrained projects or <a href="https://docs.reach.sh/tool/#ref">the reference manual</a> for the minute details of Reach.<a href="https://docs.reach.sh/tut/rps/#p_0" class="pid">0</a>
</p>
<p><i id="p_1" class="pid"></i>If you're ready, click through to the <a href="https://docs.reach.sh/tut/rps/#tut-1">first step</a>!<a href="https://docs.reach.sh/tut/rps/#p_1" class="pid">1</a></p>
<h2 id="tut-1" class="refHeader">Install and Initialize<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-1"><span class="icon icon-link"></span></a></h2>
<p>
  <i id="p_2" class="pid"></i>Reach is designed to work on POSIX systems with <a href="https://en.wikipedia.org/wiki/Make_(software)">make</a>, <a href="https://www.docker.com/get-started">Docker</a>, and <a href="https://docs.docker.com/compose/install/">Docker Compose</a> installed.
  The best way to install Docker on Mac and Windows is with <a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a>.<a href="https://docs.reach.sh/tut/rps/#p_2" class="pid">2</a>
</p>
<div class="note">
  <p>
    <i id="p_3" class="pid"></i>You probably already have <code>make</code> installed.
    For example, OS X and many other POSIX systems come with <code>make</code>, but some versions of Linux do not include it by default and will require you to install it.
    If you're on Ubuntu, you can run <code>sudo apt install make</code> to get it.<a href="https://docs.reach.sh/tut/rps/#p_3" class="pid">3</a>
  </p>
</div>
<p><i id="p_4" class="pid"></i>You'll know that you have everything installed if you can run the following three commands without errors<a href="https://docs.reach.sh/tut/rps/#p_4" class="pid">4</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="make --version" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> make </span><span style="color: var(--shiki-token-keyword)">--</span><span style="color: var(--shiki-color-text)">version</span></li></ol></pre>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="docker --version" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> docker </span><span style="color: var(--shiki-token-keyword)">--</span><span style="color: var(--shiki-color-text)">version</span></li></ol></pre>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="docker-compose --version" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> docker</span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">compose </span><span style="color: var(--shiki-token-keyword)">--</span><span style="color: var(--shiki-color-text)">version</span></li></ol></pre>
<div class="note">
  <p><i id="p_5" class="pid"></i>If you're using Windows, consult <a href="https://docs.reach.sh/guide/windows/#guide-windows">the guide to using Reach on Windows</a>.<a href="https://docs.reach.sh/tut/rps/#p_5" class="pid">5</a></p>
</div>
<p><i id="p_6" class="pid"></i>Once you've confirmed that they are installed, choose a directory for this project. We recommend<a href="https://docs.reach.sh/tut/rps/#p_6" class="pid">6</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="mkdir -p ~/reach/tut &amp;&amp; cd ~/reach/tut" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> mkdir </span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">p </span><span style="color: var(--shiki-token-keyword)">~</span><span style="color: var(--shiki-color-text)">/reach/tut </span><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span><span style="color: var(--shiki-color-text)"> cd </span><span style="color: var(--shiki-token-keyword)">~</span><span style="color: var(--shiki-color-text)">/reach/tut</span></li></ol></pre>
<p><i id="p_7" class="pid"></i>Next, download Reach by running<a href="https://docs.reach.sh/tut/rps/#p_7" class="pid">7</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="curl https://docs.reach.sh/reach -o reach ; chmod +x reach" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> curl https://docs.reach.sh/reach </span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">o reach ; chmod </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)">x reach</span></li></ol></pre>
<p><i id="p_8" class="pid"></i>You'll know that the download worked if you can run<a href="https://docs.reach.sh/tut/rps/#p_8" class="pid">8</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach version" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach version</span></li></ol></pre>
<p><i id="p_9" class="pid"></i>The recommended next step, although optional, is to set up your environment with<a href="https://docs.reach.sh/tut/rps/#p_9" class="pid">9</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach config" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach config</span></li></ol></pre>
<p><i id="p_10" class="pid"></i>This will make subsequent uses of the <code>reach</code> script more convenient by tuning its runtime behavior to your specific needs and only downloading the dependencies you'll actually use.<a href="https://docs.reach.sh/tut/rps/#p_10" class="pid">10</a></p>
<p><i id="p_11" class="pid"></i><span class="snip"><a href="https://docs.reach.sh/tool/#cmd_reach%20config" title="cmd: reach config"><span style="color: var(--shiki-color-text)">reach config</span></a></span> sets overridable defaults for <em>all</em> Reach projects on your development machine and not just the current one, so feel free to skip this step if you'd prefer not to make your choices global.<a href="https://docs.reach.sh/tut/rps/#p_11" class="pid">11</a></p>
<p>
  <i id="p_12" class="pid"></i>Since Reach is Dockerized, when you first use it, you'll need to download the images it uses.
  Fetch them by running<a href="https://docs.reach.sh/tut/rps/#p_12" class="pid">12</a>
</p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach update" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach update</span></li></ol></pre>
<p><i id="p_13" class="pid"></i>You'll know that everything is in order if you can run<a href="https://docs.reach.sh/tut/rps/#p_13" class="pid">13</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach compile --help" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach compile </span><span style="color: var(--shiki-token-keyword)">--</span><span style="color: var(--shiki-color-text)">help</span></li></ol></pre>
<hr>
<div class="note">
  <p><i id="p_14" class="pid"></i>Get language support for Reach in your editor by visiting <a href="https://docs.reach.sh/guide/editor-support/#guide-editor-support">IDE/Text Editor Support</a>.<a href="https://docs.reach.sh/tut/rps/#p_14" class="pid">14</a></p>
</div>
<p><i id="p_15" class="pid"></i>Now that your Reach installation is in order, you should open a text editor and get ready to <a href="https://docs.reach.sh/tut/rps/#tut-2">write your first Reach application</a>!<a href="https://docs.reach.sh/tut/rps/#p_15" class="pid">15</a></p>
<h2 id="tut-2" class="refHeader">Scaffolding and Setup<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-2"><span class="icon icon-link"></span></a></h2>
<p>
  <i id="p_16" class="pid"></i>In this tutorial, we'll be building a version of <em>Rock, Paper, Scissors!</em> where two players, <em>Alice</em> and <em>Bob</em>, can wager on the result of the game.
  We'll start simple and slowly make the application more fully-featured.<a href="https://docs.reach.sh/tut/rps/#p_16" class="pid">16</a>
</p>
<p>
  <i id="p_17" class="pid"></i>You should follow along by copying each part of the program and seeing how things go.
  If you're like us, you may find it beneficial to type each line out, rather than copying &amp; pasting so you can start building your muscle memory and begin to get a sense for each part of a Reach program.<a href="https://docs.reach.sh/tut/rps/#p_17" class="pid">17</a>
</p>
<p>
  <i id="p_18" class="pid"></i>Let's start by creating a file named <code>index.rsh</code>.
  It doesn't matter where you put this file, but we recommend putting it in the current directory, which would be <code>~/reach/tut</code> if you're following along exactly.
  In all the subsequent code samples, we'll label the files based on the chapter of the tutorial you're reading.
  For example, start off by typing the following into <code>index.rsh</code>:<a href="https://docs.reach.sh/tut/rps/#p_18" class="pid">18</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-1-setup/index.rsh">/examples/rps-1-setup/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="&#39;reach 0.1&#39;;

export const main = Reach.App(() =&gt; {
  const Alice = Participant(&#39;Alice&#39;, {
    // Specify Alice&#39;s interact interface here
  });
  const Bob   = Participant(&#39;Bob&#39;, {
   // Specify Bob&#39;s interact interface here
  });
  init();
  // write your program here

});" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-string-expression)">'reach 0.1'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="2"></li><li value="3"><a href="https://docs.reach.sh/rsh/module/#rsh_export" title="rsh: export"><span style="color: var(--shiki-token-keyword)">export</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">main</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/module/#rsh_Reach" title="rsh: Reach"><span style="color: var(--shiki-token-constant)">Reach</span></a><a href="https://docs.reach.sh/rsh/module/#rsh_Reach.App" title="rsh: Reach.App"><span style="color: var(--shiki-token-function)">.App</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="4"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Alice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="5"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// Specify Alice's interact interface here</span></li><li value="6"><span style="color: var(--shiki-color-text)">  });</span></li><li value="7"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Bob</span><span style="color: var(--shiki-color-text)">   </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Bob'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="8"><span style="color: var(--shiki-color-text)">   </span><span style="color: var(--shiki-token-comment)">// Specify Bob's interact interface here</span></li><li value="9"><span style="color: var(--shiki-color-text)">  });</span></li><li value="10"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_init" title="rsh: init"><span style="color: var(--shiki-token-function)">init</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="11"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-comment)">// write your program here</span></li><li value="12"></li><li value="13"><span style="color: var(--shiki-color-text)">});</span></li></ol></pre>
<div class="note">
  <p>
    <i id="p_19" class="pid"></i>Did you notice that <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-1-setup/index.rsh"><code>rps-1-setup/index.rsh</code></a> was a link in the box above the code sample?
    You can always click on these links to see the entire file in our <a href="https://github.com/reach-sh/reach-lang">GitHub</a> repository.<a href="https://docs.reach.sh/tut/rps/#p_19" class="pid">19</a>
  </p>
</div>
<div class="note">
  <p>
    <i id="p_20" class="pid"></i>Did you notice the attractive copy icon on the top the right of that box?
    You can click on it and the content of the code box will be copied onto your clipboard.<a href="https://docs.reach.sh/tut/rps/#p_20" class="pid">20</a>
  </p>
</div>
<div class="note">
  <p>
    <i id="p_21" class="pid"></i>Did your text editor recognize <code>index.rsh</code> as a Reach program and give you proper syntax highlighting?
    If not, check if there's a plugin available for your editor by visiting <a href="https://docs.reach.sh/guide/editor-support/#guide-editor-support">IDE/Text Editor Support</a> or manually
    configure it to treat Reach (<code>.rsh</code>) files as JavaScript and things will be mostly correct.<a href="https://docs.reach.sh/tut/rps/#p_21" class="pid">21</a>
  </p>
</div>
<p><i id="p_22" class="pid"></i>This is just a shell of a program that doesn't do much, but it has a few important components.<a href="https://docs.reach.sh/tut/rps/#p_22" class="pid">22</a></p>
<ul>
  <li>
    <i id="p_23" class="pid"></i>Line 1 indicates that this is a Reach program.
    You'll always have this at the top of every program.<a href="https://docs.reach.sh/tut/rps/#p_23" class="pid">23</a>
  </li>
  <li>
    <i id="p_24" class="pid"></i>Line 3 defines the main export from the program.
    When you compile, this is what the compiler will look at.<a href="https://docs.reach.sh/tut/rps/#p_24" class="pid">24</a>
  </li>
  <li><i id="p_25" class="pid"></i>Lines 4 through 9 specify the two participants to this application, <em>Alice</em> and <em>Bob</em>.<a href="https://docs.reach.sh/tut/rps/#p_25" class="pid">25</a></li>
  <li><i id="p_26" class="pid"></i>Line 10 marks the deployment of the the Reach program, which allows the program to start doing things.<a href="https://docs.reach.sh/tut/rps/#p_26" class="pid">26</a></li>
</ul>
<p>
  <i id="p_27" class="pid"></i>Before we go too much further, let's create a similar shell for our JavaScript frontend code.
  Open a new file named <code>index.mjs</code> and fill it with this:<a href="https://docs.reach.sh/tut/rps/#p_27" class="pid">27</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-1-setup/index.mjs">/examples/rps-1-setup/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="import { loadStdlib } from &#39;@reach-sh/stdlib&#39;;
import * as backend from &#39;./build/index.main.mjs&#39;;
const stdlib = loadStdlib();

const startingBalance = stdlib.parseCurrency(100);
const accAlice = await stdlib.newTestAccount(startingBalance);
const accBob = await stdlib.newTestAccount(startingBalance);

const ctcAlice = accAlice.contract(backend);
const ctcBob = accBob.contract(backend, ctcAlice.getInfo());

await Promise.all([
  ctcAlice.p.Alice({
    // implement Alice&#39;s interact object here
  }),
  ctcBob.p.Bob({
    // implement Bob&#39;s interact object here
  }),
]);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> { loadStdlib } </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'@reach-sh/stdlib'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="2"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">*</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">as</span><span style="color: var(--shiki-color-text)"> backend </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./build/index.main.mjs'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="3"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_loadStdlib" title="js: loadStdlib"><span style="color: var(--shiki-token-function)">loadStdlib</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="4"></li><li value="5"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">startingBalance</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-token-function)">.parseCurrency</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)">);</span></li><li value="6"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">accAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.newTestAccount" title="js: stdlib.newTestAccount"><span style="color: var(--shiki-token-function)">.newTestAccount</span></a><span style="color: var(--shiki-color-text)">(startingBalance);</span></li><li value="7"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">accBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.newTestAccount" title="js: stdlib.newTestAccount"><span style="color: var(--shiki-token-function)">.newTestAccount</span></a><span style="color: var(--shiki-color-text)">(startingBalance);</span></li><li value="8"></li><li value="9"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">ctcAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">accAlice</span><a href="https://docs.reach.sh/frontend/#js_contract" title="js: contract"><span style="color: var(--shiki-token-function)">.contract</span></a><span style="color: var(--shiki-color-text)">(backend);</span></li><li value="10"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">ctcBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">accBob</span><a href="https://docs.reach.sh/frontend/#js_contract" title="js: contract"><span style="color: var(--shiki-token-function)">.contract</span></a><span style="color: var(--shiki-color-text)">(backend</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">ctcAlice</span><a href="https://docs.reach.sh/frontend/#js_getInfo" title="js: getInfo"><span style="color: var(--shiki-token-function)">.getInfo</span></a><span style="color: var(--shiki-color-text)">());</span></li><li value="11"></li><li value="12"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Promise</span><span style="color: var(--shiki-token-function)">.all</span><span style="color: var(--shiki-color-text)">([</span></li><li value="13"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">ctcAlice</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">p</span><span style="color: var(--shiki-token-function)">.Alice</span><span style="color: var(--shiki-color-text)">({</span></li><li value="14"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// implement Alice's interact object here</span></li><li value="15"><span style="color: var(--shiki-color-text)">  })</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="16"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">ctcBob</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">p</span><span style="color: var(--shiki-token-function)">.Bob</span><span style="color: var(--shiki-color-text)">({</span></li><li value="17"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// implement Bob's interact object here</span></li><li value="18"><span style="color: var(--shiki-color-text)">  })</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="19"><span style="color: var(--shiki-color-text)">]);</span></li></ol></pre>
<p><i id="p_28" class="pid"></i>This JavaScript code is similarly schematic and will be consistent across all of your test programs.<a href="https://docs.reach.sh/tut/rps/#p_28" class="pid">28</a></p>
<ul>
  <li><i id="p_29" class="pid"></i>Line 1 imports the Reach standard library loader.<a href="https://docs.reach.sh/tut/rps/#p_29" class="pid">29</a></li>
  <li><i id="p_30" class="pid"></i>Line 2 imports your backend, which <code>./reach compile</code> will produce.<a href="https://docs.reach.sh/tut/rps/#p_30" class="pid">30</a></li>
  <li><i id="p_31" class="pid"></i>Line 3 loads the standard library dynamically based on the <code>REACH_CONNECTOR_MODE</code> environment variable.<a href="https://docs.reach.sh/tut/rps/#p_31" class="pid">31</a></li>
  <li><i id="p_32" class="pid"></i>Line 5 defines a quantity of network tokens as the starting balance for each test account.<a href="https://docs.reach.sh/tut/rps/#p_32" class="pid">32</a></li>
  <li>
    <i id="p_33" class="pid"></i>Lines 6 and 7 create test accounts with initial endowments for Alice and Bob.
    This will only work on the Reach-provided developer testing network.<a href="https://docs.reach.sh/tut/rps/#p_33" class="pid">33</a>
  </li>
  <li><i id="p_34" class="pid"></i>Line 9 has Alice deploy the application.<a href="https://docs.reach.sh/tut/rps/#p_34" class="pid">34</a></li>
</ul>
<div class="note">
  <p><i id="p_35" class="pid"></i>The program defined in <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-1-setup/index.rsh"><code>rps-1-setup/index.rsh</code></a> will only begin to run after it has been deployed via <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-1-setup/index.mjs">rps-1-setup/index.mjs</a>.<a href="https://docs.reach.sh/tut/rps/#p_35" class="pid">35</a></p>
</div>
<ul>
  <li><i id="p_36" class="pid"></i>Line 10 has Bob attach to it.<a href="https://docs.reach.sh/tut/rps/#p_36" class="pid">36</a></li>
  <li><i id="p_37" class="pid"></i>Lines 13 through 15 initialize a backend for Alice.<a href="https://docs.reach.sh/tut/rps/#p_37" class="pid">37</a></li>
  <li><i id="p_38" class="pid"></i>Lines 16 through 18 initialize a backend for Bob.<a href="https://docs.reach.sh/tut/rps/#p_38" class="pid">38</a></li>
  <li><i id="p_39" class="pid"></i>Line 12 waits for the backends to complete.<a href="https://docs.reach.sh/tut/rps/#p_39" class="pid">39</a></li>
</ul>
<p><i id="p_40" class="pid"></i>This is now enough for Reach to compile and run our program. Let's try by running<a href="https://docs.reach.sh/tut/rps/#p_40" class="pid">40</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li></ol></pre>
<p>
  <i id="p_41" class="pid"></i>Reach should now build and launch a Docker container for this application.
  Since the application doesn't do anything, you'll just see a lot of diagnostic messages though, so that's not very exciting.<a href="https://docs.reach.sh/tut/rps/#p_41" class="pid">41</a>
</p>
<div class="note">
  <p><i id="p_42" class="pid"></i>The entire process that we just went through can be automated by running<a href="https://docs.reach.sh/tut/rps/#p_42" class="pid">42</a></p>
  <pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach init" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach init</span></li></ol></pre>
  <p><i id="p_43" class="pid"></i>when you start your next project!<a href="https://docs.reach.sh/tut/rps/#p_43" class="pid">43</a></p>
</div>
<p><i id="p_44" class="pid"></i>In <a href="https://docs.reach.sh/tut/rps/#tut-3">the next step</a>, we'll implement the logic of <em>Rock, Paper, Scissors!</em> and our application will start doing something!<a href="https://docs.reach.sh/tut/rps/#p_44" class="pid">44</a></p>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q0">
  <p><i id="p_45" class="pid"></i>When you write a DApp using Reach, do you<a href="https://docs.reach.sh/tut/rps/#p_45" class="pid">45</a></p>
  <ol>
    <li><i id="p_46" class="pid"></i>write a smart contract in Solidity, a backend in JavaScript using the Ethereum SDK, and a frontend in JavaScript, then use Reach to test and deploy it;<a href="https://docs.reach.sh/tut/rps/#p_46" class="pid">46</a></li>
    <li><i id="p_47" class="pid"></i>write a program in Reach that generates a smart contract &amp; a backend and a front-end in JavaScript, then use Reach to test and deploy it?<a href="https://docs.reach.sh/tut/rps/#p_47" class="pid">47</a></li>
  </ol>
  <div class="collapse" id="q0">
    <p><i id="p_48" class="pid"></i>2; Reach abstracts away the details of the underlying consensus network<a href="https://docs.reach.sh/tut/rps/#p_48" class="pid">48</a></p>
  </div>
</div>
<h2 id="tut-3" class="refHeader">Rock, Paper, and Scissors<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-3"><span class="icon icon-link"></span></a></h2>
<p><i id="p_49" class="pid"></i>In this section, we'll have Alice and Bob actually execute the game of <em>Rock, Paper, Scissors!</em>.<a href="https://docs.reach.sh/tut/rps/#p_49" class="pid">49</a></p>
<p>
  <i id="p_50" class="pid"></i>We have to decide how to represent the hands of the game.
  A simple way is to represent them as the numbers <span class="snip"><span style="color: var(--shiki-token-constant)">0</span></span>, <span class="snip"><span style="color: var(--shiki-token-constant)">1</span></span>, and <span class="snip"><span style="color: var(--shiki-token-constant)">2</span></span>, standing for <code>Rock</code>, <code>Paper</code>, and <code>Scissors</code>.
  However, Reach does not support unsigned integers of exactly two bits, so it is better to represent them as the equivalence class of integers modulo three, so we won't distinguish between <span class="snip"><span style="color: var(--shiki-token-constant)">0</span></span> and <span class="snip"><span style="color: var(--shiki-token-constant)">3</span></span> as <code>Rock</code>.<a href="https://docs.reach.sh/tut/rps/#p_50" class="pid">50</a>
</p>
<p><i id="p_51" class="pid"></i>We'll use a similar strategy for representing the three outcomes of the game: <code>B wins</code>, <code>Draw</code>, and <code>A wins</code>.<a href="https://docs.reach.sh/tut/rps/#p_51" class="pid">51</a></p>
<p><i id="p_52" class="pid"></i>The first step is to change the Reach program to specify that Alice and Bob's frontends can be interacted with to get the move that they will play, and later informed of the outcome of the game.<a href="https://docs.reach.sh/tut/rps/#p_52" class="pid">52</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-2-rps/index.rsh">/examples/rps-2-rps/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="&#39;reach 0.1&#39;;

const Player = {
  getHand: Fun([], UInt),
  seeOutcome: Fun([UInt], Null),
};

export const main = Reach.App(() =&gt; {
  const Alice = Participant(&#39;Alice&#39;, {
    ...Player,
  });
  const Bob   = Participant(&#39;Bob&#39;, {
    ...Player,
  });
  init();

  Alice.only(() =&gt; {" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-string-expression)">'reach 0.1'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="2"></li><li value="3"><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Player</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="4"><span style="color: var(--shiki-color-text)">  getHand</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> UInt)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="5"><span style="color: var(--shiki-color-text)">  seeOutcome</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([UInt]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="6"><span style="color: var(--shiki-color-text)">};</span></li><li value="7"></li><li value="8"><a href="https://docs.reach.sh/rsh/module/#rsh_export" title="rsh: export"><span style="color: var(--shiki-token-keyword)">export</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">main</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/module/#rsh_Reach" title="rsh: Reach"><span style="color: var(--shiki-token-constant)">Reach</span></a><a href="https://docs.reach.sh/rsh/module/#rsh_Reach.App" title="rsh: Reach.App"><span style="color: var(--shiki-token-function)">.App</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="9"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Alice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="10"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">Player</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="11"><span style="color: var(--shiki-color-text)">  });</span></li><li value="12"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Bob</span><span style="color: var(--shiki-color-text)">   </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Bob'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="13"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">Player</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="14"><span style="color: var(--shiki-color-text)">  });</span></li><li value="15"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_init" title="rsh: init"><span style="color: var(--shiki-token-function)">init</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="16"></li><li value="17"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li></ol></pre>
<ul>
  <li>
    <i id="p_53" class="pid"></i>Lines 3 through 6 define a participant interact interface that will be shared between the two players.
    In this case, it provides two methods: <span class="snip"><span style="color: var(--shiki-color-text)">getHand</span></span>, which returns a number; and <span class="snip"><span style="color: var(--shiki-color-text)">seeOutcome</span></span>, which receives a number.<a href="https://docs.reach.sh/tut/rps/#p_53" class="pid">53</a>
  </li>
  <li>
    <i id="p_54" class="pid"></i>Lines 9 through 14 use this interface for both participants.
    Because of this line, <span class="snip"><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-color-text)">interact</span></a></span> in the rest of the program will be bound to an object with methods corresponding to these actions, which will connect to the frontend of the corresponding participant.<a href="https://docs.reach.sh/tut/rps/#p_54" class="pid">54</a>
  </li>
</ul>
<p><i id="p_55" class="pid"></i>Before continuing with the Reach application, let's move over to the JavaScript interface and implement these methods in our frontend.<a href="https://docs.reach.sh/tut/rps/#p_55" class="pid">55</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-2-rps/index.mjs">/examples/rps-2-rps/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="const HAND = [&#39;Rock&#39;, &#39;Paper&#39;, &#39;Scissors&#39;];
const OUTCOME = [&#39;Bob wins&#39;, &#39;Draw&#39;, &#39;Alice wins&#39;];
const Player = (Who) =&gt; ({
  getHand: () =&gt; {
    const hand = Math.floor(Math.random() * 3);
    console.log(`${Who} played ${HAND[hand]}`);
    return hand;
  },
  seeOutcome: (outcome) =&gt; {
    console.log(`${Who} saw outcome ${OUTCOME[outcome]}`);
  },
});

await Promise.all([
  ctcAlice.p.Alice({
    ...Player(&#39;Alice&#39;),
  }),
  ctcBob.p.Bob({
    ...Player(&#39;Bob&#39;),
  }),
]);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="12"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">HAND</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-string-expression)">'Rock'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Paper'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Scissors'</span><span style="color: var(--shiki-color-text)">];</span></li><li value="13"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">OUTCOME</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-string-expression)">'Bob wins'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Draw'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Alice wins'</span><span style="color: var(--shiki-color-text)">];</span></li><li value="14"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (Who) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> ({</span></li><li value="15"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">getHand</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="16"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">hand</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Math</span><span style="color: var(--shiki-token-function)">.floor</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">Math</span><span style="color: var(--shiki-token-function)">.random</span><span style="color: var(--shiki-color-text)">() </span><span style="color: var(--shiki-token-keyword)">*</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></li><li value="17"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">Who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> played </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">HAND</span><span style="color: var(--shiki-color-text)">[hand]</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="18"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> hand;</span></li><li value="19"><span style="color: var(--shiki-color-text)">  }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="20"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">seeOutcome</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (outcome) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="21"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">Who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> saw outcome </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">OUTCOME</span><span style="color: var(--shiki-color-text)">[outcome]</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="22"><span style="color: var(--shiki-color-text)">  }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="23"><span style="color: var(--shiki-color-text)">});</span></li><li value="24"></li><li value="25"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Promise</span><span style="color: var(--shiki-token-function)">.all</span><span style="color: var(--shiki-color-text)">([</span></li><li value="26"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">ctcAlice</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">p</span><span style="color: var(--shiki-token-function)">.Alice</span><span style="color: var(--shiki-color-text)">({</span></li><li value="27"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="28"><span style="color: var(--shiki-color-text)">  })</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="29"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">ctcBob</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">p</span><span style="color: var(--shiki-token-function)">.Bob</span><span style="color: var(--shiki-color-text)">({</span></li><li value="30"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Bob'</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="31"><span style="color: var(--shiki-color-text)">  })</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="32"><span style="color: var(--shiki-color-text)">]);</span></li></ol></pre>
<ul>
  <li><i id="p_56" class="pid"></i>Lines 12 and 13 define arrays to hold the meaning of the hands and outcomes.<a href="https://docs.reach.sh/tut/rps/#p_56" class="pid">56</a></li>
  <li><i id="p_57" class="pid"></i>Line 14 defines a constructor for the <span class="snip"><span style="color: var(--shiki-color-text)">Player</span></span> implementation.<a href="https://docs.reach.sh/tut/rps/#p_57" class="pid">57</a></li>
  <li><i id="p_58" class="pid"></i>Lines 15 through 19 implement the <span class="snip"><span style="color: var(--shiki-color-text)">getHand</span></span> method.<a href="https://docs.reach.sh/tut/rps/#p_58" class="pid">58</a></li>
  <li><i id="p_59" class="pid"></i>Lines 20 through 22 implement the <span class="snip"><span style="color: var(--shiki-color-text)">seeOutcome</span></span> method.<a href="https://docs.reach.sh/tut/rps/#p_59" class="pid">59</a></li>
  <li>
    <i id="p_60" class="pid"></i>Finally, lines 27 and 30 instantiate the implementation once for Alice and once for Bob.
    These are the actual objects that will be bound to <span class="snip"><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-color-text)">interact</span></a></span> in the Reach program.<a href="https://docs.reach.sh/tut/rps/#p_60" class="pid">60</a>
  </li>
</ul>
<p><i id="p_61" class="pid"></i>There should be nothing interesting or controversial about these implementations; that's the point of Reach: we get to just write normal business logic without worrying about the details of the consensus network and decentralized application.<a href="https://docs.reach.sh/tut/rps/#p_61" class="pid">61</a></p>
<p><i id="p_62" class="pid"></i>Let's return to the Reach program and look inside of the body of the program for what actions Alice and Bob take.<a href="https://docs.reach.sh/tut/rps/#p_62" class="pid">62</a></p>
<p>
  <i id="p_63" class="pid"></i>In a real-life game of <em>Rock, Paper, Scissors!</em>, Alice and Bob simultaneously decide what hand they will play and reveal it at the same time.
  "Simultaneity" is a complex concept that is hard to realize in practice.
  For example, if you've ever played against a little kid, you may notice them trying to see what you're going to choose and delaying until the last minute to show their hand so they will win.
  In a decentralized application, it is not possible to have simultaneity.
  Instead, we have to select a particular participant who will "go first".
  In this case, we'll choose Alice.<a href="https://docs.reach.sh/tut/rps/#p_63" class="pid">63</a>
</p>
<div class="note">
  <p>
    <i id="p_64" class="pid"></i>Does Alice go first, or do we call the player that goes first "Alice"?
    This might seem like an unnecessary distinction to make, but it is a very subtle point about the way that Reach works.
    In our frontend, we explicitly ran <span class="snip"><span style="color: var(--shiki-token-constant)">backend</span><span style="color: var(--shiki-color-text)">.Alice</span></span> and <span class="snip"><span style="color: var(--shiki-token-constant)">backend</span><span style="color: var(--shiki-color-text)">.Bob</span></span>.
    When we did that, we were committing that particular JavaScript thread to be either Alice or Bob.
    In our game, whoever chose to run the Alice backend is the one that will go first.
    In other words, <strong>Alice goes first</strong>.
    This will be more obvious at <a href="https://docs.reach.sh/tut/rps/#tut-8">the end of the tutorial</a> when we'll make the choice interactively about which role to play.<a href="https://docs.reach.sh/tut/rps/#p_64" class="pid">64</a>
  </p>
</div>
<p><i id="p_65" class="pid"></i>The game proceeds in three steps.<a href="https://docs.reach.sh/tut/rps/#p_65" class="pid">65</a></p>
<p><i id="p_66" class="pid"></i>First, the backend for Alice interacts with its frontend, gets Alice's hand, and publishes it.<a href="https://docs.reach.sh/tut/rps/#p_66" class="pid">66</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-2-rps/index.rsh">/examples/rps-2-rps/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Alice.only(() =&gt; {
    const handAlice = declassify(interact.getHand());
  });
  Alice.publish(handAlice);
  commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="17"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="18"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">());</span></li><li value="19"><span style="color: var(--shiki-color-text)">  });</span></li><li value="20"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(handAlice);</span></li><li value="21"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<ul>
  <li><i id="p_67" class="pid"></i>Line 17 states that this block of code is something that <em>only</em> <span class="snip"><span style="color: var(--shiki-color-text)">Alice</span></span> performs.<a href="https://docs.reach.sh/tut/rps/#p_67" class="pid">67</a></li>
  <li><i id="p_68" class="pid"></i>That means that the variable, <span class="snip"><span style="color: var(--shiki-color-text)">handAlice</span></span>, bound on line 18 is known only to Alice.<a href="https://docs.reach.sh/tut/rps/#p_68" class="pid">68</a></li>
  <li><i id="p_69" class="pid"></i>Line 18 binds that value to the result of interacting with Alice through the <span class="snip"><span style="color: var(--shiki-color-text)">getHand</span></span> method, which we wrote in JavaScript.<a href="https://docs.reach.sh/tut/rps/#p_69" class="pid">69</a></li>
  <li><i id="p_70" class="pid"></i>Line 18 also declassifies the value, because in Reach, all information from frontends is secret until it is explicitly made public.<a href="https://docs.reach.sh/tut/rps/#p_70" class="pid">70</a></li>
  <li>
    <i id="p_71" class="pid"></i>Line 20 has Alice join the application by publishing the value to the consensus network, so it can be used to evaluate the outcome of the game.
    Once this happens, the code is in a "consensus step" where all participants act together.<a href="https://docs.reach.sh/tut/rps/#p_71" class="pid">71</a>
  </li>
  <li><i id="p_72" class="pid"></i>Line 21 commits the state of the consensus network and returns to "local step" where individual participants can act alone.<a href="https://docs.reach.sh/tut/rps/#p_72" class="pid">72</a></li>
</ul>
<p><i id="p_73" class="pid"></i>The next step is similar, in that Bob publishes his hand; however, we don't immediately commit the state, instead we compute the outcome of the game.<a href="https://docs.reach.sh/tut/rps/#p_73" class="pid">73</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-2-rps/index.rsh">/examples/rps-2-rps/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Bob.only(() =&gt; {
    const handBob = declassify(interact.getHand());
  });
  Bob.publish(handBob);

  const outcome = (handAlice + (4 - handBob)) % 3;
  commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="23"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="24"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">());</span></li><li value="25"><span style="color: var(--shiki-color-text)">  });</span></li><li value="26"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(handBob);</span></li><li value="27"></li><li value="28"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">outcome</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_-" title="rsh: -"><span style="color: var(--shiki-token-keyword)">-</span></a><span style="color: var(--shiki-color-text)"> handBob)) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">;</span></li><li value="29"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<ul>
  <li><i id="p_74" class="pid"></i>Lines 23 through 26 match Alice's similar local step and joining of the application through a consensus transfer publication.<a href="https://docs.reach.sh/tut/rps/#p_74" class="pid">74</a></li>
  <li>
    <i id="p_75" class="pid"></i>But, line 28 computes the outcome of the game before committing.
    (<span class="snip"><span style="color: var(--shiki-color-text)">(handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_-" title="rsh: -"><span style="color: var(--shiki-token-keyword)">-</span></a><span style="color: var(--shiki-color-text)"> handBob)) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span></span> is a clever equation to compute the winner of a game of <em>Rock, Paper, Scissors!</em> using modular arithmetic.
    Consider when <span class="snip"><span style="color: var(--shiki-color-text)">handAlice</span></span> is <span class="snip"><span style="color: var(--shiki-token-constant)">0</span></span> (i.e., <code>Rock</code>) and <span class="snip"><span style="color: var(--shiki-color-text)">handBob</span></span> is <span class="snip"><span style="color: var(--shiki-token-constant)">2</span></span> (i.e., <code>Scissors</code>),
    then this equation is <span class="snip"><span style="color: var(--shiki-color-text)">((handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_-" title="rsh: -"><span style="color: var(--shiki-token-keyword)">-</span></a><span style="color: var(--shiki-color-text)"> handBob)) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ((</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_-" title="rsh: -"><span style="color: var(--shiki-token-keyword)">-</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">)) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ((</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span></span>,
    which is the last outcome, that is <code>Alice wins</code>, as we expect it to be.)<a href="https://docs.reach.sh/tut/rps/#p_75" class="pid">75</a>
  </li>
</ul>
<p><i id="p_76" class="pid"></i>Finally, we use the each form to have each of the participants send the final outcome to their frontends.<a href="https://docs.reach.sh/tut/rps/#p_76" class="pid">76</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-2-rps/index.rsh">/examples/rps-2-rps/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  each([Alice, Bob], () =&gt; {
    interact.seeOutcome(outcome);
  });" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="31"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/step/#rsh_each" title="rsh: each"><span style="color: var(--shiki-token-function)">each</span></a><span style="color: var(--shiki-color-text)">([Alice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Bob]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="32"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.seeOutcome</span><span style="color: var(--shiki-color-text)">(outcome);</span></li><li value="33"><span style="color: var(--shiki-color-text)">  });</span></li></ol></pre>
<ul>
  <li><i id="p_77" class="pid"></i>Line 31 states that this is a local step that each of the participants performs.<a href="https://docs.reach.sh/tut/rps/#p_77" class="pid">77</a></li>
</ul>
<p><i id="p_78" class="pid"></i>At this point, we can run the program and see its output by running<a href="https://docs.reach.sh/tut/rps/#p_78" class="pid">78</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li></ol></pre>
<p>
  <i id="p_79" class="pid"></i>Since the players act randomly, the results will be different every time.
  When I ran the program three times, this is the output I got:<a href="https://docs.reach.sh/tut/rps/#p_79" class="pid">79</a>
</p>
<pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run
Alice played Scissors
Bob played Paper
Alice saw outcome Alice wins
Bob saw outcome Alice wins

$ ./reach run
Alice played Scissors
Bob played Paper
Alice saw outcome Alice wins
Bob saw outcome Alice wins

$ ./reach run
Alice played Paper
Bob played Rock
Alice saw outcome Alice wins
Bob saw outcome Alice wins" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="2"><span style="color: var(--shiki-color-text)">Alice played Scissors</span></li><li value="3"><span style="color: var(--shiki-color-text)">Bob played Paper</span></li><li value="4"><span style="color: var(--shiki-color-text)">Alice saw outcome Alice wins</span></li><li value="5"><span style="color: var(--shiki-color-text)">Bob saw outcome Alice wins</span></li><li value="6"></li><li value="7"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="8"><span style="color: var(--shiki-color-text)">Alice played Scissors</span></li><li value="9"><span style="color: var(--shiki-color-text)">Bob played Paper</span></li><li value="10"><span style="color: var(--shiki-color-text)">Alice saw outcome Alice wins</span></li><li value="11"><span style="color: var(--shiki-color-text)">Bob saw outcome Alice wins</span></li><li value="12"></li><li value="13"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="14"><span style="color: var(--shiki-color-text)">Alice played Paper</span></li><li value="15"><span style="color: var(--shiki-color-text)">Bob played Rock</span></li><li value="16"><span style="color: var(--shiki-color-text)">Alice saw outcome Alice wins</span></li><li value="17"><span style="color: var(--shiki-color-text)">Bob saw outcome Alice wins</span></li></ol></pre>
<p><i id="p_80" class="pid"></i>Alice is pretty good at <em>Rock, Paper, Scissors!</em>!<a href="https://docs.reach.sh/tut/rps/#p_80" class="pid">80</a></p>
<p>
  <i id="p_81" class="pid"></i>Consensus networks in general, and Reach specifically, guarantee that all participants agree on the outcome of their decentralized computation.
  Indeed, this is where the name consensus network comes from, as they enable these distributed, and untrusted, parties to come to a consensus, or agreement, about the intermediate states of a computation; and if they agree on the intermediate states, they will also agree on the output.
  That's why every time you run <code>./reach run</code>, both Alice and Bob will see the same outcome!<a href="https://docs.reach.sh/tut/rps/#p_81" class="pid">81</a>
</p>
<div class="note">
  <p><i id="p_82" class="pid"></i>If your version isn't working, look at the complete versions of <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-2-rps/index.rsh"><code>rps-2-rps/index.rsh</code></a> and <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-2-rps/index.mjs"><code>rps-2-rps/index.mjs</code></a> to make sure you copied everything down correctly!<a href="https://docs.reach.sh/tut/rps/#p_82" class="pid">82</a></p>
</div>
<p><i id="p_83" class="pid"></i>In <a href="https://docs.reach.sh/tut/rps/#tut-4">the next step</a>, we'll add some stakes to the game, because Alice needs to take her skills to the bank!<a href="https://docs.reach.sh/tut/rps/#p_83" class="pid">83</a></p>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q1">
  <p><i id="p_84" class="pid"></i>Reach programs allow interaction with a user interface through which of the following methods?<a href="https://docs.reach.sh/tut/rps/#p_84" class="pid">84</a></p>
  <ol>
    <li><i id="p_85" class="pid"></i>by forcing you to write a custom backend for the user interface that connects to the generated smart contract,<a href="https://docs.reach.sh/tut/rps/#p_85" class="pid">85</a></li>
    <li><i id="p_86" class="pid"></i>by allowing the frontends to provide values directly to the Reach application,<a href="https://docs.reach.sh/tut/rps/#p_86" class="pid">86</a></li>
    <li><i id="p_87" class="pid"></i>by allowing the Reach program to callback to the frontend via the interact object.<a href="https://docs.reach.sh/tut/rps/#p_87" class="pid">87</a></li>
  </ol>
  <div class="collapse" id="q1">
    <p><i id="p_88" class="pid"></i>2 and 3; Reach programs specify a two-way interface between the frontend and the backend via the participant interact interface.<a href="https://docs.reach.sh/tut/rps/#p_88" class="pid">88</a></p>
  </div>
</div>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q2">
  <p><i id="p_89" class="pid"></i>How do participants in a Reach application share information with each other and find out what others have shared?<a href="https://docs.reach.sh/tut/rps/#p_89" class="pid">89</a></p>
  <ol>
    <li>
      <p><i id="p_90" class="pid"></i>Reach generates a smart contract, but you need to implement a process to scan the blockchain for events that correspond to sharing;<a href="https://docs.reach.sh/tut/rps/#p_90" class="pid">90</a></p>
    </li>
    <li>
      <p><i id="p_91" class="pid"></i>The Reach primitive <span class="snip"><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-color-text)">publish</span></a></span> allows a participant to share information with all other participants, which happens automatically without the other parties needing to do anything special;<a href="https://docs.reach.sh/tut/rps/#p_91" class="pid">91</a></p>
    </li>
    <li>
      <p><i id="p_92" class="pid"></i>The Reach primitive <span class="snip"><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-color-text)">publish</span></a></span> allows a participant to share information with all other participants, but they need to explicitly run the receive primitive to receive published information.<a href="https://docs.reach.sh/tut/rps/#p_92" class="pid">92</a></p>
    </li>
  </ol>
  <div class="collapse" id="q2">
    <p><i id="p_93" class="pid"></i>2; the <span class="snip"><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-color-text)">publish</span></a></span> primitive does everything for you.<a href="https://docs.reach.sh/tut/rps/#p_93" class="pid">93</a></p>
  </div>
</div>
<h2 id="tut-4" class="refHeader">Bets and Wagers<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-4"><span class="icon icon-link"></span></a></h2>
<p>
  <i id="p_94" class="pid"></i>Although it's fun to play <em>Rock, Paper, Scissors!</em> with friends for a laugh, it's even better to play it with enemies and your entire life-savings on the line!
  Let's change our program so that Alice can offer a wager to Bob and whoever wins will take the pot.<a href="https://docs.reach.sh/tut/rps/#p_94" class="pid">94</a>
</p>
<p><i id="p_95" class="pid"></i>This time, let's start with changes to the JavaScript frontend and then we'll go back into the Reach code and connect the new methods up.<a href="https://docs.reach.sh/tut/rps/#p_95" class="pid">95</a></p>
<p>
  <i id="p_96" class="pid"></i>Since we're going to be having funds get transferred, we'll record the balances of each participant before the game starts, so we can more clearly show what they won at the end.
  We'll add this code in between account creation and contract deployment.<a href="https://docs.reach.sh/tut/rps/#p_96" class="pid">96</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-3-bets/index.mjs">/examples/rps-3-bets/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="const startingBalance = stdlib.parseCurrency(100);
const accAlice = await stdlib.newTestAccount(startingBalance);
const accBob = await stdlib.newTestAccount(startingBalance);

const fmt = (x) =&gt; stdlib.formatCurrency(x, 4);
const getBalance = async (who) =&gt; fmt(await stdlib.balanceOf(who));
const beforeAlice = await getBalance(accAlice);
const beforeBob = await getBalance(accBob);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="5"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">startingBalance</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-token-function)">.parseCurrency</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)">);</span></li><li value="6"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">accAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.newTestAccount" title="js: stdlib.newTestAccount"><span style="color: var(--shiki-token-function)">.newTestAccount</span></a><span style="color: var(--shiki-color-text)">(startingBalance);</span></li><li value="7"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">accBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.newTestAccount" title="js: stdlib.newTestAccount"><span style="color: var(--shiki-token-function)">.newTestAccount</span></a><span style="color: var(--shiki-color-text)">(startingBalance);</span></li><li value="8"></li><li value="9"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">fmt</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (x) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_formatCurrency" title="js: formatCurrency"><span style="color: var(--shiki-token-function)">.formatCurrency</span></a><span style="color: var(--shiki-color-text)">(x</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)">);</span></li><li value="10"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getBalance</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> (who) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">fmt</span><span style="color: var(--shiki-color-text)">(</span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.balanceOf" title="js: stdlib.balanceOf"><span style="color: var(--shiki-token-function)">.balanceOf</span></a><span style="color: var(--shiki-color-text)">(who));</span></li><li value="11"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">beforeAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getBalance</span><span style="color: var(--shiki-color-text)">(accAlice);</span></li><li value="12"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">beforeBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getBalance</span><span style="color: var(--shiki-color-text)">(accBob);</span></li></ol></pre>
<ul>
  <li><i id="p_97" class="pid"></i>Line 9 shows a helpful function for displaying currency amounts with up to 4 decimal places.<a href="https://docs.reach.sh/tut/rps/#p_97" class="pid">97</a></li>
  <li><i id="p_98" class="pid"></i>Line 10 shows a helpful function for getting the balance of a participant and displaying it with up to 4 decimal places.<a href="https://docs.reach.sh/tut/rps/#p_98" class="pid">98</a></li>
  <li><i id="p_99" class="pid"></i>Lines 11 and 12 get the balance before the game starts for both Alice and Bob.<a href="https://docs.reach.sh/tut/rps/#p_99" class="pid">99</a></li>
</ul>
<p><i id="p_100" class="pid"></i>Next, we'll update Alice's interface object to include her wager.<a href="https://docs.reach.sh/tut/rps/#p_100" class="pid">100</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-3-bets/index.mjs">/examples/rps-3-bets/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="  ctcAlice.p.Alice({
    ...Player(&#39;Alice&#39;),
    wager: stdlib.parseCurrency(5),
  })," href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="31"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">ctcAlice</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">p</span><span style="color: var(--shiki-token-function)">.Alice</span><span style="color: var(--shiki-color-text)">({</span></li><li value="32"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="33"><span style="color: var(--shiki-color-text)">    wager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-token-function)">.parseCurrency</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="34"><span style="color: var(--shiki-color-text)">  })</span><span style="color: var(--shiki-token-punctuation)">,</span></li></ol></pre>
<ul>
  <li><i id="p_101" class="pid"></i>Line 32 splices the common <span class="snip"><span style="color: var(--shiki-color-text)">Player</span></span> interface into Alice's interface.<a href="https://docs.reach.sh/tut/rps/#p_101" class="pid">101</a></li>
  <li>
    <i id="p_102" class="pid"></i>Line 33 defines her wager as <code>5</code> units of the network token.
    This is an example of using a concrete value, rather than a function, in a participant interact interface.<a href="https://docs.reach.sh/tut/rps/#p_102" class="pid">102</a>
  </li>
</ul>
<p><i id="p_103" class="pid"></i>For Bob, we'll modify his interface to show the wager and immediately accept it by returning.<a href="https://docs.reach.sh/tut/rps/#p_103" class="pid">103</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-3-bets/index.mjs">/examples/rps-3-bets/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="  ctcBob.p.Bob({
    ...Player(&#39;Bob&#39;),
    acceptWager: (amt) =&gt; {
      console.log(`Bob accepts the wager of ${fmt(amt)}.`);
    },
  })," href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="35"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">ctcBob</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">p</span><span style="color: var(--shiki-token-function)">.Bob</span><span style="color: var(--shiki-color-text)">({</span></li><li value="36"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Bob'</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="37"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">acceptWager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (amt) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="38"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Bob accepts the wager of </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-function)">fmt</span><span style="color: var(--shiki-color-text)">(amt)</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">.`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="39"><span style="color: var(--shiki-color-text)">    }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="40"><span style="color: var(--shiki-color-text)">  })</span><span style="color: var(--shiki-token-punctuation)">,</span></li></ol></pre>
<ul>
  <li><i id="p_104" class="pid"></i>Lines 37 through 39 define the <span class="snip"><span style="color: var(--shiki-color-text)">acceptWager</span></span> function.<a href="https://docs.reach.sh/tut/rps/#p_104" class="pid">104</a></li>
</ul>
<p><i id="p_105" class="pid"></i>Finally, after the computation is over, we'll get the balance again and show a message summarizing the effect.<a href="https://docs.reach.sh/tut/rps/#p_105" class="pid">105</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-3-bets/index.mjs">/examples/rps-3-bets/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="const afterAlice = await getBalance(accAlice);
const afterBob = await getBalance(accBob);

console.log(`Alice went from ${beforeAlice} to ${afterAlice}.`);
console.log(`Bob went from ${beforeBob} to ${afterBob}.`);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="43"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">afterAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getBalance</span><span style="color: var(--shiki-color-text)">(accAlice);</span></li><li value="44"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">afterBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getBalance</span><span style="color: var(--shiki-color-text)">(accBob);</span></li><li value="45"></li><li value="46"><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Alice went from </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">beforeAlice</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> to </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">afterAlice</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">.`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="47"><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Bob went from </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">beforeBob</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> to </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">afterBob</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">.`</span><span style="color: var(--shiki-color-text)">);</span></li></ol></pre>
<ul>
  <li><i id="p_106" class="pid"></i>Lines 44 and 45 get the balances afterwards.<a href="https://docs.reach.sh/tut/rps/#p_106" class="pid">106</a></li>
  <li><i id="p_107" class="pid"></i>Lines 47 and 48 print out the effect.<a href="https://docs.reach.sh/tut/rps/#p_107" class="pid">107</a></li>
</ul>
<p>
  <i id="p_108" class="pid"></i>These changes to the frontend only deal with issues of presentation and interfacing.
  The actual business logic of making the wager and transferring the funds will happen in the Reach code.<a href="https://docs.reach.sh/tut/rps/#p_108" class="pid">108</a>
</p>
<p><i id="p_109" class="pid"></i>Let's look at that now.<a href="https://docs.reach.sh/tut/rps/#p_109" class="pid">109</a></p>
<p><i id="p_110" class="pid"></i>First, we need to update the participant interact interface.<a href="https://docs.reach.sh/tut/rps/#p_110" class="pid">110</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-3-bets/index.rsh">/examples/rps-3-bets/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="&#39;reach 0.1&#39;;

const Player = {
  getHand: Fun([], UInt),
  seeOutcome: Fun([UInt], Null),
};

export const main = Reach.App(() =&gt; {
  const Alice = Participant(&#39;Alice&#39;, {
    ...Player,
    wager: UInt,
  });
  const Bob   = Participant(&#39;Bob&#39;, {
    ...Player,
    acceptWager: Fun([UInt], Null),
  });
  init();

  Alice.only(() =&gt; {" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-string-expression)">'reach 0.1'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="2"></li><li value="3"><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Player</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="4"><span style="color: var(--shiki-color-text)">  getHand</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> UInt)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="5"><span style="color: var(--shiki-color-text)">  seeOutcome</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([UInt]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="6"><span style="color: var(--shiki-color-text)">};</span></li><li value="7"></li><li value="8"><a href="https://docs.reach.sh/rsh/module/#rsh_export" title="rsh: export"><span style="color: var(--shiki-token-keyword)">export</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">main</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/module/#rsh_Reach" title="rsh: Reach"><span style="color: var(--shiki-token-constant)">Reach</span></a><a href="https://docs.reach.sh/rsh/module/#rsh_Reach.App" title="rsh: Reach.App"><span style="color: var(--shiki-token-function)">.App</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="9"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Alice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="10"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">Player</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="11"><span style="color: var(--shiki-color-text)">    wager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> UInt</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="12"><span style="color: var(--shiki-color-text)">  });</span></li><li value="13"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Bob</span><span style="color: var(--shiki-color-text)">   </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Bob'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="14"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">Player</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="15"><span style="color: var(--shiki-color-text)">    acceptWager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([UInt]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="16"><span style="color: var(--shiki-color-text)">  });</span></li><li value="17"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_init" title="rsh: init"><span style="color: var(--shiki-token-function)">init</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="18"></li><li value="19"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li></ol></pre>
<ul>
  <li><i id="p_111" class="pid"></i>Lines 9 through 12 define Alice's interface as the <span class="snip"><span style="color: var(--shiki-color-text)">Player</span></span> interface, plus an integer value called <span class="snip"><span style="color: var(--shiki-color-text)">wager</span></span>.<a href="https://docs.reach.sh/tut/rps/#p_111" class="pid">111</a></li>
  <li><i id="p_112" class="pid"></i>Lines 13 through 16 do the same for Bob, where he has a method called <span class="snip"><span style="color: var(--shiki-color-text)">acceptWager</span></span> that can look at the wager value.<a href="https://docs.reach.sh/tut/rps/#p_112" class="pid">112</a></li>
</ul>
<p>
  <i id="p_113" class="pid"></i>Each of the three parts of the application have to be updated to deal with the wager.
  Let's look at Alice's first step first.<a href="https://docs.reach.sh/tut/rps/#p_113" class="pid">113</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-3-bets/index.rsh">/examples/rps-3-bets/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Alice.only(() =&gt; {
    const wager = declassify(interact.wager);
    const handAlice = declassify(interact.getHand());
  });
  Alice.publish(wager, handAlice)
    .pay(wager);
  commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="19"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="20"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">wager</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-color-text)">.wager);</span></li><li value="21"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">());</span></li><li value="22"><span style="color: var(--shiki-color-text)">  });</span></li><li value="23"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(wager</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handAlice)</span></li><li value="24"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="25"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<ul>
  <li><i id="p_114" class="pid"></i>Line 20 has Alice declassify the wager for transmission.<a href="https://docs.reach.sh/tut/rps/#p_114" class="pid">114</a></li>
  <li><i id="p_115" class="pid"></i>Line 23 is updated so that Alice shares the wager amount with Bob.<a href="https://docs.reach.sh/tut/rps/#p_115" class="pid">115</a></li>
  <li>
    <i id="p_116" class="pid"></i>Line 24 has her transfer the amount as part of her publication.
    The Reach compiler would throw an exception if <span class="snip"><span style="color: var(--shiki-color-text)">wager</span></span> did not appear on line 23, but did appear on line 24.
    Change the program and try it.
    This is because the consensus network needs to be able to verify that the amount of network tokens included in Alice's publication match some computation available to consensus network.<a href="https://docs.reach.sh/tut/rps/#p_116" class="pid">116</a>
  </li>
</ul>
<p><i id="p_117" class="pid"></i>Next, Bob needs to be shown the wager and given the opportunity to accept it and transfer his funds.<a href="https://docs.reach.sh/tut/rps/#p_117" class="pid">117</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-3-bets/index.rsh">/examples/rps-3-bets/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Bob.only(() =&gt; {
    interact.acceptWager(wager);
    const handBob = declassify(interact.getHand());
  });
  Bob.publish(handBob)
    .pay(wager);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="27"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="28"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.acceptWager</span><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="29"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">());</span></li><li value="30"><span style="color: var(--shiki-color-text)">  });</span></li><li value="31"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(handBob)</span></li><li value="32"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager);</span></li></ol></pre>
<ul>
  <li>
    <i id="p_118" class="pid"></i>Line 28 has Bob accept the wager.
    If he doesn't like the terms, his frontend can just not respond to this method and the DApp will stall.<a href="https://docs.reach.sh/tut/rps/#p_118" class="pid">118</a>
  </li>
  <li><i id="p_119" class="pid"></i>Line 32 has Bob pay the wager as well.<a href="https://docs.reach.sh/tut/rps/#p_119" class="pid">119</a></li>
</ul>
<p>
  <i id="p_120" class="pid"></i>The DApp is now running in a consensus step and
  the contract itself now holds twice the wager amount.
  Before, it would compute the outcome and then commit the state; but now, it needs to look at the outcome and use it to balance the account.<a href="https://docs.reach.sh/tut/rps/#p_120" class="pid">120</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-3-bets/index.rsh">/examples/rps-3-bets/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  const outcome = (handAlice + (4 - handBob)) % 3;
  const            [forAlice, forBob] =
    outcome == 2 ? [       2,      0] :
    outcome == 0 ? [       0,      2] :
    /* tie      */ [       1,      1];
  transfer(forAlice * wager).to(Alice);
  transfer(forBob   * wager).to(Bob);
  commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="34"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">outcome</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_-" title="rsh: -"><span style="color: var(--shiki-token-keyword)">-</span></a><span style="color: var(--shiki-color-text)"> handBob)) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">;</span></li><li value="35"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)">            [</span><span style="color: var(--shiki-token-constant)">forAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">forBob</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span></li><li value="36"><span style="color: var(--shiki-color-text)">    outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_?" title="rsh: ?"><span style="color: var(--shiki-token-keyword)">?</span></a><span style="color: var(--shiki-color-text)"> [       </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">:</span></li><li value="37"><span style="color: var(--shiki-color-text)">    outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_?" title="rsh: ?"><span style="color: var(--shiki-token-keyword)">?</span></a><span style="color: var(--shiki-color-text)"> [       </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">:</span></li><li value="38"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">/* tie      */</span><span style="color: var(--shiki-color-text)"> [       </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">];</span></li><li value="39"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer" title="rsh: transfer"><span style="color: var(--shiki-token-function)">transfer</span></a><span style="color: var(--shiki-color-text)">(forAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_*" title="rsh: *"><span style="color: var(--shiki-token-keyword)">*</span></a><span style="color: var(--shiki-color-text)"> wager)</span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer.to" title="rsh: transfer.to"><span style="color: var(--shiki-token-function)">.to</span></a><span style="color: var(--shiki-color-text)">(Alice);</span></li><li value="40"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer" title="rsh: transfer"><span style="color: var(--shiki-token-function)">transfer</span></a><span style="color: var(--shiki-color-text)">(forBob   </span><a href="https://docs.reach.sh/rsh/compute/#rsh_*" title="rsh: *"><span style="color: var(--shiki-token-keyword)">*</span></a><span style="color: var(--shiki-color-text)"> wager)</span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer.to" title="rsh: transfer.to"><span style="color: var(--shiki-token-function)">.to</span></a><span style="color: var(--shiki-color-text)">(Bob);</span></li><li value="41"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<ul>
  <li>
    <i id="p_121" class="pid"></i>Lines 35 through 38 compute the amounts given to each participant depending on the outcome by determining how many <span class="snip"><span style="color: var(--shiki-color-text)">wager</span></span> amounts each party gets.
    If the outcome is <span class="snip"><span style="color: var(--shiki-token-constant)">2</span></span>, <code>Alice wins</code>, then she gets two portions; while if it is <span class="snip"><span style="color: var(--shiki-token-constant)">0</span></span>, <code>Bob wins</code>, then he gets two portions; otherwise they each get one portion.<a href="https://docs.reach.sh/tut/rps/#p_121" class="pid">121</a>
  </li>
  <li>
    <i id="p_122" class="pid"></i>Lines 39 and 40 transfer the corresponding amounts.
    This transfer takes place from the contract to the participants, not from the participants to each other, because all of the funds reside inside of the contract.<a href="https://docs.reach.sh/tut/rps/#p_122" class="pid">122</a>
  </li>
  <li><i id="p_123" class="pid"></i>Line 41 commits the state of the application and allows the participants to see the outcome and complete.<a href="https://docs.reach.sh/tut/rps/#p_123" class="pid">123</a></li>
</ul>
<p><i id="p_124" class="pid"></i>At this point, we can run the program and see its output by running<a href="https://docs.reach.sh/tut/rps/#p_124" class="pid">124</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li></ol></pre>
<p>
  <i id="p_125" class="pid"></i>Since the players act randomly, the results will be different every time.
  When I ran the program three times, this is the output I got:<a href="https://docs.reach.sh/tut/rps/#p_125" class="pid">125</a>
</p>
<pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run
Alice played Paper
Bob accepts the wager of 5.
Bob played Rock
Alice saw outcome Alice wins
Bob saw outcome Alice wins
Alice went from 100 to 104.9999.
Bob went from 100 to 94.9999.

$ ./reach run
Alice played Paper
Bob accepts the wager of 5.
Bob played Scissors
Alice saw outcome Bob wins
Bob saw outcome Bob wins
Alice went from 100 to 94.9999.
Bob went from 100 to 104.9999.

$ ./reach run
Alice played Rock
Bob accepts the wager of 5.
Bob played Scissors
Alice saw outcome Alice wins
Bob saw outcome Alice wins
Alice went from 100 to 104.9999.
Bob went from 100 to 94.9999." href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="2"><span style="color: var(--shiki-color-text)">Alice played Paper</span></li><li value="3"><span style="color: var(--shiki-color-text)">Bob accepts the wager of </span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">.</span></li><li value="4"><span style="color: var(--shiki-color-text)">Bob played Rock</span></li><li value="5"><span style="color: var(--shiki-color-text)">Alice saw outcome Alice wins</span></li><li value="6"><span style="color: var(--shiki-color-text)">Bob saw outcome Alice wins</span></li><li value="7"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">104.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="8"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">94.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="9"></li><li value="10"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="11"><span style="color: var(--shiki-color-text)">Alice played Paper</span></li><li value="12"><span style="color: var(--shiki-color-text)">Bob accepts the wager of </span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">.</span></li><li value="13"><span style="color: var(--shiki-color-text)">Bob played Scissors</span></li><li value="14"><span style="color: var(--shiki-color-text)">Alice saw outcome Bob wins</span></li><li value="15"><span style="color: var(--shiki-color-text)">Bob saw outcome Bob wins</span></li><li value="16"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">94.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="17"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">104.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="18"></li><li value="19"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="20"><span style="color: var(--shiki-color-text)">Alice played Rock</span></li><li value="21"><span style="color: var(--shiki-color-text)">Bob accepts the wager of </span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">.</span></li><li value="22"><span style="color: var(--shiki-color-text)">Bob played Scissors</span></li><li value="23"><span style="color: var(--shiki-color-text)">Alice saw outcome Alice wins</span></li><li value="24"><span style="color: var(--shiki-color-text)">Bob saw outcome Alice wins</span></li><li value="25"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">104.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="26"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">94.9999</span><span style="color: var(--shiki-color-text)">.</span></li></ol></pre>
<div class="note">
  <p>
    <i id="p_126" class="pid"></i>How come Alice and Bob's balances go back to <code>100</code> every time?
    It's because each time we run <code>./reach run</code>, it creates fresh accounts for both players.<a href="https://docs.reach.sh/tut/rps/#p_126" class="pid">126</a>
  </p>
</div>
<div class="note">
  <p>
    <i id="p_127" class="pid"></i>How come the balances aren't exactly <code>100</code>, <code>105</code>, and <code>95</code>?
    It's because consensus network charge fees to run transactions.<a href="https://docs.reach.sh/tut/rps/#p_127" class="pid">127</a>
  </p>
  <p><i id="p_128" class="pid"></i>If we had shown all the decimals, they'd look like this:<a href="https://docs.reach.sh/tut/rps/#p_128" class="pid">128</a></p>
  <hr>
  <pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="Alice went from 100 to 104.999999999999687163.
Bob went from 100 to 94.999999999999978229.
...
Alice went from 100 to 94.999999999999687163.
Bob went from 100 to 104.999999999999978246." href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1">Alice went from 100 to 104.999999999999687163.</li><li value="2">Bob went from 100 to 94.999999999999978229.</li><li value="3">...</li><li value="4">Alice went from 100 to 94.999999999999687163.</li><li value="5">Bob went from 100 to 104.999999999999978246.</li></ol></pre>
  <hr>
  <p>
    <i id="p_129" class="pid"></i>Why does Alice win slightly less than Bob when she wins?
    She has to pay to deploy the contract, because she publishes the first message in her frontend.<a href="https://docs.reach.sh/tut/rps/#p_129" class="pid">129</a>
  </p>
</div>
<p><i id="p_130" class="pid"></i>Alice is doing okay - if she keeps this up, she'll make a fortune on <em>Rock, Paper, Scissors!</em>!<a href="https://docs.reach.sh/tut/rps/#p_130" class="pid">130</a></p>
<div class="note">
  <p><i id="p_131" class="pid"></i>If your version isn't working, look at the complete versions of <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-3-bets/index.rsh"><code>rps-3-bets/index.rsh</code></a> and <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-3-bets/index.mjs"><code>rps-3-bets/index.mjs</code></a> to make sure you copied everything down correctly!<a href="https://docs.reach.sh/tut/rps/#p_131" class="pid">131</a></p>
</div>
<p>
  <i id="p_132" class="pid"></i>Now that there is a reason to play this game, it turns out that there's a major security vulnerability.
  We'll fix this in <a href="https://docs.reach.sh/tut/rps/#tut-5">the next step</a>; make sure you don't launch with this version, or Alice is going to go broke!<a href="https://docs.reach.sh/tut/rps/#p_132" class="pid">132</a>
</p>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q3">
  <p><i id="p_133" class="pid"></i>How do Reach programs manage token funds?<a href="https://docs.reach.sh/tut/rps/#p_133" class="pid">133</a></p>
  <ol>
    <li><i id="p_134" class="pid"></i>They don’t; you need to manage them explicitly in parallel to the Reach program;<a href="https://docs.reach.sh/tut/rps/#p_134" class="pid">134</a></li>
    <li><i id="p_135" class="pid"></i>The <span class="snip"><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-color-text)">pay</span></a></span> primitive can be added to a <span class="snip"><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-color-text)">publish</span></a></span> primitive to send funds to the Reach program, which can then use the <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer" title="rsh: transfer"><span style="color: var(--shiki-color-text)">transfer</span></a></span> primitive to send funds back to participants, and other addresses.<a href="https://docs.reach.sh/tut/rps/#p_135" class="pid">135</a></li>
  </ol>
  <div class="collapse" id="q3">
    <p><i id="p_136" class="pid"></i>2; the <span class="snip"><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-color-text)">pay</span></a></span> and <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer" title="rsh: transfer"><span style="color: var(--shiki-color-text)">transfer</span></a></span> primitives do everything for you.<a href="https://docs.reach.sh/tut/rps/#p_136" class="pid">136</a></p>
  </div>
</div>
<h2 id="tut-5" class="refHeader">Trust and Commitments<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-5"><span class="icon icon-link"></span></a></h2>
<p>
  <i id="p_137" class="pid"></i>In the last section, we made it so that Alice and Bob can actually exchange currency when they play <em>Rock, Paper, Scissors!</em>.
  However, the version of the application we wrote has a fundamental flaw: Bob can win every game!<a href="https://docs.reach.sh/tut/rps/#p_137" class="pid">137</a>
</p>
<p>
  <i id="p_138" class="pid"></i>How is that possible?
  We showed executions of the game where Alice won, like the following<a href="https://docs.reach.sh/tut/rps/#p_138" class="pid">138</a>
</p>
<pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run
Alice played Rock
Bob accepts the wager of 5.
Bob played Scissors
Alice saw outcome Alice wins
Bob saw outcome Alice wins
Alice went from 100 to 104.9999.
Bob went from 100 to 94.9999." href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="2"><span style="color: var(--shiki-color-text)">Alice played Rock</span></li><li value="3"><span style="color: var(--shiki-color-text)">Bob accepts the wager of </span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">.</span></li><li value="4"><span style="color: var(--shiki-color-text)">Bob played Scissors</span></li><li value="5"><span style="color: var(--shiki-color-text)">Alice saw outcome Alice wins</span></li><li value="6"><span style="color: var(--shiki-color-text)">Bob saw outcome Alice wins</span></li><li value="7"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">104.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="8"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">94.9999</span><span style="color: var(--shiki-color-text)">.</span></li></ol></pre>
<p>
  <i id="p_139" class="pid"></i>The problem is that this version of the game only executed an honest version of Bob, that is, one that followed the Reach program exactly, including in his private local steps.
  It is possible for a deviant and dishonest version of a Bob backend to execute different code and always win by computing the appropriate guess based on what value Alice provided for <span class="snip"><span style="color: var(--shiki-color-text)">handAlice</span></span>.<a href="https://docs.reach.sh/tut/rps/#p_139" class="pid">139</a>
</p>
<p><i id="p_140" class="pid"></i>If we change Bob's code to the following:<a href="https://docs.reach.sh/tut/rps/#p_140" class="pid">140</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-4-attack/index.rsh">/examples/rps-4-attack/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Bob.only(() =&gt; {
    interact.acceptWager(wager);
    const handBob = (handAlice + 1) % 3;
  });
  Bob.publish(handBob)
    .pay(wager);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="27"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="28"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.acceptWager</span><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="29"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">;</span></li><li value="30"><span style="color: var(--shiki-color-text)">  });</span></li><li value="31"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(handBob)</span></li><li value="32"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager);</span></li></ol></pre>
<p><i id="p_141" class="pid"></i>then he will ignore the frontend and just compute the correct value.<a href="https://docs.reach.sh/tut/rps/#p_141" class="pid">141</a></p>
<p><i id="p_142" class="pid"></i>If we run this version of the program, we will see output like this:<a href="https://docs.reach.sh/tut/rps/#p_142" class="pid">142</a></p>
<pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run
Alice played Scissors
Bob accepts the wager of 5.
Alice saw outcome Bob wins
Bob saw outcome Bob wins
Alice went from 100 to 94.9999.
Bob went from 100 to 104.9999." href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="2"><span style="color: var(--shiki-color-text)">Alice played Scissors</span></li><li value="3"><span style="color: var(--shiki-color-text)">Bob accepts the wager of </span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">.</span></li><li value="4"><span style="color: var(--shiki-color-text)">Alice saw outcome Bob wins</span></li><li value="5"><span style="color: var(--shiki-color-text)">Bob saw outcome Bob wins</span></li><li value="6"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">94.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="7"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">104.9999</span><span style="color: var(--shiki-color-text)">.</span></li></ol></pre>
<p>
  <i id="p_143" class="pid"></i>In this version, unlike the honest version, Bob never consults the frontend and so it never prints out the message of what hand Bob played.
  No matter what Alice chooses, Bob will always win.<a href="https://docs.reach.sh/tut/rps/#p_143" class="pid">143</a>
</p>
<hr>
<p>
  <i id="p_144" class="pid"></i>Is it just a fluke of the random number generator that we observed Bob always winning?
  How would we know?
  Reach comes with an <a href="https://docs.reach.sh/guide/assert/#guide-assert">automatic verification</a> engine that we can use to mathematically prove that this version will always result in the <span class="snip"><span style="color: var(--shiki-color-text)">outcome</span></span> variable equalling <span class="snip"><span style="color: var(--shiki-token-constant)">0</span></span>, which means Bob wins.
  We can instruct Reach to prove this theorem by adding these lines after computing the <span class="snip"><span style="color: var(--shiki-color-text)">outcome</span></span>:<a href="https://docs.reach.sh/tut/rps/#p_144" class="pid">144</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-4-attack/index.rsh">/examples/rps-4-attack/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  const outcome = (handAlice + (4 - handBob)) % 3;
  require(handBob == (handAlice + 1) % 3);
  assert(outcome == 0);
  const            [forAlice, forBob] =" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="34"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">outcome</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_-" title="rsh: -"><span style="color: var(--shiki-token-keyword)">-</span></a><span style="color: var(--shiki-color-text)"> handBob)) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">;</span></li><li value="35"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_require" title="rsh: require"><span style="color: var(--shiki-token-function)">require</span></a><span style="color: var(--shiki-color-text)">(handBob </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> (handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></li><li value="36"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">);</span></li><li value="37"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)">            [</span><span style="color: var(--shiki-token-constant)">forAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">forBob</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span></li></ol></pre>
<ul>
  <li><i id="p_145" class="pid"></i>Line 35 requires that the dishonest version of Bob be used for the proof.<a href="https://docs.reach.sh/tut/rps/#p_145" class="pid">145</a></li>
  <li><i id="p_146" class="pid"></i>Line 36 conducts the proof by including an assert statement in the program.<a href="https://docs.reach.sh/tut/rps/#p_146" class="pid">146</a></li>
</ul>
<p><i id="p_147" class="pid"></i>Before we had this line in the file, when we ran <code>./reach compile</code>, it would print out the message:<a href="https://docs.reach.sh/tut/rps/#p_147" class="pid">147</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-3-bets/index.txt">/examples/rps-3-bets/index.txt</a><a class="far fa-copy copyBtn" data-clipboard-text="Verifying for generic connector
  Verifying when ALL participants are honest
  Verifying when NO participants are honest
Checked 12 theorems; No failures!" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="2">Verifying for generic connector</li><li value="3">  Verifying when ALL participants are honest</li><li value="4">  Verifying when NO participants are honest</li><li value="5">Checked 12 theorems; No failures!</li></ol></pre>
<p><i id="p_148" class="pid"></i>But now, it prints out<a href="https://docs.reach.sh/tut/rps/#p_148" class="pid">148</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-4-attack/index.txt">/examples/rps-4-attack/index.txt</a><a class="far fa-copy copyBtn" data-clipboard-text="Verifying for generic connector
  Verifying when ALL participants are honest
  Verifying when NO participants are honest
Checked 15 theorems; No failures!" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="2">Verifying for generic connector</li><li value="3">  Verifying when ALL participants are honest</li><li value="4">  Verifying when NO participants are honest</li><li value="5">Checked 15 theorems; No failures!</li></ol></pre>
<ul>
  <li>
    <i id="p_149" class="pid"></i>Line 7 is different and shows that more theorems have been proven about our program.
    It prints out five more, rather than one more, because the theorem is proved differently in the different verification modes.<a href="https://docs.reach.sh/tut/rps/#p_149" class="pid">149</a>
  </li>
</ul>
<hr>
<p>
  <i id="p_150" class="pid"></i>Many programming languages include <a href="https://en.wikipedia.org/wiki/Assertion_(software_development)">assertions</a> like this,
  but Reach is one of a small category where the compiler doesn't just insert a runtime check for the property,
  but actually conducts a mathematical proof at compile-time that the expression <em>always</em> evaluates to <span class="snip"><a href="https://docs.reach.sh/rsh/compute/#rsh_true" title="rsh: true"><span style="color: var(--shiki-token-constant)">true</span></a></span>.<a href="https://docs.reach.sh/tut/rps/#p_150" class="pid">150</a>
</p>
<p>
  <i id="p_151" class="pid"></i>In this case, we used Reach's <a href="https://docs.reach.sh/guide/assert/#guide-assert">automatic verification</a> engine to prove that an attack did what we expected it would.
  But, it is better to use verification to show that <em>no flaw</em> exists and <em>no attack</em> is possible.<a href="https://docs.reach.sh/tut/rps/#p_151" class="pid">151</a>
</p>
<p>
  <i id="p_152" class="pid"></i>Reach includes some such assertions automatically in every program.
  That's why every version of <em>Rock, Paper, Scissors!</em> has said that a number of theorems were checked.
  We can see what these theorems do by deliberately inserting an error into the program.<a href="https://docs.reach.sh/tut/rps/#p_152" class="pid">152</a>
</p>
<p><i id="p_153" class="pid"></i>Let's start by undoing the changes we made earlier by changing<a href="https://docs.reach.sh/tut/rps/#p_153" class="pid">153</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-4-attack/index.rsh">/examples/rps-4-attack/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="    const handBob = (handAlice + 1) % 3;" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="29"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">;</span></li></ol></pre>
<p><i id="p_154" class="pid"></i>back to<a href="https://docs.reach.sh/tut/rps/#p_154" class="pid">154</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-4-attack/index-bad.rsh">/examples/rps-4-attack/index-bad.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="    const handBob = declassify(interact.getHand());" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="29"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">());</span></li></ol></pre>
<p><i id="p_155" class="pid"></i>and removing<a href="https://docs.reach.sh/tut/rps/#p_155" class="pid">155</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-4-attack/index.rsh">/examples/rps-4-attack/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  require(handBob == (handAlice + 1) % 3);
  assert(outcome == 0);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="35"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_require" title="rsh: require"><span style="color: var(--shiki-token-function)">require</span></a><span style="color: var(--shiki-color-text)">(handBob </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> (handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></li><li value="36"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">);</span></li></ol></pre>
<p><i id="p_156" class="pid"></i>Let's change the computation of the payout and make it so that if Alice wins, then she only gets her wager back, not Bob's.<a href="https://docs.reach.sh/tut/rps/#p_156" class="pid">156</a></p>
<p><i id="p_157" class="pid"></i>We should now have something that looks like<a href="https://docs.reach.sh/tut/rps/#p_157" class="pid">157</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-4-attack/index-bad.rsh">/examples/rps-4-attack/index-bad.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Bob.only(() =&gt; {
    interact.acceptWager(wager);
    const handBob = declassify(interact.getHand());
  });
  Bob.publish(handBob)
    .pay(wager);

  const outcome = (handAlice + (4 - handBob)) % 3;
  const            [forAlice, forBob] =
    outcome == 2 ? [       1,      0] : // &lt;- Oops. was: [2, 0]
    outcome == 0 ? [       0,      2] :
    /* tie      */ [       1,      1];
  transfer(forAlice * wager).to(Alice);
  transfer(forBob * wager).to(Bob);
  commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="27"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="28"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.acceptWager</span><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="29"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">());</span></li><li value="30"><span style="color: var(--shiki-color-text)">  });</span></li><li value="31"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(handBob)</span></li><li value="32"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="33"></li><li value="34"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">outcome</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_-" title="rsh: -"><span style="color: var(--shiki-token-keyword)">-</span></a><span style="color: var(--shiki-color-text)"> handBob)) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">;</span></li><li value="35"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)">            [</span><span style="color: var(--shiki-token-constant)">forAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">forBob</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span></li><li value="36"><span style="color: var(--shiki-color-text)">    outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_?" title="rsh: ?"><span style="color: var(--shiki-token-keyword)">?</span></a><span style="color: var(--shiki-color-text)"> [       </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-comment)">// &lt;- Oops. was: [2, 0]</span></li><li value="37"><span style="color: var(--shiki-color-text)">    outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_?" title="rsh: ?"><span style="color: var(--shiki-token-keyword)">?</span></a><span style="color: var(--shiki-color-text)"> [       </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">:</span></li><li value="38"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">/* tie      */</span><span style="color: var(--shiki-color-text)"> [       </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">];</span></li><li value="39"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer" title="rsh: transfer"><span style="color: var(--shiki-token-function)">transfer</span></a><span style="color: var(--shiki-color-text)">(forAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_*" title="rsh: *"><span style="color: var(--shiki-token-keyword)">*</span></a><span style="color: var(--shiki-color-text)"> wager)</span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer.to" title="rsh: transfer.to"><span style="color: var(--shiki-token-function)">.to</span></a><span style="color: var(--shiki-color-text)">(Alice);</span></li><li value="40"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer" title="rsh: transfer"><span style="color: var(--shiki-token-function)">transfer</span></a><span style="color: var(--shiki-color-text)">(forBob </span><a href="https://docs.reach.sh/rsh/compute/#rsh_*" title="rsh: *"><span style="color: var(--shiki-token-keyword)">*</span></a><span style="color: var(--shiki-color-text)"> wager)</span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer.to" title="rsh: transfer.to"><span style="color: var(--shiki-token-function)">.to</span></a><span style="color: var(--shiki-color-text)">(Bob);</span></li><li value="41"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<ul>
  <li><i id="p_158" class="pid"></i>Line 36 has <span class="snip"><span style="color: var(--shiki-color-text)">[</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">]</span></span>, but should have <span class="snip"><span style="color: var(--shiki-color-text)">[</span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">]</span></span>.<a href="https://docs.reach.sh/tut/rps/#p_158" class="pid">158</a></li>
</ul>
<p><i id="p_159" class="pid"></i>When we run <code>./reach compile (reachexlink rps-4-attack/index-bad.rsh)</code>, it gives details about the error:<a href="https://docs.reach.sh/tut/rps/#p_159" class="pid">159</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-4-attack/index-bad.txt">/examples/rps-4-attack/index-bad.txt</a><a class="far fa-copy copyBtn" data-clipboard-text="Verification failed:
  when ALL participants are honest
  of theorem: assert
  msg: &quot;balance zero at application exit&quot;
  at ./index-bad.rsh:8:30:compileDApp

  // Violation Witness

  const UInt.max = 2;

  const wager/81 = &quot;Alice&quot;.interact.wager;
  //    ^ could = 1
  //      from: ./index-bad.rsh:11:10:property binding
  const handAlice/84 = protect&lt;UInt&gt;(&quot;Alice&quot;.interact.getHand());
  //    ^ could = 0
  //      from: ./index-bad.rsh:21:50:application
  const handBob/94 = protect&lt;UInt&gt;(&quot;Bob&quot;.interact.getHand());
  //    ^ could = 2
  //      from: ./index-bad.rsh:29:48:application

  // Theorem Formalization

  const outcome/103 = (handAlice/84 + (4 - handBob/94)) % 3;
  //    ^ would be 2
  const v110 = ((outcome/103 == 2) ? [1, 0 ] : ((outcome/103 == 0) ? [0, 2 ] : [1, 1 ]));
  //    ^ would be [1, 0 ]
  const v124 = 0 == (((wager/81 + wager/81) - (v110[0] * wager/81)) - (v110[1] * wager/81));
  //    ^ would be false" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="4">Verification failed:</li><li value="5">  when ALL participants are honest</li><li value="6">  of theorem: assert</li><li value="7">  msg: "balance zero at application exit"</li><li value="8">  at ./index-bad.rsh:8:30:compileDApp</li><li value="9"></li><li value="10">  // Violation Witness</li><li value="11"></li><li value="12">  const UInt.max = 2;</li><li value="13"></li><li value="14">  const wager/81 = "Alice".interact.wager;</li><li value="15">  //    ^ could = 1</li><li value="16">  //      from: ./index-bad.rsh:11:10:property binding</li><li value="17">  const handAlice/84 = protect&lt;UInt&gt;("Alice".interact.getHand());</li><li value="18">  //    ^ could = 0</li><li value="19">  //      from: ./index-bad.rsh:21:50:application</li><li value="20">  const handBob/94 = protect&lt;UInt&gt;("Bob".interact.getHand());</li><li value="21">  //    ^ could = 2</li><li value="22">  //      from: ./index-bad.rsh:29:48:application</li><li value="23"></li><li value="24">  // Theorem Formalization</li><li value="25"></li><li value="26">  const outcome/103 = (handAlice/84 + (4 - handBob/94)) % 3;</li><li value="27">  //    ^ would be 2</li><li value="28">  const v110 = ((outcome/103 == 2) ? [1, 0 ] : ((outcome/103 == 0) ? [0, 2 ] : [1, 1 ]));</li><li value="29">  //    ^ would be [1, 0 ]</li><li value="30">  const v124 = 0 == (((wager/81 + wager/81) - (v110[0] * wager/81)) - (v110[1] * wager/81));</li><li value="31">  //    ^ would be false</li></ol></pre>
<p><i id="p_160" class="pid"></i>There's a lot of information in the compiler output that can help an experienced programmer track down the problem. But the most important parts are<a href="https://docs.reach.sh/tut/rps/#p_160" class="pid">160</a></p>
<ul>
  <li><i id="p_161" class="pid"></i>Line 7 says that this is an attempt to prove the theorem that the balance at the end of the program is zero, which means that no network tokens are sealed in the contract forever.<a href="https://docs.reach.sh/tut/rps/#p_161" class="pid">161</a></li>
  <li><i id="p_162" class="pid"></i>Lines 10-20 describe the values that could cause the theorem to fail.<a href="https://docs.reach.sh/tut/rps/#p_162" class="pid">162</a></li>
  <li><i id="p_163" class="pid"></i>Lines 23-31 outline the theorem that failed.<a href="https://docs.reach.sh/tut/rps/#p_163" class="pid">163</a></li>
</ul>
<p><i id="p_164" class="pid"></i>These kinds of <a href="https://docs.reach.sh/guide/assert/#guide-assert">automatic verifications</a> are helpful for Reach programmers, because they don't need to remember to put them in their program, and they will still be protected from entire categories of errors.<a href="https://docs.reach.sh/tut/rps/#p_164" class="pid">164</a></p>
<hr>
<p><i id="p_165" class="pid"></i>However, now let's add an assertion to the program that will ensure that every version of the program that allows Bob to know Alice's hand before he chooses his own will be rejected.<a href="https://docs.reach.sh/tut/rps/#p_165" class="pid">165</a></p>
<p>
  <i id="p_166" class="pid"></i>We'll go back to the version of <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-3-bets/index.rsh"><code>rps-3-bets/index.rsh</code></a> from the last section, which has an honest version of Bob.
  (Click on the preceding link if you need to see what it contained.)<a href="https://docs.reach.sh/tut/rps/#p_166" class="pid">166</a>
</p>
<p><i id="p_167" class="pid"></i>We'll add a single line to the program after Alice publishes, but before Bob takes a local step:<a href="https://docs.reach.sh/tut/rps/#p_167" class="pid">167</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-4-attack/index-fails.rsh">/examples/rps-4-attack/index-fails.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Alice.publish(wager, handAlice)
    .pay(wager);
  commit();

  unknowable(Bob, Alice(handAlice));
  Bob.only(() =&gt; {
    interact.acceptWager(wager);
    const handBob = declassify(interact.getHand());
  });" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="23"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(wager</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handAlice)</span></li><li value="24"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="25"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="26"></li><li value="27"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/step/#rsh_unknowable" title="rsh: unknowable"><span style="color: var(--shiki-token-function)">unknowable</span></a><span style="color: var(--shiki-color-text)">(Bob</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Alice</span><span style="color: var(--shiki-color-text)">(handAlice));</span></li><li value="28"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="29"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.acceptWager</span><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="30"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">());</span></li><li value="31"><span style="color: var(--shiki-color-text)">  });</span></li></ol></pre>
<ul>
  <li>
    <i id="p_168" class="pid"></i>Line 27 contains a knowledge assertion that Bob cannot know Alice's value <span class="snip"><span style="color: var(--shiki-color-text)">handAlice</span></span> at this point in the program.
    In this case, it is obvious that this is not true, because Alice shares <span class="snip"><span style="color: var(--shiki-color-text)">handAlice</span></span> at line 23.
    In many cases, this is not obvious and Reach's <a href="https://docs.reach.sh/guide/assert/#guide-assert">automatic verification</a> engine has to reason about how values that Bob <em>does know</em> are connected to values that might be related to Alice's secret values.<a href="https://docs.reach.sh/tut/rps/#p_168" class="pid">168</a>
  </li>
</ul>
<p><i id="p_169" class="pid"></i>When we run <code>./reach run</code>, it reports that this assertion is false:<a href="https://docs.reach.sh/tut/rps/#p_169" class="pid">169</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-4-attack/index-fails.txt">/examples/rps-4-attack/index-fails.txt</a><a class="far fa-copy copyBtn" data-clipboard-text="Verification failed:
  of theorem unknowable(&quot;Bob&quot;, handAlice/87)
  at ./index-fails.rsh:27:13:application

  Bob knows of handAlice/87 because it is published." href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="2">Verification failed:</li><li value="3">  of theorem unknowable("Bob", handAlice/87)</li><li value="4">  at ./index-fails.rsh:27:13:application</li><li value="5"></li><li value="6">  Bob knows of handAlice/87 because it is published.</li></ol></pre>
<p>
  <i id="p_170" class="pid"></i>It is not enough to correct failures and attacks when you discover them.
  You must <strong>always</strong> add an assertion to your program that would fail to hold if the attack or failure were present.
  This ensures that all similar attacks are not present and that they will not accidentally be reintroduced.<a href="https://docs.reach.sh/tut/rps/#p_170" class="pid">170</a>
</p>
<hr>
<p><i id="p_171" class="pid"></i>Let's use these insights into <a href="https://docs.reach.sh/guide/assert/#guide-assert">automatic verification</a> and rewrite our <em>Rock, Paper, Scissors!</em> so that it is more trustworthy and secure.<a href="https://docs.reach.sh/tut/rps/#p_171" class="pid">171</a></p>
<p><i id="p_172" class="pid"></i>Since we've been making lots of changes to the code, let's start fresh with a new version and we'll look at every single line again, to make sure that you aren't missing anything.<a href="https://docs.reach.sh/tut/rps/#p_172" class="pid">172</a></p>
<p><i id="p_173" class="pid"></i>First, we'll define the rules of <em>Rock, Paper, Scissors!</em> a little bit more abstractly, so we can separate the logic of the game from the details of the application:<a href="https://docs.reach.sh/tut/rps/#p_173" class="pid">173</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.rsh">/examples/rps-5-trust/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="&#39;reach 0.1&#39;;

const [ isHand, ROCK, PAPER, SCISSORS ] = makeEnum(3);
const [ isOutcome, B_WINS, DRAW, A_WINS ] = makeEnum(3);

const winner = (handAlice, handBob) =&gt;
  ((handAlice + (4 - handBob)) % 3);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-string-expression)">'reach 0.1'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="2"></li><li value="3"><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> [ </span><span style="color: var(--shiki-token-constant)">isHand</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">ROCK</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">PAPER</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">SCISSORS</span><span style="color: var(--shiki-color-text)"> ] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_makeEnum" title="rsh: makeEnum"><span style="color: var(--shiki-token-function)">makeEnum</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></li><li value="4"><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> [ </span><span style="color: var(--shiki-token-constant)">isOutcome</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">B_WINS</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">DRAW</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">A_WINS</span><span style="color: var(--shiki-color-text)"> ] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_makeEnum" title="rsh: makeEnum"><span style="color: var(--shiki-token-function)">makeEnum</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></li><li value="5"></li><li value="6"><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (handAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handBob) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a></li><li value="7"><span style="color: var(--shiki-color-text)">  ((handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_-" title="rsh: -"><span style="color: var(--shiki-token-keyword)">-</span></a><span style="color: var(--shiki-color-text)"> handBob)) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></li></ol></pre>
<ul>
  <li><i id="p_174" class="pid"></i>Line 1 is the usual Reach version header.<a href="https://docs.reach.sh/tut/rps/#p_174" class="pid">174</a></li>
  <li><i id="p_175" class="pid"></i>Lines 3 and 4 define enumerations for the hands that may be played, as well as the outcomes of the game.<a href="https://docs.reach.sh/tut/rps/#p_175" class="pid">175</a></li>
  <li><i id="p_176" class="pid"></i>Lines 6 and 7 define the function that computes the winner of the game.<a href="https://docs.reach.sh/tut/rps/#p_176" class="pid">176</a></li>
</ul>
<p>
  <i id="p_177" class="pid"></i>When we first wrote <em>Rock, Paper, Scissors!</em>, we asked you to trust that this formula for computing the winner is correct, but it is good to actually check.
  One way to check would be to implement a JavaScript frontend that didn't interact with a real user, nor would it randomly generate values, but instead, it would return specific testing scenario values and check that the output is as expected.
  That's a typical way to debug and is possible with Reach.
  However, Reach allows us to write such test cases directly into the Reach program as verification assertions.<a href="https://docs.reach.sh/tut/rps/#p_177" class="pid">177</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.rsh">/examples/rps-5-trust/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="assert(winner(ROCK, PAPER) == B_WINS);
assert(winner(PAPER, ROCK) == A_WINS);
assert(winner(ROCK, ROCK) == DRAW);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="9"><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">ROCK</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">PAPER</span><span style="color: var(--shiki-color-text)">) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">B_WINS</span><span style="color: var(--shiki-color-text)">);</span></li><li value="10"><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">PAPER</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">ROCK</span><span style="color: var(--shiki-color-text)">) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">A_WINS</span><span style="color: var(--shiki-color-text)">);</span></li><li value="11"><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">ROCK</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">ROCK</span><span style="color: var(--shiki-color-text)">) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">DRAW</span><span style="color: var(--shiki-color-text)">);</span></li></ol></pre>
<ul>
  <li><i id="p_178" class="pid"></i>Line 9 makes an assertion that when Alice plays Rock and Bob plays Paper, then Bob wins as expected.<a href="https://docs.reach.sh/tut/rps/#p_178" class="pid">178</a></li>
</ul>
<p>
  <i id="p_179" class="pid"></i>But, Reach's <a href="https://docs.reach.sh/guide/assert/#guide-assert">automatic verification</a> allows us to express even more powerful statements about our program's behavior.
  For example, we can state that no matter what values are provided for <span class="snip"><span style="color: var(--shiki-color-text)">handAlice</span></span> and <span class="snip"><span style="color: var(--shiki-color-text)">handBob</span></span>, <span class="snip"><span style="color: var(--shiki-color-text)">winner</span></span> will always provide a valid outcome:<a href="https://docs.reach.sh/tut/rps/#p_179" class="pid">179</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.rsh">/examples/rps-5-trust/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="forall(UInt, handAlice =&gt;
  forall(UInt, handBob =&gt;
    assert(isOutcome(winner(handAlice, handBob)))));" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="13"><a href="https://docs.reach.sh/rsh/compute/#rsh_forall" title="rsh: forall"><span style="color: var(--shiki-token-function)">forall</span></a><span style="color: var(--shiki-color-text)">(UInt</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a></li><li value="14"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_forall" title="rsh: forall"><span style="color: var(--shiki-token-function)">forall</span></a><span style="color: var(--shiki-color-text)">(UInt</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handBob </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a></li><li value="15"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">isOutcome</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(handAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handBob)))));</span></li></ol></pre>
<p><i id="p_180" class="pid"></i>And we can specify that whenever the same value is provided for both hands, no matter what it is, <span class="snip"><span style="color: var(--shiki-color-text)">winner</span></span> always returns <span class="snip"><span style="color: var(--shiki-token-constant)">DRAW</span></span>:<a href="https://docs.reach.sh/tut/rps/#p_180" class="pid">180</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.rsh">/examples/rps-5-trust/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="forall(UInt, (hand) =&gt;
  assert(winner(hand, hand) == DRAW));" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="17"><a href="https://docs.reach.sh/rsh/compute/#rsh_forall" title="rsh: forall"><span style="color: var(--shiki-token-function)">forall</span></a><span style="color: var(--shiki-color-text)">(UInt</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> (hand) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a></li><li value="18"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(hand</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> hand) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">DRAW</span><span style="color: var(--shiki-color-text)">));</span></li></ol></pre>
<p>
  <i id="p_181" class="pid"></i>These examples both use <span class="snip"><a href="https://docs.reach.sh/rsh/compute/#rsh_forall" title="rsh: forall"><span style="color: var(--shiki-color-text)">forall</span></a></span>, which allows Reach programmers to quantify over all possible values that might be provided to a part of their program.
  You might think that these theorems will take a very long time to prove, because they have to loop over all the billions and billions of possibilities (e.g., Ethereum uses 256-bits for its unsigned integers) for the bits of <span class="snip"><span style="color: var(--shiki-color-text)">handAlice</span></span> (twice!) and <span class="snip"><span style="color: var(--shiki-color-text)">handBob</span></span>.
  In fact, on rudimentary laptops, it takes less than half a second.
  That's because Reach uses an advanced <a href="https://docs.reach.sh/guide/reach/#guide-reach">symbolic execution engine</a> to reason about this theorem abstractly without considering individual values.<a href="https://docs.reach.sh/tut/rps/#p_181" class="pid">181</a>
</p>
<p>
  <i id="p_182" class="pid"></i>Let's continue the program by specifying the participant interact interfaces for Alice and Bob.
  These will be mostly the same as before, except that we will also expect that each frontend can provide access to random numbers.
  We'll use these later on to protect Alice's hand.<a href="https://docs.reach.sh/tut/rps/#p_182" class="pid">182</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.rsh">/examples/rps-5-trust/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="const Player = {
  ...hasRandom, // &lt;--- new!
  getHand: Fun([], UInt),
  seeOutcome: Fun([UInt], Null),
};" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="20"><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Player</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="21"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">...</span><a href="https://docs.reach.sh/rsh/compute/#rsh_hasRandom" title="rsh: hasRandom"><span style="color: var(--shiki-color-text)">hasRandom</span></a><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-comment)">// &lt;--- new!</span></li><li value="22"><span style="color: var(--shiki-color-text)">  getHand</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> UInt)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="23"><span style="color: var(--shiki-color-text)">  seeOutcome</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([UInt]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="24"><span style="color: var(--shiki-color-text)">};</span></li></ol></pre>
<p>
  <i id="p_183" class="pid"></i>The only line that is different is line 21, which includes <span class="snip"><a href="https://docs.reach.sh/rsh/compute/#rsh_hasRandom" title="rsh: hasRandom"><span style="color: var(--shiki-color-text)">hasRandom</span></a></span>, from the Reach standard library, in the interface.
  We'll use this to generate a random number to protect Alice's hand.<a href="https://docs.reach.sh/tut/rps/#p_183" class="pid">183</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.mjs">/examples/rps-5-trust/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="const Player = (Who) =&gt; ({
  ...stdlib.hasRandom, // &lt;--- new!
  getHand: () =&gt; {
    const hand = Math.floor(Math.random() * 3);
    console.log(`${Who} played ${HAND[hand]}`);
    return hand;
  },
  seeOutcome: (outcome) =&gt; {
    console.log(`${Who} saw outcome ${OUTCOME[outcome]}`);
  },
});" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="19"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (Who) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> ({</span></li><li value="20"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.hasRandom" title="js: stdlib.hasRandom"><span style="color: var(--shiki-color-text)">.hasRandom</span></a><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-comment)">// &lt;--- new!</span></li><li value="21"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">getHand</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="22"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">hand</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Math</span><span style="color: var(--shiki-token-function)">.floor</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">Math</span><span style="color: var(--shiki-token-function)">.random</span><span style="color: var(--shiki-color-text)">() </span><span style="color: var(--shiki-token-keyword)">*</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></li><li value="23"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">Who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> played </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">HAND</span><span style="color: var(--shiki-color-text)">[hand]</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="24"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> hand;</span></li><li value="25"><span style="color: var(--shiki-color-text)">  }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="26"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">seeOutcome</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (outcome) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="27"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">Who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> saw outcome </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">OUTCOME</span><span style="color: var(--shiki-color-text)">[outcome]</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="28"><span style="color: var(--shiki-color-text)">  }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="29"><span style="color: var(--shiki-color-text)">});</span></li></ol></pre>
<p>
  <i id="p_184" class="pid"></i>Similarly, we only need to modify one line of our JavaScript frontend.
  Line 20 allows each participant's Reach code to generate random numbers as necessary.<a href="https://docs.reach.sh/tut/rps/#p_184" class="pid">184</a>
</p>
<p>
  <i id="p_185" class="pid"></i>These two changes might look identical, but they mean very different things.
  The first, line 21 in the Reach program, adds <span class="snip"><a href="https://docs.reach.sh/rsh/compute/#rsh_hasRandom" title="rsh: hasRandom"><span style="color: var(--shiki-color-text)">hasRandom</span></a></span> to the interface that the backend expects the frontend to provide.
  The second, line 20 in the JavaScript, adds <span class="snip"><a href="https://docs.reach.sh/rsh/compute/#rsh_hasRandom" title="rsh: hasRandom"><span style="color: var(--shiki-color-text)">hasRandom</span></a></span> to the implementation that the frontend provides to the backend.<a href="https://docs.reach.sh/tut/rps/#p_185" class="pid">185</a>
</p>
<p><i id="p_186" class="pid"></i>Next, we'll create the Reach app and the participant interact interface for Alice and Bob. Nothing here is new.<a href="https://docs.reach.sh/tut/rps/#p_186" class="pid">186</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.rsh">/examples/rps-5-trust/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="export const main = Reach.App(() =&gt; {
  const Alice = Participant(&#39;Alice&#39;, {
    ...Player,
    wager: UInt,
  });
  const Bob   = Participant(&#39;Bob&#39;, {
    ...Player,
    acceptWager: Fun([UInt], Null),
  });
  init();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="26"><a href="https://docs.reach.sh/rsh/module/#rsh_export" title="rsh: export"><span style="color: var(--shiki-token-keyword)">export</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">main</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/module/#rsh_Reach" title="rsh: Reach"><span style="color: var(--shiki-token-constant)">Reach</span></a><a href="https://docs.reach.sh/rsh/module/#rsh_Reach.App" title="rsh: Reach.App"><span style="color: var(--shiki-token-function)">.App</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="27"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Alice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="28"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">Player</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="29"><span style="color: var(--shiki-color-text)">    wager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> UInt</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="30"><span style="color: var(--shiki-color-text)">  });</span></li><li value="31"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Bob</span><span style="color: var(--shiki-color-text)">   </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Bob'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="32"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">Player</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="33"><span style="color: var(--shiki-color-text)">    acceptWager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([UInt]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="34"><span style="color: var(--shiki-color-text)">  });</span></li><li value="35"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_init" title="rsh: init"><span style="color: var(--shiki-token-function)">init</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<p>
  <i id="p_187" class="pid"></i>We're now at the crucial juncture where we will implement the actual application and ensure that Alice's hand is protected until after Bob reveals his hand.
  The simplest thing would be to have Alice just publish the wager, but this, of course, would just leave Bob vulnerable.
  We need Alice to be able to publish her hand, but also keep it secret.
  This is a job for a <a href="https://en.wikipedia.org/wiki/Commitment_scheme">cryptographic commitment scheme</a>.
  Reach's standard library comes with <span class="snip"><a href="https://docs.reach.sh/rsh/local/#rsh_makeCommitment" title="rsh: makeCommitment"><span style="color: var(--shiki-color-text)">makeCommitment</span></a></span> to make this easier for you.<a href="https://docs.reach.sh/tut/rps/#p_187" class="pid">187</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.rsh">/examples/rps-5-trust/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Alice.only(() =&gt; {
    const wager = declassify(interact.wager);
    const _handAlice = interact.getHand();
    const [_commitAlice, _saltAlice] = makeCommitment(interact, _handAlice);
    const commitAlice = declassify(_commitAlice);
  });
  Alice.publish(wager, commitAlice)
    .pay(wager);
  commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="37"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="38"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">wager</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-color-text)">.wager);</span></li><li value="39"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">_handAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">();</span></li><li value="40"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-constant)">_commitAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">_saltAlice</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_makeCommitment" title="rsh: makeCommitment"><span style="color: var(--shiki-token-function)">makeCommitment</span></a><span style="color: var(--shiki-color-text)">(interact</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> _handAlice);</span></li><li value="41"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">commitAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(_commitAlice);</span></li><li value="42"><span style="color: var(--shiki-color-text)">  });</span></li><li value="43"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(wager</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> commitAlice)</span></li><li value="44"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="45"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<ul>
  <li><i id="p_188" class="pid"></i>Line 39 has Alice compute her hand, but <em>not</em> declassify it.<a href="https://docs.reach.sh/tut/rps/#p_188" class="pid">188</a></li>
  <li>
    <i id="p_189" class="pid"></i>Line 40 has her compute a commitment to the hand.
    It comes with a secret "salt" value that must be revealed later.
    This "salt" was generated by the <span class="snip"><span style="color: var(--shiki-color-text)">random</span></span> function inside of <span class="snip"><a href="https://docs.reach.sh/rsh/compute/#rsh_hasRandom" title="rsh: hasRandom"><span style="color: var(--shiki-color-text)">hasRandom</span></a></span> and it's why we pass <span class="snip"><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-color-text)">interact</span></a></span> to this function.<a href="https://docs.reach.sh/tut/rps/#p_189" class="pid">189</a>
  </li>
  <li><i id="p_190" class="pid"></i>Line 41 has Alice declassify the commitment.<a href="https://docs.reach.sh/tut/rps/#p_190" class="pid">190</a></li>
  <li><i id="p_191" class="pid"></i>Line 43 has her publish them, and line 44 has her include the wager funds in the publication.<a href="https://docs.reach.sh/tut/rps/#p_191" class="pid">191</a></li>
</ul>
<p><i id="p_192" class="pid"></i>At this point, we can state the knowledge assertion that Bob can't know either the hand or the "salt" and continue with his part of the program.<a href="https://docs.reach.sh/tut/rps/#p_192" class="pid">192</a></p>
<div class="note">
  <p>
    <i id="p_193" class="pid"></i>It is important to include the salt in the commitment, so that multiple commitments to the same value are not identical.
    Similarly, it is important not to share the salt until later, because if an attacker knows the set of possible values, they can enumerate them and compare with the result of the commitment and learn the value.
    That's why we use a randomly generated salt.<a href="https://docs.reach.sh/tut/rps/#p_193" class="pid">193</a>
  </p>
</div>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.rsh">/examples/rps-5-trust/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  unknowable(Bob, Alice(_handAlice, _saltAlice));
  Bob.only(() =&gt; {
    interact.acceptWager(wager);
    const handBob = declassify(interact.getHand());
  });
  Bob.publish(handBob)
    .pay(wager);
  commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="47"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/step/#rsh_unknowable" title="rsh: unknowable"><span style="color: var(--shiki-token-function)">unknowable</span></a><span style="color: var(--shiki-color-text)">(Bob</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Alice</span><span style="color: var(--shiki-color-text)">(_handAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> _saltAlice));</span></li><li value="48"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="49"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.acceptWager</span><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="50"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">());</span></li><li value="51"><span style="color: var(--shiki-color-text)">  });</span></li><li value="52"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(handBob)</span></li><li value="53"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="54"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<ul>
  <li><i id="p_194" class="pid"></i>Line 47 states the knowledge assertion.<a href="https://docs.reach.sh/tut/rps/#p_194" class="pid">194</a></li>
  <li><i id="p_195" class="pid"></i>Lines 48 through 53 are unchanged from the original version.<a href="https://docs.reach.sh/tut/rps/#p_195" class="pid">195</a></li>
  <li><i id="p_196" class="pid"></i>Line 54 has the transaction commit, without computing the payout, because we can't yet, because Alice's hand is not yet public.<a href="https://docs.reach.sh/tut/rps/#p_196" class="pid">196</a></li>
</ul>
<p><i id="p_197" class="pid"></i>We now return to Alice who can reveal her secrets.<a href="https://docs.reach.sh/tut/rps/#p_197" class="pid">197</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.rsh">/examples/rps-5-trust/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Alice.only(() =&gt; {
    const saltAlice = declassify(_saltAlice);
    const handAlice = declassify(_handAlice);
  });
  Alice.publish(saltAlice, handAlice);
  checkCommitment(commitAlice, saltAlice, handAlice);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="56"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="57"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">saltAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(_saltAlice);</span></li><li value="58"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(_handAlice);</span></li><li value="59"><span style="color: var(--shiki-color-text)">  });</span></li><li value="60"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(saltAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handAlice);</span></li><li value="61"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_checkCommitment" title="rsh: checkCommitment"><span style="color: var(--shiki-token-function)">checkCommitment</span></a><span style="color: var(--shiki-color-text)">(commitAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> saltAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handAlice);</span></li></ol></pre>
<ul>
  <li><i id="p_198" class="pid"></i>Lines 57 and 58 have Alice declassify the secret information.<a href="https://docs.reach.sh/tut/rps/#p_198" class="pid">198</a></li>
  <li><i id="p_199" class="pid"></i>Line 60 has her publish it.<a href="https://docs.reach.sh/tut/rps/#p_199" class="pid">199</a></li>
  <li>
    <i id="p_200" class="pid"></i>Line 61 checks that the published values match the original values.
    This will always be the case with honest participants, but dishonest participants may violate this assumption.<a href="https://docs.reach.sh/tut/rps/#p_200" class="pid">200</a>
  </li>
</ul>
<p><i id="p_201" class="pid"></i>The rest of the program is unchanged from the original version, except that it uses the new names for the outcomes:<a href="https://docs.reach.sh/tut/rps/#p_201" class="pid">201</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.rsh">/examples/rps-5-trust/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  const outcome = winner(handAlice, handBob);
  const                 [forAlice, forBob] =
    outcome == A_WINS ? [       2,      0] :
    outcome == B_WINS ? [       0,      2] :
    /* tie           */ [       1,      1];
  transfer(forAlice * wager).to(Alice);
  transfer(forBob   * wager).to(Bob);
  commit();

  each([Alice, Bob], () =&gt; {
    interact.seeOutcome(outcome);
  });" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="63"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">outcome</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(handAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handBob);</span></li><li value="64"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)">                 [</span><span style="color: var(--shiki-token-constant)">forAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">forBob</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span></li><li value="65"><span style="color: var(--shiki-color-text)">    outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">A_WINS</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_?" title="rsh: ?"><span style="color: var(--shiki-token-keyword)">?</span></a><span style="color: var(--shiki-color-text)"> [       </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">:</span></li><li value="66"><span style="color: var(--shiki-color-text)">    outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">B_WINS</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_?" title="rsh: ?"><span style="color: var(--shiki-token-keyword)">?</span></a><span style="color: var(--shiki-color-text)"> [       </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">:</span></li><li value="67"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">/* tie           */</span><span style="color: var(--shiki-color-text)"> [       </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">];</span></li><li value="68"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer" title="rsh: transfer"><span style="color: var(--shiki-token-function)">transfer</span></a><span style="color: var(--shiki-color-text)">(forAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_*" title="rsh: *"><span style="color: var(--shiki-token-keyword)">*</span></a><span style="color: var(--shiki-color-text)"> wager)</span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer.to" title="rsh: transfer.to"><span style="color: var(--shiki-token-function)">.to</span></a><span style="color: var(--shiki-color-text)">(Alice);</span></li><li value="69"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer" title="rsh: transfer"><span style="color: var(--shiki-token-function)">transfer</span></a><span style="color: var(--shiki-color-text)">(forBob   </span><a href="https://docs.reach.sh/rsh/compute/#rsh_*" title="rsh: *"><span style="color: var(--shiki-token-keyword)">*</span></a><span style="color: var(--shiki-color-text)"> wager)</span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer.to" title="rsh: transfer.to"><span style="color: var(--shiki-token-function)">.to</span></a><span style="color: var(--shiki-color-text)">(Bob);</span></li><li value="70"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="71"></li><li value="72"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/step/#rsh_each" title="rsh: each"><span style="color: var(--shiki-token-function)">each</span></a><span style="color: var(--shiki-color-text)">([Alice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Bob]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="73"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.seeOutcome</span><span style="color: var(--shiki-color-text)">(outcome);</span></li><li value="74"><span style="color: var(--shiki-color-text)">  });</span></li></ol></pre>
<p><i id="p_202" class="pid"></i>Since we didn't have to change the frontend in any meaningful way, the output of running <code>./reach run</code> is still the same as it ever was:<a href="https://docs.reach.sh/tut/rps/#p_202" class="pid">202</a></p>
<pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run
Alice played Scissors
Bob accepts the wager of 5.
Bob played Paper
Bob saw outcome Alice wins
Alice saw outcome Alice wins
Alice went from 100 to 104.9999.
Bob went from 100 to 94.9999.

$ ./reach run
Alice played Paper
Bob accepts the wager of 5.
Bob played Scissors
Bob saw outcome Bob wins
Alice saw outcome Bob wins
Alice went from 100 to 94.9999.
Bob went from 100 to 104.9999.

$ ./reach run
Alice played Scissors
Bob accepts the wager of 5.
Bob played Scissors
Bob saw outcome Draw
Alice saw outcome Draw
Alice went from 10 to 9.9999.
Bob went from 10 to 9.9999." href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="2"><span style="color: var(--shiki-color-text)">Alice played Scissors</span></li><li value="3"><span style="color: var(--shiki-color-text)">Bob accepts the wager of </span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">.</span></li><li value="4"><span style="color: var(--shiki-color-text)">Bob played Paper</span></li><li value="5"><span style="color: var(--shiki-color-text)">Bob saw outcome Alice wins</span></li><li value="6"><span style="color: var(--shiki-color-text)">Alice saw outcome Alice wins</span></li><li value="7"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">104.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="8"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">94.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="9"></li><li value="10"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="11"><span style="color: var(--shiki-color-text)">Alice played Paper</span></li><li value="12"><span style="color: var(--shiki-color-text)">Bob accepts the wager of </span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">.</span></li><li value="13"><span style="color: var(--shiki-color-text)">Bob played Scissors</span></li><li value="14"><span style="color: var(--shiki-color-text)">Bob saw outcome Bob wins</span></li><li value="15"><span style="color: var(--shiki-color-text)">Alice saw outcome Bob wins</span></li><li value="16"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">94.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="17"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">104.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="18"></li><li value="19"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="20"><span style="color: var(--shiki-color-text)">Alice played Scissors</span></li><li value="21"><span style="color: var(--shiki-color-text)">Bob accepts the wager of </span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">.</span></li><li value="22"><span style="color: var(--shiki-color-text)">Bob played Scissors</span></li><li value="23"><span style="color: var(--shiki-color-text)">Bob saw outcome Draw</span></li><li value="24"><span style="color: var(--shiki-color-text)">Alice saw outcome Draw</span></li><li value="25"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">9.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="26"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">9.9999</span><span style="color: var(--shiki-color-text)">.</span></li></ol></pre>
<p><i id="p_203" class="pid"></i>Except now, behind the scenes, and without any changes to the frontend, Alice takes two steps in our program and Bob only takes one, and she is protected against Bob finding her hand and using it to ensure he wins!<a href="https://docs.reach.sh/tut/rps/#p_203" class="pid">203</a></p>
<p>
  <i id="p_204" class="pid"></i>When we compile this version of the application, Reach's <a href="https://docs.reach.sh/guide/assert/#guide-assert">automatic formal verification</a> engine proves many theorems and protects us against a plethora of mistakes one might make when writing even a simple application like this.
  Non-Reach programmers that try to write decentralized applications are on their own trying to ensure that these problems don't exist.<a href="https://docs.reach.sh/tut/rps/#p_204" class="pid">204</a>
</p>
<div class="note">
  <p><i id="p_205" class="pid"></i>If your version isn't working, look at the complete versions of <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.rsh"><code>rps-5-trust/index.rsh</code></a> and <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-5-trust/index.mjs"><code>rps-5-trust/index.mjs</code></a> to make sure you copied everything down correctly!<a href="https://docs.reach.sh/tut/rps/#p_205" class="pid">205</a></p>
</div>
<p>
  <i id="p_206" class="pid"></i>Now our implementation of <em>Rock, Paper, Scissors!</em> is secure and doesn't contain any exploits for either Alice or Bob to guarantee a win.
  However, it still has a final category of mistake that is common in decentralized applications: <a href="https://docs.reach.sh/guide/timeout/#guide-timeout">non-participation</a>.
  We'll fix this in <a href="https://docs.reach.sh/tut/rps/#tut-6">the next step</a>; make sure you don't launch with this version, or Alice may decide to back out of the game when she knows she's going to lose!<a href="https://docs.reach.sh/tut/rps/#p_206" class="pid">206</a>
</p>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q4">
  <p><i id="p_207" class="pid"></i>Since blockchain programs run on a single, global, publicly-checked and certified consensus network, you don’t need to test them as much as normal software, which run on a wide variety of different platforms and operating systems.<a href="https://docs.reach.sh/tut/rps/#p_207" class="pid">207</a></p>
  <div class="collapse" id="q4">
    <p><i id="p_208" class="pid"></i>False<a href="https://docs.reach.sh/tut/rps/#p_208" class="pid">208</a></p>
  </div>
</div>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q5">
  <p><i id="p_209" class="pid"></i>It is easy to write correct programs that handle financial information, and even if you make a mistake, blockchains support an "Undo" operation that allows you to rollback to earlier versions of the ledger to correct mistakes and recover lost funds.<a href="https://docs.reach.sh/tut/rps/#p_209" class="pid">209</a></p>
  <div class="collapse" id="q5">
    <p><i id="p_210" class="pid"></i>False<a href="https://docs.reach.sh/tut/rps/#p_210" class="pid">210</a></p>
  </div>
</div>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q6">
  <p><i id="p_211" class="pid"></i>Reach provides automatic verifications to ensure that your program does not lose, lock away, or overspend funds and guarantees that your applications are free from entire categories of errors.<a href="https://docs.reach.sh/tut/rps/#p_211" class="pid">211</a></p>
  <div class="collapse" id="q6">
    <p><i id="p_212" class="pid"></i>True<a href="https://docs.reach.sh/tut/rps/#p_212" class="pid">212</a></p>
  </div>
</div>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q7">
  <p><i id="p_213" class="pid"></i>Reach provides tools for you to add custom verifications to your program, like ensuring that information is known only to one party, or that your implementation of a sensitive algorithm is correct.<a href="https://docs.reach.sh/tut/rps/#p_213" class="pid">213</a></p>
  <div class="collapse" id="q7">
    <p><i id="p_214" class="pid"></i>True<a href="https://docs.reach.sh/tut/rps/#p_214" class="pid">214</a></p>
  </div>
</div>
<h2 id="tut-6" class="refHeader">Timeouts and Participation<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-6"><span class="icon icon-link"></span></a></h2>
<p>
  <i id="p_215" class="pid"></i>In the last section, we removed a security vulnerability from <em>Rock, Paper, Scissors!</em> that was a clear attack on the viability of the application.
  In this section, we'll focus on a more subtle issue that is important and unique to decentralized applications: <a href="https://docs.reach.sh/guide/timeout/#guide-timeout">non-participation</a>.<a href="https://docs.reach.sh/tut/rps/#p_215" class="pid">215</a>
</p>
<p><i id="p_216" class="pid"></i>Non-participation refers to the act of one party ceasing to continue playing their role in an application.<a href="https://docs.reach.sh/tut/rps/#p_216" class="pid">216</a></p>
<p>
  <i id="p_217" class="pid"></i>In traditional client-server programs, like a Web server, this would be the case of a client not sending any more requests to the server, or the server stopping sending responses to the client.
  In these sorts of traditional programs, non-participation is an exceptional circumstance that normally leads to an error message for clients and, at most, a log entry for servers.
  Sometimes traditional programs will need to recycle resources, like network ports, on non-participation, but they would have also needed to do that if the transaction ended by normal means.
  In other words, for traditional client-server programs, it is not necessary for designers to meticulously consider the consequences of non-participation.<a href="https://docs.reach.sh/tut/rps/#p_217" class="pid">217</a>
</p>
<p>
  <i id="p_218" class="pid"></i>In contrast, decentralized applications must be carefully designed with an eye towards their behavior in the face of non-participation.
  For example, consider what happens in our <em>Rock, Paper, Scissors!</em> game if after Alice has paid her wager, Bob never accepts and the application doesn't continue.
  In this case, Alice's network tokens would be locked inside of the contract and lost to her.
  Similarly, if after Bob accepted and paid his wager, Alice stopped participating and never submitted her hand, then both their funds would be locked away forever.
  In each of these cases, both parties would be greatly hurt and their fear of that outcome would introduce an additional cost to transacting, which would lower the value they got from participating in the application.
  Of course, in a situation like <em>Rock, Paper, Scissors!</em> this is unlikely to be an important matter, but recall that <em>Rock, Paper, Scissors!</em> is a microcosm of decentralized application design.<a href="https://docs.reach.sh/tut/rps/#p_218" class="pid">218</a>
</p>
<div class="note">
  <p>
    <i id="p_219" class="pid"></i>Technically, in the first case, when Bob fails to start the application, Alice is not locked away from her funds: since Bob's identity is not fixed until after his first message, she could start another instance of the game as the Bob role and then she'd win all of the funds, less any transaction costs of the consensus network.
    In the second case, however, there would be no recourse for either party.<a href="https://docs.reach.sh/tut/rps/#p_219" class="pid">219</a>
  </p>
</div>
<p>
  <i id="p_220" class="pid"></i>In the rest of this section, we'll discuss how Reach helps address non-participation.
  For a longer discussion, refer to <a href="https://docs.reach.sh/guide/timeout/#guide-timeout">the guide chapter on non-participation</a>.<a href="https://docs.reach.sh/tut/rps/#p_220" class="pid">220</a>
</p>
<hr>
<p>
  <i id="p_221" class="pid"></i>In Reach, non-participation is handled through a "timeout" mechanism whereby each consensus transfer can be paired with a step that occurs for all participants if the originator of the consensus transfer fails to make the required publication before a particular network time.
  We'll integrate this mechanism into our version of <em>Rock, Paper, Scissors!</em> and deliberately insert non-participation into our JavaScript testing program to watch the consequences play out.<a href="https://docs.reach.sh/tut/rps/#p_221" class="pid">221</a>
</p>
<p><i id="p_222" class="pid"></i>First, we'll modify the participant interact interface to allow the frontend to be informed that a timeout occurred.<a href="https://docs.reach.sh/tut/rps/#p_222" class="pid">222</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-6-timeouts/index.rsh">/examples/rps-6-timeouts/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="const Player = {
  ...hasRandom,
  getHand: Fun([], UInt),
  seeOutcome: Fun([UInt], Null),
  informTimeout: Fun([], Null),
};" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="20"><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Player</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="21"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">...</span><a href="https://docs.reach.sh/rsh/compute/#rsh_hasRandom" title="rsh: hasRandom"><span style="color: var(--shiki-color-text)">hasRandom</span></a><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="22"><span style="color: var(--shiki-color-text)">  getHand</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> UInt)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="23"><span style="color: var(--shiki-color-text)">  seeOutcome</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([UInt]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="24"><span style="color: var(--shiki-color-text)">  informTimeout</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="25"><span style="color: var(--shiki-color-text)">};</span></li></ol></pre>
<ul>
  <li>
    <i id="p_223" class="pid"></i>Line 24 introduces a new method, <span class="snip"><span style="color: var(--shiki-color-text)">informTimeout</span></span>, that receives no arguments and returns no information.
    We'll call this function when a timeout occurs.<a href="https://docs.reach.sh/tut/rps/#p_223" class="pid">223</a>
  </li>
</ul>
<p><i id="p_224" class="pid"></i>We'll make a slight tweak to our JavaScript frontend to be able to receive this message and display it on the console.<a href="https://docs.reach.sh/tut/rps/#p_224" class="pid">224</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-6-timeouts/index.mjs">/examples/rps-6-timeouts/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="const Player = (Who) =&gt; ({
  ...stdlib.hasRandom,
  getHand: () =&gt; {
    const hand = Math.floor(Math.random() * 3);
    console.log(`${Who} played ${HAND[hand]}`);
    return hand;
  },
  seeOutcome: (outcome) =&gt; {
    console.log(`${Who} saw outcome ${OUTCOME[outcome]}`);
  },
  informTimeout: () =&gt; {
    console.log(`${Who} observed a timeout`);
  },
});" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="19"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (Who) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> ({</span></li><li value="20"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.hasRandom" title="js: stdlib.hasRandom"><span style="color: var(--shiki-color-text)">.hasRandom</span></a><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="21"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">getHand</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="22"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">hand</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Math</span><span style="color: var(--shiki-token-function)">.floor</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">Math</span><span style="color: var(--shiki-token-function)">.random</span><span style="color: var(--shiki-color-text)">() </span><span style="color: var(--shiki-token-keyword)">*</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></li><li value="23"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">Who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> played </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">HAND</span><span style="color: var(--shiki-color-text)">[hand]</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="24"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> hand;</span></li><li value="25"><span style="color: var(--shiki-color-text)">  }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="26"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">seeOutcome</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (outcome) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="27"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">Who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> saw outcome </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">OUTCOME</span><span style="color: var(--shiki-color-text)">[outcome]</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="28"><span style="color: var(--shiki-color-text)">  }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="29"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">informTimeout</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="30"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">Who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> observed a timeout`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="31"><span style="color: var(--shiki-color-text)">  }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="32"><span style="color: var(--shiki-color-text)">});</span></li></ol></pre>
<p>
  <i id="p_225" class="pid"></i>Back in the Reach program, we'll declare a value to use as a standard deadline throughout the program.
  Similar to how she provides the wager, we will have Alice also provide the deadline.<a href="https://docs.reach.sh/tut/rps/#p_225" class="pid">225</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-6-timeouts/index.rsh">/examples/rps-6-timeouts/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  const Alice = Participant(&#39;Alice&#39;, {
    ...Player,
    wager: UInt, // atomic units of currency
    deadline: UInt, // time delta (blocks/rounds)
  });" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="28"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Alice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="29"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">Player</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="30"><span style="color: var(--shiki-color-text)">    wager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> UInt</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-comment)">// atomic units of currency</span></li><li value="31"><span style="color: var(--shiki-color-text)">    deadline</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> UInt</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-comment)">// time delta (blocks/rounds)</span></li><li value="32"><span style="color: var(--shiki-color-text)">  });</span></li></ol></pre>
<ul>
  <li>
    <i id="p_226" class="pid"></i>Line 31 adds the <span class="snip"><span style="color: var(--shiki-color-text)">deadline</span></span> field to Alice's participant interact interface.
    It is defined as some number of time delta units,
    which are an abstraction of the underlying notion of network time in the consensus network.
    In many networks, like Ethereum, this number is a number of blocks.<a href="https://docs.reach.sh/tut/rps/#p_226" class="pid">226</a>
  </li>
</ul>
<p><i id="p_227" class="pid"></i>Next, at the start of the Reach application, we'll define a helper function to inform each of the participants of the timeout by calling this new method.<a href="https://docs.reach.sh/tut/rps/#p_227" class="pid">227</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-6-timeouts/index.rsh">/examples/rps-6-timeouts/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  const informTimeout = () =&gt; {
    each([Alice, Bob], () =&gt; {
      interact.informTimeout();
    });
  };" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="39"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">informTimeout</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="40"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_each" title="rsh: each"><span style="color: var(--shiki-token-function)">each</span></a><span style="color: var(--shiki-color-text)">([Alice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Bob]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="41"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.informTimeout</span><span style="color: var(--shiki-color-text)">();</span></li><li value="42"><span style="color: var(--shiki-color-text)">    });</span></li><li value="43"><span style="color: var(--shiki-color-text)">  };</span></li></ol></pre>
<ul>
  <li><i id="p_228" class="pid"></i>Line 39 defines the function as an arrow expression.<a href="https://docs.reach.sh/tut/rps/#p_228" class="pid">228</a></li>
  <li><i id="p_229" class="pid"></i>Line 40 has each of the participants perform a local step.<a href="https://docs.reach.sh/tut/rps/#p_229" class="pid">229</a></li>
  <li><i id="p_230" class="pid"></i>Line 41 has them call the new <span class="snip"><span style="color: var(--shiki-color-text)">informTimeout</span></span> method.<a href="https://docs.reach.sh/tut/rps/#p_230" class="pid">230</a></li>
</ul>
<p><i id="p_231" class="pid"></i>We will have Alice declassify and publish the <span class="snip"><span style="color: var(--shiki-color-text)">deadline</span></span> for later timeout clauses.<a href="https://docs.reach.sh/tut/rps/#p_231" class="pid">231</a></p>
<p>
  <i id="p_232" class="pid"></i>We won't add a timeout clause to Alice's first message, because there is no consequence to her non-participation:
  if she doesn't start the game, then no one is any worse off.<a href="https://docs.reach.sh/tut/rps/#p_232" class="pid">232</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-6-timeouts/index.rsh">/examples/rps-6-timeouts/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Alice.only(() =&gt; {
    const wager = declassify(interact.wager);
    const _handAlice = interact.getHand();
    const [_commitAlice, _saltAlice] = makeCommitment(interact, _handAlice);
    const commitAlice = declassify(_commitAlice);
    const deadline = declassify(interact.deadline);
  });
  Alice.publish(wager, commitAlice, deadline)
    .pay(wager);
  commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="45"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="46"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">wager</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-color-text)">.wager);</span></li><li value="47"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">_handAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">();</span></li><li value="48"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-constant)">_commitAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">_saltAlice</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_makeCommitment" title="rsh: makeCommitment"><span style="color: var(--shiki-token-function)">makeCommitment</span></a><span style="color: var(--shiki-color-text)">(interact</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> _handAlice);</span></li><li value="49"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">commitAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(_commitAlice);</span></li><li value="50"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">deadline</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-color-text)">.deadline);</span></li><li value="51"><span style="color: var(--shiki-color-text)">  });</span></li><li value="52"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(wager</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> commitAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> deadline)</span></li><li value="53"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="54"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<ul>
  <li><i id="p_233" class="pid"></i>Line 50 has Alice declassify the <span class="snip"><span style="color: var(--shiki-color-text)">deadline</span></span> time delta.<a href="https://docs.reach.sh/tut/rps/#p_233" class="pid">233</a></li>
  <li><i id="p_234" class="pid"></i>Line 52 now has Alice publish the <span class="snip"><span style="color: var(--shiki-color-text)">deadline</span></span>.<a href="https://docs.reach.sh/tut/rps/#p_234" class="pid">234</a></li>
</ul>
<p><i id="p_235" class="pid"></i>However, we will adjust Bob's first message, because if he fails to participate, then Alice's initial wager will be lost to her.<a href="https://docs.reach.sh/tut/rps/#p_235" class="pid">235</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-6-timeouts/index.rsh">/examples/rps-6-timeouts/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Bob.publish(handBob)
    .pay(wager)
    .timeout(relativeTime(deadline), () =&gt; closeTo(Alice, informTimeout));
  commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="61"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(handBob)</span></li><li value="62"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager)</span></li><li value="63"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_timeout" title="rsh: timeout"><span style="color: var(--shiki-token-function)">.timeout</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/compute/#rsh_relativeTime" title="rsh: relativeTime"><span style="color: var(--shiki-token-function)">relativeTime</span></a><span style="color: var(--shiki-color-text)">(deadline)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/step/#rsh_closeTo" title="rsh: closeTo"><span style="color: var(--shiki-token-function)">closeTo</span></a><span style="color: var(--shiki-color-text)">(Alice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> informTimeout));</span></li><li value="64"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<ul>
  <li><i id="p_236" class="pid"></i>Line 63 adds a timeout handler to Bob's publication.<a href="https://docs.reach.sh/tut/rps/#p_236" class="pid">236</a></li>
</ul>
<p>
  <i id="p_237" class="pid"></i>The timeout handler specifies that if Bob does not complete this action within a time delta of <span class="snip"><span style="color: var(--shiki-color-text)">deadline</span></span>, then the application transitions to the step given by the arrow expression.
  In this case, the timeout code is a call to <span class="snip"><a href="https://docs.reach.sh/rsh/step/#rsh_closeTo" title="rsh: closeTo"><span style="color: var(--shiki-color-text)">closeTo</span></a></span>, which is a Reach standard library function that allows anyone to send a message and transfer all of the funds in the contract to Alice, then call the given function afterwards.
  This means that if Bob fails to publish his hand, then Alice will take her network tokens back.<a href="https://docs.reach.sh/tut/rps/#p_237" class="pid">237</a>
</p>
<p><i id="p_238" class="pid"></i>We will add a similar timeout handler to Alice's second message.<a href="https://docs.reach.sh/tut/rps/#p_238" class="pid">238</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-6-timeouts/index.rsh">/examples/rps-6-timeouts/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Alice.publish(saltAlice, handAlice)
    .timeout(relativeTime(deadline), () =&gt; closeTo(Bob, informTimeout));" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="70"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(saltAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handAlice)</span></li><li value="71"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_timeout" title="rsh: timeout"><span style="color: var(--shiki-token-function)">.timeout</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/compute/#rsh_relativeTime" title="rsh: relativeTime"><span style="color: var(--shiki-token-function)">relativeTime</span></a><span style="color: var(--shiki-color-text)">(deadline)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/step/#rsh_closeTo" title="rsh: closeTo"><span style="color: var(--shiki-token-function)">closeTo</span></a><span style="color: var(--shiki-color-text)">(Bob</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> informTimeout));</span></li></ol></pre>
<p>
  <i id="p_239" class="pid"></i>But in this case, Bob will be able to claim all of the funds if Alice doesn't participate.
  You might think that it would be "fair" for Alice's funds to be returned to Alice and Bob's to Bob.
  However, if we implemented it that way,
  then Alice would be wise to always timeout if she were going to lose,
  which she knows will happen, because she knows her hand and Bob's hand.<a href="https://docs.reach.sh/tut/rps/#p_239" class="pid">239</a>
</p>
<p><i id="p_240" class="pid"></i>These are the only changes we need to make to the Reach program to make it robust against non-participation: eleven lines!<a href="https://docs.reach.sh/tut/rps/#p_240" class="pid">240</a></p>
<hr>
<p><i id="p_241" class="pid"></i>Let's modify the JavaScript frontend to deliberately cause a timeout sometimes when Bob is supposed to accept the wager.<a href="https://docs.reach.sh/tut/rps/#p_241" class="pid">241</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-6-timeouts/index.mjs">/examples/rps-6-timeouts/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="await Promise.all([
  ctcAlice.p.Alice({
    ...Player(&#39;Alice&#39;),
    wager: stdlib.parseCurrency(5),
    deadline: 10,
  }),
  ctcBob.p.Bob({
    ...Player(&#39;Bob&#39;),
    acceptWager: async (amt) =&gt; { // &lt;-- async now
      if ( Math.random() &lt;= 0.5 ) {
        for ( let i = 0; i &lt; 10; i++ ) {
          console.log(`  Bob takes his sweet time...`);
          await stdlib.wait(1);
        }
      } else {
        console.log(`Bob accepts the wager of ${fmt(amt)}.`);
      }
    },
  }),
]);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="34"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Promise</span><span style="color: var(--shiki-token-function)">.all</span><span style="color: var(--shiki-color-text)">([</span></li><li value="35"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">ctcAlice</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">p</span><span style="color: var(--shiki-token-function)">.Alice</span><span style="color: var(--shiki-color-text)">({</span></li><li value="36"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="37"><span style="color: var(--shiki-color-text)">    wager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-token-function)">.parseCurrency</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="38"><span style="color: var(--shiki-color-text)">    deadline</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="39"><span style="color: var(--shiki-color-text)">  })</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="40"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">ctcBob</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">p</span><span style="color: var(--shiki-token-function)">.Bob</span><span style="color: var(--shiki-color-text)">({</span></li><li value="41"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Bob'</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="42"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">acceptWager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> (amt) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> { </span><span style="color: var(--shiki-token-comment)">// &lt;-- async now</span></li><li value="43"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> ( </span><span style="color: var(--shiki-token-constant)">Math</span><span style="color: var(--shiki-token-function)">.random</span><span style="color: var(--shiki-color-text)">() </span><span style="color: var(--shiki-token-keyword)">&lt;=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0.5</span><span style="color: var(--shiki-color-text)"> ) {</span></li><li value="44"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">for</span><span style="color: var(--shiki-color-text)"> ( </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let" title="js: let"><span style="color: var(--shiki-token-keyword)">let</span></a><span style="color: var(--shiki-color-text)"> i </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">; i </span><span style="color: var(--shiki-token-keyword)">&lt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-color-text)">; i</span><span style="color: var(--shiki-token-keyword)">++</span><span style="color: var(--shiki-color-text)"> ) {</span></li><li value="45"><span style="color: var(--shiki-color-text)">          </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`  Bob takes his sweet time...`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="46"><span style="color: var(--shiki-color-text)">          </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.wait" title="js: stdlib.wait"><span style="color: var(--shiki-token-function)">.wait</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">);</span></li><li value="47"><span style="color: var(--shiki-color-text)">        }</span></li><li value="48"><span style="color: var(--shiki-color-text)">      } </span><span style="color: var(--shiki-token-keyword)">else</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="49"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Bob accepts the wager of </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-function)">fmt</span><span style="color: var(--shiki-color-text)">(amt)</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">.`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="50"><span style="color: var(--shiki-color-text)">      }</span></li><li value="51"><span style="color: var(--shiki-color-text)">    }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="52"><span style="color: var(--shiki-color-text)">  })</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="53"><span style="color: var(--shiki-color-text)">]);</span></li></ol></pre>
<ul>
  <li><i id="p_242" class="pid"></i>Line 38 has Alice specify a <span class="snip"><span style="color: var(--shiki-color-text)">deadline</span></span> of ten blocks.<a href="https://docs.reach.sh/tut/rps/#p_242" class="pid">242</a></li>
  <li>
    <i id="p_243" class="pid"></i>Lines 42 through 51 redefine Bob's <span class="snip"><span style="color: var(--shiki-color-text)">acceptWager</span></span> method as an asynchronous function,
    where half of the time it will take at least ten blocks on the Ethereum network by waiting for ten units of time to pass.
    We know that ten is the value of <span class="snip"><span style="color: var(--shiki-color-text)">deadline</span></span>, so this will cause a timeout.<a href="https://docs.reach.sh/tut/rps/#p_243" class="pid">243</a>
  </li>
</ul>
<hr>
<p><i id="p_244" class="pid"></i>Let's run the program and see what happens:<a href="https://docs.reach.sh/tut/rps/#p_244" class="pid">244</a></p>
<pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run
Alice played Rock
Bob accepts the wager of 5.
Bob played Paper
Bob saw outcome Bob wins
Alice saw outcome Bob wins
Alice went from 100 to 94.9999.
Bob went from 100 to 104.9999.

$ ./reach run
Alice played Scissors
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
Bob played Scissors
Bob observed a timeout
Alice observed a timeout
Alice went from 10 to 9.9999.
Bob went from 10 to 9.9999.

$ ./reach run
Alice played Paper
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
  Bob takes his sweet time...
Bob played Scissors
Bob observed a timeout
Alice observed a timeout
Alice went from 10 to 9.9999.
Bob went from 10 to 9.9999." href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="2"><span style="color: var(--shiki-color-text)">Alice played Rock</span></li><li value="3"><span style="color: var(--shiki-color-text)">Bob accepts the wager of </span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">.</span></li><li value="4"><span style="color: var(--shiki-color-text)">Bob played Paper</span></li><li value="5"><span style="color: var(--shiki-color-text)">Bob saw outcome Bob wins</span></li><li value="6"><span style="color: var(--shiki-color-text)">Alice saw outcome Bob wins</span></li><li value="7"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">94.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="8"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">104.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="9"></li><li value="10"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="11"><span style="color: var(--shiki-color-text)">Alice played Scissors</span></li><li value="12"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="13"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="14"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="15"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="16"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="17"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="18"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="19"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="20"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="21"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="22"><span style="color: var(--shiki-color-text)">Bob played Scissors</span></li><li value="23"><span style="color: var(--shiki-color-text)">Bob observed a </span><span style="color: var(--shiki-token-constant)">timeout</span></li><li value="24"><span style="color: var(--shiki-color-text)">Alice observed a </span><span style="color: var(--shiki-token-constant)">timeout</span></li><li value="25"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">9.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="26"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">9.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="27"></li><li value="28"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="29"><span style="color: var(--shiki-color-text)">Alice played Paper</span></li><li value="30"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="31"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="32"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="33"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="34"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="35"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="36"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="37"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="38"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="39"><span style="color: var(--shiki-color-text)">  Bob takes his sweet </span><span style="color: var(--shiki-token-function)">time</span><span style="color: var(--shiki-color-text)">...</span></li><li value="40"><span style="color: var(--shiki-color-text)">Bob played Scissors</span></li><li value="41"><span style="color: var(--shiki-color-text)">Bob observed a </span><span style="color: var(--shiki-token-constant)">timeout</span></li><li value="42"><span style="color: var(--shiki-color-text)">Alice observed a </span><span style="color: var(--shiki-token-constant)">timeout</span></li><li value="43"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">9.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="44"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">9.9999</span><span style="color: var(--shiki-color-text)">.</span></li></ol></pre>
<p><i id="p_245" class="pid"></i>Of course, when you run, you may not get two of the three times ending in a timeout.<a href="https://docs.reach.sh/tut/rps/#p_245" class="pid">245</a></p>
<div class="note">
  <p><i id="p_246" class="pid"></i>If your version isn't working, look at the complete versions of <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-6-timeouts/index.rsh"><code>rps-6-timeouts/index.rsh</code></a> and <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-6-timeouts/index.mjs"><code>rps-6-timeouts/index.mjs</code></a> to make sure you copied everything down correctly!<a href="https://docs.reach.sh/tut/rps/#p_246" class="pid">246</a></p>
</div>
<p>
  <i id="p_247" class="pid"></i>Now our implementation of <em>Rock, Paper, Scissors!</em> is robust against either participant dropping from the game.
  In <a href="https://docs.reach.sh/tut/rps/#tut-7">the next step</a>, we'll extend the application to disallow draws and have Alice and Bob play again until there is a winner.<a href="https://docs.reach.sh/tut/rps/#p_247" class="pid">247</a>
</p>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q8">
  <p><i id="p_248" class="pid"></i>What happens in a decentralized application when one participant refuses to take the next step of the program? For example, if Alice refuses to share her hand with Bob in a game of ‘Rock, Paper, Scissors’.<a href="https://docs.reach.sh/tut/rps/#p_248" class="pid">248</a></p>
  <ol>
    <li><i id="p_249" class="pid"></i>This is not possible, because the blockchain guarantees that each party performs a particular set of actions;<a href="https://docs.reach.sh/tut/rps/#p_249" class="pid">249</a></li>
    <li><i id="p_250" class="pid"></i>The program hangs forever waiting for Alice to provide the value;<a href="https://docs.reach.sh/tut/rps/#p_250" class="pid">250</a></li>
    <li><i id="p_251" class="pid"></i>Alice is punished and the program proceeds as-if Bob were the winner;<a href="https://docs.reach.sh/tut/rps/#p_251" class="pid">251</a></li>
    <li><i id="p_252" class="pid"></i>It depends on how the program was written; if the developer used Reach, the default is (2), but the developer could include a <span class="snip"><a href="https://docs.reach.sh/rsh/step/#rsh_timeout" title="rsh: timeout"><span style="color: var(--shiki-color-text)">timeout</span></a></span> block to implement the (3) behavior.<a href="https://docs.reach.sh/tut/rps/#p_252" class="pid">252</a></li>
  </ol>
  <div class="collapse" id="q8">
    <p><i id="p_253" class="pid"></i>4; Reach empowers programmers to design the application with the business logic they want.<a href="https://docs.reach.sh/tut/rps/#p_253" class="pid">253</a></p>
  </div>
</div>
<h2 id="tut-7" class="refHeader">Play and Play Again<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-7"><span class="icon icon-link"></span></a></h2>
<p><i id="p_254" class="pid"></i>In this section, we extend our application so that Alice and Bob will continue to play against each other until there is a clear winner, so if it is a draw they will continue playing.<a href="https://docs.reach.sh/tut/rps/#p_254" class="pid">254</a></p>
<p>
  <i id="p_255" class="pid"></i>This will only require a change to the Reach program, not the JavaScript frontend, but we will take the opportunity to modify the frontend so that timeouts can happen to both parties when they are asked to submit their hands.
  Let's do that to get it out of the way and not distract from the main task of removing draws.<a href="https://docs.reach.sh/tut/rps/#p_255" class="pid">255</a>
</p>
<p><i id="p_256" class="pid"></i>We'll modify the <span class="snip"><span style="color: var(--shiki-color-text)">Player</span></span> interact object so that it will have a different <span class="snip"><span style="color: var(--shiki-color-text)">getHand</span></span> method.<a href="https://docs.reach.sh/tut/rps/#p_256" class="pid">256</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-7-loops/index.mjs">/examples/rps-7-loops/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="const Player = (Who) =&gt; ({
  ...stdlib.hasRandom,
  getHand: async () =&gt; { // &lt;-- async now
    const hand = Math.floor(Math.random() * 3);
    console.log(`${Who} played ${HAND[hand]}`);
    if ( Math.random() &lt;= 0.01 ) {
      for ( let i = 0; i &lt; 10; i++ ) {
        console.log(`  ${Who} takes their sweet time sending it back...`);
        await stdlib.wait(1);
      }
    }
    return hand;
  },
  seeOutcome: (outcome) =&gt; {
    console.log(`${Who} saw outcome ${OUTCOME[outcome]}`);
  },
  informTimeout: () =&gt; {
    console.log(`${Who} observed a timeout`);
  },
});" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="19"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (Who) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> ({</span></li><li value="20"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.hasRandom" title="js: stdlib.hasRandom"><span style="color: var(--shiki-color-text)">.hasRandom</span></a><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="21"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">getHand</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> { </span><span style="color: var(--shiki-token-comment)">// &lt;-- async now</span></li><li value="22"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">hand</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Math</span><span style="color: var(--shiki-token-function)">.floor</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">Math</span><span style="color: var(--shiki-token-function)">.random</span><span style="color: var(--shiki-color-text)">() </span><span style="color: var(--shiki-token-keyword)">*</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></li><li value="23"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">Who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> played </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">HAND</span><span style="color: var(--shiki-color-text)">[hand]</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="24"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> ( </span><span style="color: var(--shiki-token-constant)">Math</span><span style="color: var(--shiki-token-function)">.random</span><span style="color: var(--shiki-color-text)">() </span><span style="color: var(--shiki-token-keyword)">&lt;=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0.01</span><span style="color: var(--shiki-color-text)"> ) {</span></li><li value="25"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-keyword)">for</span><span style="color: var(--shiki-color-text)"> ( </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let" title="js: let"><span style="color: var(--shiki-token-keyword)">let</span></a><span style="color: var(--shiki-color-text)"> i </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">; i </span><span style="color: var(--shiki-token-keyword)">&lt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-color-text)">; i</span><span style="color: var(--shiki-token-keyword)">++</span><span style="color: var(--shiki-color-text)"> ) {</span></li><li value="26"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`  </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">Who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> takes their sweet time sending it back...`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="27"><span style="color: var(--shiki-color-text)">        </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.wait" title="js: stdlib.wait"><span style="color: var(--shiki-token-function)">.wait</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">);</span></li><li value="28"><span style="color: var(--shiki-color-text)">      }</span></li><li value="29"><span style="color: var(--shiki-color-text)">    }</span></li><li value="30"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> hand;</span></li><li value="31"><span style="color: var(--shiki-color-text)">  }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="32"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">seeOutcome</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (outcome) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="33"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">Who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> saw outcome </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">OUTCOME</span><span style="color: var(--shiki-color-text)">[outcome]</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="34"><span style="color: var(--shiki-color-text)">  }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="35"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">informTimeout</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="36"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">Who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)"> observed a timeout`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="37"><span style="color: var(--shiki-color-text)">  }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="38"><span style="color: var(--shiki-color-text)">});</span></li></ol></pre>
<ul>
  <li>
    <i id="p_257" class="pid"></i>Lines 24 through 29 moves the forced timeout code that we wrote for Bob's <span class="snip"><span style="color: var(--shiki-color-text)">acceptWager</span></span> function into this method.
    We also change the threshold so that timeouts only happen 1% of the time.
    This isn't a very interesting behavior, so we'll make it much less frequent.<a href="https://docs.reach.sh/tut/rps/#p_257" class="pid">257</a>
  </li>
</ul>
<p>
  <i id="p_258" class="pid"></i>We also adjust Bob's <span class="snip"><span style="color: var(--shiki-color-text)">acceptWager</span></span> function to remove the timeout code, since we're testing that differently now.
  It's just a matter of reverting to the simpler version from before.<a href="https://docs.reach.sh/tut/rps/#p_258" class="pid">258</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-7-loops/index.mjs">/examples/rps-7-loops/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="await Promise.all([
  ctcAlice.p.Alice({
    ...Player(&#39;Alice&#39;),
    wager: stdlib.parseCurrency(5),
    deadline: 10,
  }),
  ctcBob.p.Bob({
    ...Player(&#39;Bob&#39;),
    acceptWager: (amt) =&gt; {
      console.log(`Bob accepts the wager of ${fmt(amt)}.`);
    },
  }),
]);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="40"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Promise</span><span style="color: var(--shiki-token-function)">.all</span><span style="color: var(--shiki-color-text)">([</span></li><li value="41"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">ctcAlice</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">p</span><span style="color: var(--shiki-token-function)">.Alice</span><span style="color: var(--shiki-color-text)">({</span></li><li value="42"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="43"><span style="color: var(--shiki-color-text)">    wager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-token-function)">.parseCurrency</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="44"><span style="color: var(--shiki-color-text)">    deadline</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="45"><span style="color: var(--shiki-color-text)">  })</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="46"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">ctcBob</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">p</span><span style="color: var(--shiki-token-function)">.Bob</span><span style="color: var(--shiki-color-text)">({</span></li><li value="47"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Bob'</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="48"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">acceptWager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (amt) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="49"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Bob accepts the wager of </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-function)">fmt</span><span style="color: var(--shiki-color-text)">(amt)</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">.`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="50"><span style="color: var(--shiki-color-text)">    }</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="51"><span style="color: var(--shiki-color-text)">  })</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="52"><span style="color: var(--shiki-color-text)">]);</span></li></ol></pre>
<ul>
  <li><i id="p_259" class="pid"></i>Lines 48 through 50 have the simpler <span class="snip"><span style="color: var(--shiki-color-text)">acceptWager</span></span> method for Bob.<a href="https://docs.reach.sh/tut/rps/#p_259" class="pid">259</a></li>
</ul>
<hr>
<p>
  <i id="p_260" class="pid"></i>Now, let's look at the Reach application.
  All of the details about the playing of the game and the interface to the players will remain the same.
  The only thing that's going to be different is the order the actions take place.<a href="https://docs.reach.sh/tut/rps/#p_260" class="pid">260</a>
</p>
<p><i id="p_261" class="pid"></i>It used to be that the steps were:<a href="https://docs.reach.sh/tut/rps/#p_261" class="pid">261</a></p>
<ol>
  <li><i id="p_262" class="pid"></i>Alice sends her wager and commitment.<a href="https://docs.reach.sh/tut/rps/#p_262" class="pid">262</a></li>
  <li><i id="p_263" class="pid"></i>Bob accepts the wager and sends his hand.<a href="https://docs.reach.sh/tut/rps/#p_263" class="pid">263</a></li>
  <li><i id="p_264" class="pid"></i>Alice reveals her hand.<a href="https://docs.reach.sh/tut/rps/#p_264" class="pid">264</a></li>
  <li><i id="p_265" class="pid"></i>The game ends.<a href="https://docs.reach.sh/tut/rps/#p_265" class="pid">265</a></li>
</ol>
<p><i id="p_266" class="pid"></i>But, now because the players may submit many hands, but should only have a single wager, we'll break these steps up differently, as follows:<a href="https://docs.reach.sh/tut/rps/#p_266" class="pid">266</a></p>
<ol>
  <li><i id="p_267" class="pid"></i>Alice sends her wager.<a href="https://docs.reach.sh/tut/rps/#p_267" class="pid">267</a></li>
  <li><i id="p_268" class="pid"></i>Bob accepts the wager.<a href="https://docs.reach.sh/tut/rps/#p_268" class="pid">268</a></li>
  <li><i id="p_269" class="pid"></i>Alice sends her commitment.<a href="https://docs.reach.sh/tut/rps/#p_269" class="pid">269</a></li>
  <li><i id="p_270" class="pid"></i>Bob sends his hand.<a href="https://docs.reach.sh/tut/rps/#p_270" class="pid">270</a></li>
  <li><i id="p_271" class="pid"></i>Alice reveals her hand.<a href="https://docs.reach.sh/tut/rps/#p_271" class="pid">271</a></li>
  <li><i id="p_272" class="pid"></i>If it's draw, return to step 3; otherwise, the game ends.<a href="https://docs.reach.sh/tut/rps/#p_272" class="pid">272</a></li>
</ol>
<p><i id="p_273" class="pid"></i>Let's make these changes now.<a href="https://docs.reach.sh/tut/rps/#p_273" class="pid">273</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-7-loops/index.rsh">/examples/rps-7-loops/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Alice.only(() =&gt; {
    const wager = declassify(interact.wager);
    const deadline = declassify(interact.deadline);
  });
  Alice.publish(wager, deadline)
    .pay(wager);
  commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="45"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="46"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">wager</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-color-text)">.wager);</span></li><li value="47"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">deadline</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-color-text)">.deadline);</span></li><li value="48"><span style="color: var(--shiki-color-text)">  });</span></li><li value="49"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(wager</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> deadline)</span></li><li value="50"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="51"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<ul>
  <li><i id="p_274" class="pid"></i>Line 49 has Alice publish the wager and deadline.<a href="https://docs.reach.sh/tut/rps/#p_274" class="pid">274</a></li>
  <li><i id="p_275" class="pid"></i>Line 50 has Alice pay the wager.<a href="https://docs.reach.sh/tut/rps/#p_275" class="pid">275</a></li>
</ul>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-7-loops/index.rsh">/examples/rps-7-loops/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  Bob.only(() =&gt; {
    interact.acceptWager(wager);
  });
  Bob.pay(wager)
    .timeout(relativeTime(deadline), () =&gt; closeTo(Alice, informTimeout));" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="53"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="54"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.acceptWager</span><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="55"><span style="color: var(--shiki-color-text)">  });</span></li><li value="56"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager)</span></li><li value="57"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_timeout" title="rsh: timeout"><span style="color: var(--shiki-token-function)">.timeout</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/compute/#rsh_relativeTime" title="rsh: relativeTime"><span style="color: var(--shiki-token-function)">relativeTime</span></a><span style="color: var(--shiki-color-text)">(deadline)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/step/#rsh_closeTo" title="rsh: closeTo"><span style="color: var(--shiki-token-function)">closeTo</span></a><span style="color: var(--shiki-color-text)">(Alice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> informTimeout));</span></li><li value="58"></li></ol></pre>
<ul>
  <li><i id="p_276" class="pid"></i>Line 56 has Bob pay the wager.<a href="https://docs.reach.sh/tut/rps/#p_276" class="pid">276</a></li>
  <li><i id="p_277" class="pid"></i>Line 58 does <strong>not</strong> have this consensus step commit.<a href="https://docs.reach.sh/tut/rps/#p_277" class="pid">277</a></li>
</ul>
<hr>
<p>
  <i id="p_278" class="pid"></i>It's now time to begin the repeatable section of the application, where each party will repeatedly submit hands until the the outcome is not a draw.
  In normal programming languages, such a circumstance would be implemented with a <span class="snip"><span style="color: var(--shiki-token-keyword)">while</span></span> loop, which is exactly what we'll do in Reach.
  However, <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_while" title="rsh: while"><span style="color: var(--shiki-token-keyword)">while</span></a></span> loops in Reach require extra care, as discussed in <a href="https://docs.reach.sh/guide/loop-invs/#guide-loop-invs">the guide on loops in Reach</a>, so we'll take it slow.<a href="https://docs.reach.sh/tut/rps/#p_278" class="pid">278</a>
</p>
<p>
  <i id="p_279" class="pid"></i>In the rest of a Reach program, all identifier bindings are static and unchangeable, but if this were the case throughout all of Reach, then <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_while" title="rsh: while"><span style="color: var(--shiki-token-keyword)">while</span></a></span> loops would either never start or never terminate, because the loop condition would never change.
  So, a <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_while" title="rsh: while"><span style="color: var(--shiki-token-keyword)">while</span></a></span> loop in Reach can introduce a variable binding.<a href="https://docs.reach.sh/tut/rps/#p_279" class="pid">279</a>
</p>
<p><i id="p_280" class="pid"></i>Next, because of Reach's <a href="https://docs.reach.sh/guide/assert/#guide-assert">automatic verification</a> engine, we must be able to make a statement about what properties of the program are invariant before and after a <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_while" title="rsh: while"><span style="color: var(--shiki-token-keyword)">while</span></a></span> loop body's execution, a so-called <a href="https://docs.reach.sh/guide/loop-invs/#guide-loop-invs">"loop invariant"</a>.<a href="https://docs.reach.sh/tut/rps/#p_280" class="pid">280</a></p>
<p>
  <i id="p_281" class="pid"></i>Finally, such loops <em>may only occur</em> inside of consensus steps.
  That's why Bob's transaction was not committed, because we need to remain inside of the consensus to start the <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_while" title="rsh: while"><span style="color: var(--shiki-token-keyword)">while</span></a></span> loop.
  This is because all of the participants must agree on the direction of control flow in the application.<a href="https://docs.reach.sh/tut/rps/#p_281" class="pid">281</a>
</p>
<p><i id="p_282" class="pid"></i>Here's what the structure looks like:<a href="https://docs.reach.sh/tut/rps/#p_282" class="pid">282</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-7-loops/index.rsh">/examples/rps-7-loops/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  var outcome = DRAW;
  invariant( balance() == 2 * wager &amp;&amp; isOutcome(outcome) );
  while ( outcome == DRAW ) {" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="59"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_var" title="rsh: var"><span style="color: var(--shiki-token-keyword)">var</span></a><span style="color: var(--shiki-color-text)"> outcome </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">DRAW</span><span style="color: var(--shiki-color-text)">;</span></li><li value="60"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_invariant" title="rsh: invariant"><span style="color: var(--shiki-token-function)">invariant</span></a><span style="color: var(--shiki-color-text)">( </span><a href="https://docs.reach.sh/rsh/compute/#rsh_balance" title="rsh: balance"><span style="color: var(--shiki-token-function)">balance</span></a><span style="color: var(--shiki-color-text)">() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_*" title="rsh: *"><span style="color: var(--shiki-token-keyword)">*</span></a><span style="color: var(--shiki-color-text)"> wager </span><a href="https://docs.reach.sh/rsh/compute/#rsh_&amp;&amp;" title="rsh: &amp;&amp;"><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">isOutcome</span><span style="color: var(--shiki-color-text)">(outcome) );</span></li><li value="61"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_while" title="rsh: while"><span style="color: var(--shiki-token-keyword)">while</span></a><span style="color: var(--shiki-color-text)"> ( outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">DRAW</span><span style="color: var(--shiki-color-text)"> ) {</span></li></ol></pre>
<ul>
  <li><i id="p_283" class="pid"></i>Line 59 defines the loop variable, <span class="snip"><span style="color: var(--shiki-color-text)">outcome</span></span>.<a href="https://docs.reach.sh/tut/rps/#p_283" class="pid">283</a></li>
  <li><i id="p_284" class="pid"></i>Line 60 states the invariant that the body of the loop does not change the balance in the contract account and that <span class="snip"><span style="color: var(--shiki-color-text)">outcome</span></span> is a valid outcome.<a href="https://docs.reach.sh/tut/rps/#p_284" class="pid">284</a></li>
  <li><i id="p_285" class="pid"></i>Line 61 begins the loop with the condition that it continues as long as the outcome is a draw.<a href="https://docs.reach.sh/tut/rps/#p_285" class="pid">285</a></li>
</ul>
<p><i id="p_286" class="pid"></i>Now, let's look at the body of the loop for the remaining steps, starting with Alice's commitment to her hand.<a href="https://docs.reach.sh/tut/rps/#p_286" class="pid">286</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-7-loops/index.rsh">/examples/rps-7-loops/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="    commit();

    Alice.only(() =&gt; {
      const _handAlice = interact.getHand();
      const [_commitAlice, _saltAlice] = makeCommitment(interact, _handAlice);
      const commitAlice = declassify(_commitAlice);
    });
    Alice.publish(commitAlice)
      .timeout(relativeTime(deadline), () =&gt; closeTo(Bob, informTimeout));
    commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="62"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="63"></li><li value="64"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="65"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">_handAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">();</span></li><li value="66"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-constant)">_commitAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">_saltAlice</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_makeCommitment" title="rsh: makeCommitment"><span style="color: var(--shiki-token-function)">makeCommitment</span></a><span style="color: var(--shiki-color-text)">(interact</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> _handAlice);</span></li><li value="67"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">commitAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(_commitAlice);</span></li><li value="68"><span style="color: var(--shiki-color-text)">    });</span></li><li value="69"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(commitAlice)</span></li><li value="70"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/step/#rsh_timeout" title="rsh: timeout"><span style="color: var(--shiki-token-function)">.timeout</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/compute/#rsh_relativeTime" title="rsh: relativeTime"><span style="color: var(--shiki-token-function)">relativeTime</span></a><span style="color: var(--shiki-color-text)">(deadline)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/step/#rsh_closeTo" title="rsh: closeTo"><span style="color: var(--shiki-token-function)">closeTo</span></a><span style="color: var(--shiki-color-text)">(Bob</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> informTimeout));</span></li><li value="71"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<ul>
  <li><i id="p_287" class="pid"></i>Line 62 commits the last transaction, which at the start of the loop is Bob's acceptance of the wager, and at subsequent runs of the loop is Alice's publication of her hand.<a href="https://docs.reach.sh/tut/rps/#p_287" class="pid">287</a></li>
  <li><i id="p_288" class="pid"></i>Lines 64 through 71 are almost identical to the older version, except the wager is already known and paid.<a href="https://docs.reach.sh/tut/rps/#p_288" class="pid">288</a></li>
</ul>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-7-loops/index.rsh">/examples/rps-7-loops/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="    unknowable(Bob, Alice(_handAlice, _saltAlice));
    Bob.only(() =&gt; {
      const handBob = declassify(interact.getHand());
    });
    Bob.publish(handBob)
      .timeout(relativeTime(deadline), () =&gt; closeTo(Alice, informTimeout));
    commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="73"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_unknowable" title="rsh: unknowable"><span style="color: var(--shiki-token-function)">unknowable</span></a><span style="color: var(--shiki-color-text)">(Bob</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Alice</span><span style="color: var(--shiki-color-text)">(_handAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> _saltAlice));</span></li><li value="74"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="75"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">());</span></li><li value="76"><span style="color: var(--shiki-color-text)">    });</span></li><li value="77"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(handBob)</span></li><li value="78"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/step/#rsh_timeout" title="rsh: timeout"><span style="color: var(--shiki-token-function)">.timeout</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/compute/#rsh_relativeTime" title="rsh: relativeTime"><span style="color: var(--shiki-token-function)">relativeTime</span></a><span style="color: var(--shiki-color-text)">(deadline)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/step/#rsh_closeTo" title="rsh: closeTo"><span style="color: var(--shiki-token-function)">closeTo</span></a><span style="color: var(--shiki-color-text)">(Alice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> informTimeout));</span></li><li value="79"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<p><i id="p_289" class="pid"></i>Similarly, Bob's code is almost identical to the prior version, except that he's already accepted and paid the wager.<a href="https://docs.reach.sh/tut/rps/#p_289" class="pid">289</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-7-loops/index.rsh">/examples/rps-7-loops/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="    Alice.only(() =&gt; {
      const saltAlice = declassify(_saltAlice);
      const handAlice = declassify(_handAlice);
    });
    Alice.publish(saltAlice, handAlice)
      .timeout(relativeTime(deadline), () =&gt; closeTo(Bob, informTimeout));
    checkCommitment(commitAlice, saltAlice, handAlice);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="81"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="82"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">saltAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(_saltAlice);</span></li><li value="83"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(_handAlice);</span></li><li value="84"><span style="color: var(--shiki-color-text)">    });</span></li><li value="85"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(saltAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handAlice)</span></li><li value="86"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/step/#rsh_timeout" title="rsh: timeout"><span style="color: var(--shiki-token-function)">.timeout</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/compute/#rsh_relativeTime" title="rsh: relativeTime"><span style="color: var(--shiki-token-function)">relativeTime</span></a><span style="color: var(--shiki-color-text)">(deadline)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/step/#rsh_closeTo" title="rsh: closeTo"><span style="color: var(--shiki-token-function)">closeTo</span></a><span style="color: var(--shiki-color-text)">(Bob</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> informTimeout));</span></li><li value="87"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_checkCommitment" title="rsh: checkCommitment"><span style="color: var(--shiki-token-function)">checkCommitment</span></a><span style="color: var(--shiki-color-text)">(commitAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> saltAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handAlice);</span></li></ol></pre>
<p><i id="p_290" class="pid"></i>Alice's next step is actually identical, because she is still revealing her hand in exactly the same way.<a href="https://docs.reach.sh/tut/rps/#p_290" class="pid">290</a></p>
<p><i id="p_291" class="pid"></i>Next is the end of the loop.<a href="https://docs.reach.sh/tut/rps/#p_291" class="pid">291</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-7-loops/index.rsh">/examples/rps-7-loops/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="    outcome = winner(handAlice, handBob);
    continue;
  }" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="89"><span style="color: var(--shiki-color-text)">    outcome </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(handAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handBob);</span></li><li value="90"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_continue" title="rsh: continue"><span style="color: var(--shiki-token-keyword)">continue</span></a><span style="color: var(--shiki-color-text)">;</span></li><li value="91"><span style="color: var(--shiki-color-text)">  }</span></li></ol></pre>
<ul>
  <li><i id="p_292" class="pid"></i>Line 89 updates the <span class="snip"><span style="color: var(--shiki-color-text)">outcome</span></span> loop variable with the new value.<a href="https://docs.reach.sh/tut/rps/#p_292" class="pid">292</a></li>
  <li>
    <i id="p_293" class="pid"></i>Line 90 continues the loop.
    Unlike most programming languages, Reach <strong>requires</strong> that <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_continue" title="rsh: continue"><span style="color: var(--shiki-token-keyword)">continue</span></a></span> be explicitly written in the loop body.<a href="https://docs.reach.sh/tut/rps/#p_293" class="pid">293</a>
  </li>
</ul>
<p><i id="p_294" class="pid"></i>The rest of the program could be exactly the same as it was before, except now it occurs outside of the loop, but we will simplify it, because we know that the outcome can never be a draw.<a href="https://docs.reach.sh/tut/rps/#p_294" class="pid">294</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-7-loops/index.rsh">/examples/rps-7-loops/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  assert(outcome == A_WINS || outcome == B_WINS);
  transfer(2 * wager).to(outcome == A_WINS ? Alice : Bob);
  commit();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="93"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">A_WINS</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%7C%7C" title="rsh: ||"><span style="color: var(--shiki-token-keyword)">||</span></a><span style="color: var(--shiki-color-text)"> outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">B_WINS</span><span style="color: var(--shiki-color-text)">);</span></li><li value="94"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer" title="rsh: transfer"><span style="color: var(--shiki-token-function)">transfer</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_*" title="rsh: *"><span style="color: var(--shiki-token-keyword)">*</span></a><span style="color: var(--shiki-color-text)"> wager)</span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer.to" title="rsh: transfer.to"><span style="color: var(--shiki-token-function)">.to</span></a><span style="color: var(--shiki-color-text)">(outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">A_WINS</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_?" title="rsh: ?"><span style="color: var(--shiki-token-keyword)">?</span></a><span style="color: var(--shiki-color-text)"> Alice </span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> Bob);</span></li><li value="95"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<ul>
  <li><i id="p_295" class="pid"></i>Line 93 asserts that the outcome is never draw, which is trivially true because otherwise the <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_while" title="rsh: while"><span style="color: var(--shiki-token-keyword)">while</span></a></span> loop would not have exited.<a href="https://docs.reach.sh/tut/rps/#p_295" class="pid">295</a></li>
  <li><i id="p_296" class="pid"></i>Line 94 transfers the funds to the winner.<a href="https://docs.reach.sh/tut/rps/#p_296" class="pid">296</a></li>
</ul>
<hr>
<p><i id="p_297" class="pid"></i>Let's run the program and see what happens:<a href="https://docs.reach.sh/tut/rps/#p_297" class="pid">297</a></p>
<pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run
Bob accepts the wager of 5.
Alice played Paper
Bob played Rock
Bob saw outcome Alice wins
Alice saw outcome Alice wins
Alice went from 100 to 104.9999.
Bob went from 100 to 94.9999.

$ ./reach run
Bob accepts the wager of 5.
Alice played Rock
Bob played Rock
Alice played Paper
Bob played Scissors
Bob saw outcome Bob wins
Alice saw outcome Bob wins
Alice went from 100 to 94.9999.
Bob went from 100 to 104.9999.

$ ./reach run
Bob accepts the wager of 5.
Alice played Scissors
Bob played Rock
Bob saw outcome Bob wins
Alice saw outcome Bob wins
Alice went from 100 to 94.9999.
Bob went from 100 to 104.9999." href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="2"><span style="color: var(--shiki-color-text)">Bob accepts the wager of </span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">.</span></li><li value="3"><span style="color: var(--shiki-color-text)">Alice played Paper</span></li><li value="4"><span style="color: var(--shiki-color-text)">Bob played Rock</span></li><li value="5"><span style="color: var(--shiki-color-text)">Bob saw outcome Alice wins</span></li><li value="6"><span style="color: var(--shiki-color-text)">Alice saw outcome Alice wins</span></li><li value="7"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">104.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="8"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">94.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="9"></li><li value="10"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="11"><span style="color: var(--shiki-color-text)">Bob accepts the wager of </span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">.</span></li><li value="12"><span style="color: var(--shiki-color-text)">Alice played Rock</span></li><li value="13"><span style="color: var(--shiki-color-text)">Bob played Rock</span></li><li value="14"><span style="color: var(--shiki-color-text)">Alice played Paper</span></li><li value="15"><span style="color: var(--shiki-color-text)">Bob played Scissors</span></li><li value="16"><span style="color: var(--shiki-color-text)">Bob saw outcome Bob wins</span></li><li value="17"><span style="color: var(--shiki-color-text)">Alice saw outcome Bob wins</span></li><li value="18"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">94.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="19"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">104.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="20"></li><li value="21"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="22"><span style="color: var(--shiki-color-text)">Bob accepts the wager of </span><span style="color: var(--shiki-token-constant)">5</span><span style="color: var(--shiki-color-text)">.</span></li><li value="23"><span style="color: var(--shiki-color-text)">Alice played Scissors</span></li><li value="24"><span style="color: var(--shiki-color-text)">Bob played Rock</span></li><li value="25"><span style="color: var(--shiki-color-text)">Bob saw outcome Bob wins</span></li><li value="26"><span style="color: var(--shiki-color-text)">Alice saw outcome Bob wins</span></li><li value="27"><span style="color: var(--shiki-color-text)">Alice went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">94.9999</span><span style="color: var(--shiki-color-text)">.</span></li><li value="28"><span style="color: var(--shiki-color-text)">Bob went from </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">104.9999</span><span style="color: var(--shiki-color-text)">.</span></li></ol></pre>
<p><i id="p_298" class="pid"></i>As usual, your results may differ, but you should be able to see single round victories like this, as well as multi-round fights and timeouts from either party.<a href="https://docs.reach.sh/tut/rps/#p_298" class="pid">298</a></p>
<div class="note">
  <p><i id="p_299" class="pid"></i>If your version isn't working, look at the complete versions of <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-7-loops/index.rsh"><code>rps-7-loops/index.rsh</code></a> and <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-7-loops/index.mjs"><code>rps-7-loops/index.mjs</code></a> to make sure you copied everything down correctly!<a href="https://docs.reach.sh/tut/rps/#p_299" class="pid">299</a></p>
</div>
<p>
  <i id="p_300" class="pid"></i>Now our implementation of <em>Rock, Paper, Scissors!</em> will always result in a pay-out, which is much more fun for everyone.
  In <a href="https://docs.reach.sh/tut/rps/#tut-8">the next step</a>, we'll show how to exit "testing" mode with Reach and turn our JavaScript into an interactive <em>Rock, Paper, Scissors!</em> game with real users.<a href="https://docs.reach.sh/tut/rps/#p_300" class="pid">300</a>
</p>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q9">
  <p><i id="p_301" class="pid"></i>How do you write an application in Reach that runs arbitrarily long, like a game of Rock, Paper, Scissors that is guaranteed to not end in a draw?<a href="https://docs.reach.sh/tut/rps/#p_301" class="pid">301</a></p>
  <ol>
    <li><i id="p_302" class="pid"></i>This is not possible, because all Reach programs are finitely long;<a href="https://docs.reach.sh/tut/rps/#p_302" class="pid">302</a></li>
    <li><i id="p_303" class="pid"></i>You can use a <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_while" title="rsh: while"><span style="color: var(--shiki-token-keyword)">while</span></a></span> loop that runs until the outcome of the game is decided.<a href="https://docs.reach.sh/tut/rps/#p_303" class="pid">303</a></li>
  </ol>
  <div class="collapse" id="q9">
    <p><i id="p_304" class="pid"></i>2; Reach supports <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_while" title="rsh: while"><span style="color: var(--shiki-token-keyword)">while</span></a></span> loops.<a href="https://docs.reach.sh/tut/rps/#p_304" class="pid">304</a></p>
  </div>
</div>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q10">
  <p><i id="p_305" class="pid"></i>When you check if a program with a <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_while" title="rsh: while"><span style="color: var(--shiki-token-keyword)">while</span></a></span> loop is correct, you need to have a property called a loop invariant. Which of the following statements have to be true about the loop invariant?<a href="https://docs.reach.sh/tut/rps/#p_305" class="pid">305</a></p>
  <ol>
    <li>
      <p><i id="p_306" class="pid"></i>The part of the program before the <span class="snip"><a href="https://docs.reach.sh/rsh/consensus/#rsh_while" title="rsh: while"><span style="color: var(--shiki-token-keyword)">while</span></a></span> loop must establish the invariant.<a href="https://docs.reach.sh/tut/rps/#p_306" class="pid">306</a></p>
    </li>
    <li>
      <p><i id="p_307" class="pid"></i>The condition and the body of the loop must establish the invariant.<a href="https://docs.reach.sh/tut/rps/#p_307" class="pid">307</a></p>
    </li>
    <li>
      <p><i id="p_308" class="pid"></i>The negation of the condition and the invariant must establish any properties of the rest of the program.<a href="https://docs.reach.sh/tut/rps/#p_308" class="pid">308</a></p>
    </li>
  </ol>
  <div class="collapse" id="q10">
    <p><i id="p_309" class="pid"></i>All of the above.<a href="https://docs.reach.sh/tut/rps/#p_309" class="pid">309</a></p>
  </div>
</div>
<h2 id="tut-8" class="refHeader">Interaction and Independence<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-8"><span class="icon icon-link"></span></a></h2>
<p>
  <i id="p_310" class="pid"></i>In the last section, we made our <em>Rock, Paper, Scissors!</em> run until there was a definitive winner.
  In this section, we won't be making any changes to the Reach program itself.
  Instead, we'll introduce customizations to the JavaScript frontend which facilitate interactivity and provide the option to connect to a real consensus network.<a href="https://docs.reach.sh/tut/rps/#p_310" class="pid">310</a>
</p>
<hr>
<p>
  <i id="p_311" class="pid"></i>We'll start from scratch and show every line of the program again.
  You'll see a lot of similarity between this and the last version, but for completeness, we'll show every line.<a href="https://docs.reach.sh/tut/rps/#p_311" class="pid">311</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.mjs">/examples/rps-8-interact/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="import { loadStdlib, ask } from &#39;@reach-sh/stdlib&#39;;
import * as backend from &#39;./build/index.main.mjs&#39;;
const stdlib = loadStdlib();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> { loadStdlib</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ask } </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'@reach-sh/stdlib'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="2"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">*</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">as</span><span style="color: var(--shiki-color-text)"> backend </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./build/index.main.mjs'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="3"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_loadStdlib" title="js: loadStdlib"><span style="color: var(--shiki-token-function)">loadStdlib</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="4"></li></ol></pre>
<ul>
  <li>
    <i id="p_312" class="pid"></i>Line 1 has been updated to import the <code>ask</code> object of <code>@reach-sh/stdlib</code>, the Reach standard library.
    We'll see how <code>ask</code> is used below.<a href="https://docs.reach.sh/tut/rps/#p_312" class="pid">312</a>
  </li>
  <li><i id="p_313" class="pid"></i>Lines 2, and 3 are the same as before: importing the standard library and the backend.<a href="https://docs.reach.sh/tut/rps/#p_313" class="pid">313</a></li>
</ul>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.mjs">/examples/rps-8-interact/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="const isAlice = await ask.ask(
  `Are you Alice?`,
  ask.yesno
);
const who = isAlice ? &#39;Alice&#39; : &#39;Bob&#39;;" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="5"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">isAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask" title="js: ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span></li><li value="6"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">`Are you Alice?`</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="7"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.yesno" title="js: ask.yesno"><span style="color: var(--shiki-color-text)">.yesno</span></a></li><li value="8"><span style="color: var(--shiki-color-text)">);</span></li><li value="9"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">who</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> isAlice </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Bob'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="10"></li></ol></pre>
<ul>
  <li>
    <i id="p_314" class="pid"></i>Lines 5 through 8 ask the question whether they are playing as Alice and expect a "Yes" or "No" answer.
    <span class="snip"><a href="https://docs.reach.sh/frontend/#js_ask" title="js: ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-color-text)">.ask</span></a></span> presents a prompt and collects a line of input until its argument does not error.
    <span class="snip"><a href="https://docs.reach.sh/frontend/#js_ask" title="js: ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.yesno" title="js: ask.yesno"><span style="color: var(--shiki-color-text)">.yesno</span></a></span> errors if it is not given "y" or "n".<a href="https://docs.reach.sh/tut/rps/#p_314" class="pid">314</a>
  </li>
</ul>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.mjs">/examples/rps-8-interact/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="console.log(`Starting Rock, Paper, Scissors! as ${who}`);

let acc = null;
const createAcc = await ask.ask(
  `Would you like to create an account? (only possible on devnet)`,
  ask.yesno
);
if (createAcc) {
  acc = await stdlib.newTestAccount(stdlib.parseCurrency(1000));
} else {
  const secret = await ask.ask(
    `What is your account secret?`,
    (x =&gt; x)
  );
  acc = await stdlib.newAccountFromSecret(secret);
}" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="11"><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Starting Rock, Paper, Scissors! as </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="12"></li><li value="13"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let" title="js: let"><span style="color: var(--shiki-token-keyword)">let</span></a><span style="color: var(--shiki-color-text)"> acc </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">null</span><span style="color: var(--shiki-color-text)">;</span></li><li value="14"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">createAcc</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask" title="js: ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span></li><li value="15"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">`Would you like to create an account? (only possible on devnet)`</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="16"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.yesno" title="js: ask.yesno"><span style="color: var(--shiki-color-text)">.yesno</span></a></li><li value="17"><span style="color: var(--shiki-color-text)">);</span></li><li value="18"><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (createAcc) {</span></li><li value="19"><span style="color: var(--shiki-color-text)">  acc </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.newTestAccount" title="js: stdlib.newTestAccount"><span style="color: var(--shiki-token-function)">.newTestAccount</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-token-function)">.parseCurrency</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">1000</span><span style="color: var(--shiki-color-text)">));</span></li><li value="20"><span style="color: var(--shiki-color-text)">} </span><span style="color: var(--shiki-token-keyword)">else</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="21"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">secret</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span></li><li value="22"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-string-expression)">`What is your account secret?`</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="23"><span style="color: var(--shiki-color-text)">    (x </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> x)</span></li><li value="24"><span style="color: var(--shiki-color-text)">  );</span></li><li value="25"><span style="color: var(--shiki-color-text)">  acc </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_newAccountFromSecret" title="js: newAccountFromSecret"><span style="color: var(--shiki-token-function)">.newAccountFromSecret</span></a><span style="color: var(--shiki-color-text)">(secret);</span></li><li value="26"><span style="color: var(--shiki-color-text)">}</span></li><li value="27"></li></ol></pre>
<ul>
  <li><i id="p_315" class="pid"></i>Lines 14 through 17 present the user with the choice of creating a test account if they can or inputting a secret to load an existing account.<a href="https://docs.reach.sh/tut/rps/#p_315" class="pid">315</a></li>
  <li><i id="p_316" class="pid"></i>Line 19 creates the test account as before.<a href="https://docs.reach.sh/tut/rps/#p_316" class="pid">316</a></li>
  <li><i id="p_317" class="pid"></i>Line 25 loads the existing account.<a href="https://docs.reach.sh/tut/rps/#p_317" class="pid">317</a></li>
</ul>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.mjs">/examples/rps-8-interact/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="let ctc = null;
if (isAlice) {
  ctc = acc.contract(backend);
  ctc.getInfo().then((info) =&gt; {
    console.log(`The contract is deployed as = ${JSON.stringify(info)}`); });
} else {
  const info = await ask.ask(
    `Please paste the contract information:`,
    JSON.parse
  );
  ctc = acc.contract(backend, info);
}" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="28"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let" title="js: let"><span style="color: var(--shiki-token-keyword)">let</span></a><span style="color: var(--shiki-color-text)"> ctc </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">null</span><span style="color: var(--shiki-color-text)">;</span></li><li value="29"><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (isAlice) {</span></li><li value="30"><span style="color: var(--shiki-color-text)">  ctc </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-token-constant)">acc</span></a><a href="https://docs.reach.sh/frontend/#js_contract" title="js: contract"><span style="color: var(--shiki-token-function)">.contract</span></a><span style="color: var(--shiki-color-text)">(backend);</span></li><li value="31"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><a href="https://docs.reach.sh/frontend/#js_getInfo" title="js: getInfo"><span style="color: var(--shiki-token-function)">.getInfo</span></a><span style="color: var(--shiki-color-text)">()</span><span style="color: var(--shiki-token-function)">.then</span><span style="color: var(--shiki-color-text)">((info) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="32"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`The contract is deployed as = </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">JSON</span><span style="color: var(--shiki-token-function)">.stringify</span><span style="color: var(--shiki-color-text)">(info)</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">); });</span></li><li value="33"><span style="color: var(--shiki-color-text)">} </span><span style="color: var(--shiki-token-keyword)">else</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="34"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">info</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask" title="js: ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span></li><li value="35"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-string-expression)">`Please paste the contract information:`</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="36"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">JSON</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">parse</span></li><li value="37"><span style="color: var(--shiki-color-text)">  );</span></li><li value="38"><span style="color: var(--shiki-color-text)">  ctc </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-token-constant)">acc</span></a><a href="https://docs.reach.sh/frontend/#js_contract" title="js: contract"><span style="color: var(--shiki-token-function)">.contract</span></a><span style="color: var(--shiki-color-text)">(backend</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> info);</span></li><li value="39"><span style="color: var(--shiki-color-text)">}</span></li></ol></pre>
<ul>
  <li><i id="p_318" class="pid"></i>Line 29 branches based on whether the player is running as Alice, who must deploy the contract, or Bob, who must attach to it.<a href="https://docs.reach.sh/tut/rps/#p_318" class="pid">318</a></li>
  <li><i id="p_319" class="pid"></i>Lines 30 through 32 deploy it and print out public information (<span class="snip"><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><a href="https://docs.reach.sh/frontend/#js_getInfo" title="js: getInfo"><span style="color: var(--shiki-color-text)">.getInfo</span></a></span>) that can be given to the other player when it becomes available.<a href="https://docs.reach.sh/tut/rps/#p_319" class="pid">319</a></li>
  <li><i id="p_320" class="pid"></i>Lines 34 through 39 request, parse, and process this information.<a href="https://docs.reach.sh/tut/rps/#p_320" class="pid">320</a></li>
</ul>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.mjs">/examples/rps-8-interact/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="const fmt = (x) =&gt; stdlib.formatCurrency(x, 4);
const getBalance = async () =&gt; fmt(await stdlib.balanceOf(acc));

const before = await getBalance();
console.log(`Your balance is ${before}`);

const interact = { ...stdlib.hasRandom };" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="41"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">fmt</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (x) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_formatCurrency" title="js: formatCurrency"><span style="color: var(--shiki-token-function)">.formatCurrency</span></a><span style="color: var(--shiki-color-text)">(x</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)">);</span></li><li value="42"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getBalance</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">fmt</span><span style="color: var(--shiki-color-text)">(</span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.balanceOf" title="js: stdlib.balanceOf"><span style="color: var(--shiki-token-function)">.balanceOf</span></a><span style="color: var(--shiki-color-text)">(acc));</span></li><li value="43"></li><li value="44"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">before</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getBalance</span><span style="color: var(--shiki-color-text)">();</span></li><li value="45"><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Your balance is </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">before</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="46"></li><li value="47"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> { </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-constant)">stdlib</span><span style="color: var(--shiki-color-text)">.hasRandom };</span></li></ol></pre>
<p><i id="p_321" class="pid"></i>Next we define a few helper functions and start the participant interaction interface.<a href="https://docs.reach.sh/tut/rps/#p_321" class="pid">321</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.mjs">/examples/rps-8-interact/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="interact.informTimeout = () =&gt; {
  console.log(`There was a timeout.`);
  process.exit(1);
};" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="49"><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">informTimeout</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="50"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`There was a timeout.`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="51"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">process</span><span style="color: var(--shiki-token-function)">.exit</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">);</span></li><li value="52"><span style="color: var(--shiki-color-text)">};</span></li></ol></pre>
<p><i id="p_322" class="pid"></i>Then we define a timeout handler.<a href="https://docs.reach.sh/tut/rps/#p_322" class="pid">322</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.mjs">/examples/rps-8-interact/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="if (isAlice) {
  const amt = await ask.ask(
    `How much do you want to wager?`,
    stdlib.parseCurrency
  );
  interact.wager = amt;
  interact.deadline = { ETH: 100, ALGO: 100, CFX: 1000 }[stdlib.connector];
} else {
  interact.acceptWager = async (amt) =&gt; {
    const accepted = await ask.ask(
      `Do you accept the wager of ${fmt(amt)}?`,
      ask.yesno
    );
    if (!accepted) {
      process.exit(0);
    }
  };
}" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="54"><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (isAlice) {</span></li><li value="55"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">amt</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask" title="js: ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span></li><li value="56"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-string-expression)">`How much do you want to wager?`</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="57"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-color-text)">.parseCurrency</span></a></li><li value="58"><span style="color: var(--shiki-color-text)">  );</span></li><li value="59"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)">.wager </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> amt;</span></li><li value="60"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)">.deadline </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> { ETH</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ALGO</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> CFX</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1000</span><span style="color: var(--shiki-color-text)"> }[</span><span style="color: var(--shiki-token-constant)">stdlib</span><span style="color: var(--shiki-color-text)">.connector];</span></li><li value="61"><span style="color: var(--shiki-color-text)">} </span><span style="color: var(--shiki-token-keyword)">else</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="62"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">acceptWager</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> (amt) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="63"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">accepted</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span></li><li value="64"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-string-expression)">`Do you accept the wager of </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-function)">fmt</span><span style="color: var(--shiki-color-text)">(amt)</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">?`</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="65"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.yesno" title="js: ask.yesno"><span style="color: var(--shiki-color-text)">.yesno</span></a></li><li value="66"><span style="color: var(--shiki-color-text)">    );</span></li><li value="67"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">!</span><span style="color: var(--shiki-color-text)">accepted) {</span></li><li value="68"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">process</span><span style="color: var(--shiki-token-function)">.exit</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">);</span></li><li value="69"><span style="color: var(--shiki-color-text)">    }</span></li><li value="70"><span style="color: var(--shiki-color-text)">  };</span></li><li value="71"><span style="color: var(--shiki-color-text)">}</span></li></ol></pre>
<p><i id="p_323" class="pid"></i>Next, we request the wager amount or define the <span class="snip"><span style="color: var(--shiki-color-text)">acceptWager</span></span> method, depending on if we are Alice or not.<a href="https://docs.reach.sh/tut/rps/#p_323" class="pid">323</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.mjs">/examples/rps-8-interact/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="const HAND = [&#39;Rock&#39;, &#39;Paper&#39;, &#39;Scissors&#39;];
const HANDS = {
  &#39;Rock&#39;: 0, &#39;R&#39;: 0, &#39;r&#39;: 0,
  &#39;Paper&#39;: 1, &#39;P&#39;: 1, &#39;p&#39;: 1,
  &#39;Scissors&#39;: 2, &#39;S&#39;: 2, &#39;s&#39;: 2,
};

interact.getHand = async () =&gt; {
  const hand = await ask.ask(`What hand will you play?`, (x) =&gt; {
    const hand = HANDS[x];
    if ( hand === undefined ) {
      throw Error(`Not a valid hand ${hand}`);
    }
    return hand;
  });
  console.log(`You played ${HAND[hand]}`);
  return hand;
};" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="73"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">HAND</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-string-expression)">'Rock'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Paper'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Scissors'</span><span style="color: var(--shiki-color-text)">];</span></li><li value="74"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">HANDS</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="75"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">'Rock'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'R'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'r'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="76"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">'Paper'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'P'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'p'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="77"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">'Scissors'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'S'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'s'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="78"><span style="color: var(--shiki-color-text)">};</span></li><li value="79"></li><li value="80"><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">getHand</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="81"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">hand</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask" title="js: ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`What hand will you play?`</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> (x) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="82"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">hand</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">HANDS</span><span style="color: var(--shiki-color-text)">[x];</span></li><li value="83"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> ( hand </span><span style="color: var(--shiki-token-keyword)">===</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">undefined</span><span style="color: var(--shiki-color-text)"> ) {</span></li><li value="84"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-keyword)">throw</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Error</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Not a valid hand </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">hand</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="85"><span style="color: var(--shiki-color-text)">    }</span></li><li value="86"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> hand;</span></li><li value="87"><span style="color: var(--shiki-color-text)">  });</span></li><li value="88"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`You played </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">HAND</span><span style="color: var(--shiki-color-text)">[hand]</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="89"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> hand;</span></li><li value="90"><span style="color: var(--shiki-color-text)">};</span></li></ol></pre>
<p><i id="p_324" class="pid"></i>Next, we define the shared <span class="snip"><span style="color: var(--shiki-color-text)">getHand</span></span> method.<a href="https://docs.reach.sh/tut/rps/#p_324" class="pid">324</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.mjs">/examples/rps-8-interact/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="const OUTCOME = [&#39;Bob wins&#39;, &#39;Draw&#39;, &#39;Alice wins&#39;];
interact.seeOutcome = async (outcome) =&gt; {
  console.log(`The outcome is: ${OUTCOME[outcome]}`);
};" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="92"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">OUTCOME</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-string-expression)">'Bob wins'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Draw'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Alice wins'</span><span style="color: var(--shiki-color-text)">];</span></li><li value="93"><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">seeOutcome</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> (outcome) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="94"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`The outcome is: </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">OUTCOME</span><span style="color: var(--shiki-color-text)">[outcome]</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="95"><span style="color: var(--shiki-color-text)">};</span></li></ol></pre>
<p><i id="p_325" class="pid"></i>Finally, the <span class="snip"><span style="color: var(--shiki-color-text)">seeOutcome</span></span> method.<a href="https://docs.reach.sh/tut/rps/#p_325" class="pid">325</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.mjs">/examples/rps-8-interact/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="const part = isAlice ? ctc.p.Alice : ctc.p.Bob;
await part(interact);

const after = await getBalance();
console.log(`Your balance is now ${after}`);

ask.done();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="97"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">part</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> isAlice </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><span style="color: var(--shiki-color-text)">.</span><a href="https://docs.reach.sh/frontend/#js_ctc.p" title="js: ctc.p"><span style="color: var(--shiki-token-constant)">p</span></a><span style="color: var(--shiki-color-text)">.Alice </span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><span style="color: var(--shiki-color-text)">.</span><a href="https://docs.reach.sh/frontend/#js_ctc.p" title="js: ctc.p"><span style="color: var(--shiki-token-constant)">p</span></a><span style="color: var(--shiki-color-text)">.Bob;</span></li><li value="98"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">part</span><span style="color: var(--shiki-color-text)">(interact);</span></li><li value="99"></li><li value="100"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">after</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getBalance</span><span style="color: var(--shiki-color-text)">();</span></li><li value="101"><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Your balance is now </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">after</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="102"></li><li value="103"><a href="https://docs.reach.sh/frontend/#js_ask" title="js: ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.done" title="js: ask.done"><span style="color: var(--shiki-token-function)">.done</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<p><i id="p_326" class="pid"></i>Lastly, we choose the appropriate backend function and await its completion.<a href="https://docs.reach.sh/tut/rps/#p_326" class="pid">326</a></p>
<hr>
<p><i id="p_327" class="pid"></i>We can now run<a href="https://docs.reach.sh/tut/rps/#p_327" class="pid">327</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li></ol></pre>
<p><i id="p_328" class="pid"></i>in one terminal in this directory to play as Alice and<a href="https://docs.reach.sh/tut/rps/#p_328" class="pid">328</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li></ol></pre>
<p><i id="p_329" class="pid"></i>in another terminal in this directory to play as Bob.<a href="https://docs.reach.sh/tut/rps/#p_329" class="pid">329</a></p>
<p><i id="p_330" class="pid"></i>Here's an example run:<a href="https://docs.reach.sh/tut/rps/#p_330" class="pid">330</a></p>
<pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run
Are you Alice?
y
Starting Rock, Paper, Scissors as Alice
Would you like to create an account? (only possible on devnet)
y
Your balance is 999.9999
How much do you want to wager?
10
The contract is deployed as = &quot;0x132b724e55AEb074C15A5CBb7b8EeE0dBEd45F7b&quot;
What hand will you play?
r
You played Rock
The outcome is: Bob wins
Your balance is now 989.9999" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="2"><span style="color: var(--shiki-color-text)">Are you Alice?</span></li><li value="3"><span style="color: var(--shiki-color-text)">y</span></li><li value="4"><span style="color: var(--shiki-color-text)">Starting Rock, Paper, Scissors </span><span style="color: var(--shiki-token-keyword)">as</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Alice</span></li><li value="5"><span style="color: var(--shiki-color-text)">Would you like </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> create an account? (only possible on devnet)</span></li><li value="6"><span style="color: var(--shiki-color-text)">y</span></li><li value="7"><span style="color: var(--shiki-color-text)">Your balance is </span><span style="color: var(--shiki-token-constant)">999.9999</span></li><li value="8"><span style="color: var(--shiki-color-text)">How much </span><span style="color: var(--shiki-token-keyword)">do</span><span style="color: var(--shiki-color-text)"> you want </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> wager?</span></li><li value="9"><span style="color: var(--shiki-token-constant)">10</span></li><li value="10"><span style="color: var(--shiki-color-text)">The contract is deployed </span><span style="color: var(--shiki-token-keyword)">as</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">"0x132b724e55AEb074C15A5CBb7b8EeE0dBEd45F7b"</span></li><li value="11"><span style="color: var(--shiki-color-text)">What hand will you play?</span></li><li value="12"><span style="color: var(--shiki-color-text)">r</span></li><li value="13"><span style="color: var(--shiki-color-text)">You played Rock</span></li><li value="14"><span style="color: var(--shiki-color-text)">The outcome is: Bob wins</span></li><li value="15"><span style="color: var(--shiki-color-text)">Your balance is </span><span style="color: var(--shiki-token-function)">now</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">989.9999</span></li></ol></pre>
<p><i id="p_331" class="pid"></i>and<a href="https://docs.reach.sh/tut/rps/#p_331" class="pid">331</a></p>
<pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach run
Are you Alice?
n
Starting Rock, Paper, Scissors as Bob
Would you like to create an account? (only possible on devnet)
y
Please paste the contract information:
&quot;0x132b724e55AEb074C15A5CBb7b8EeE0dBEd45F7b&quot;
Your balance is 1000
Do you accept the wager of 10?
y
What hand will you play?
p
You played Paper
The outcome is: Bob wins
Your balance is now 1009.9999" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li><li value="2"><span style="color: var(--shiki-color-text)">Are you Alice?</span></li><li value="3"><span style="color: var(--shiki-color-text)">n</span></li><li value="4"><span style="color: var(--shiki-color-text)">Starting Rock, Paper, Scissors </span><span style="color: var(--shiki-token-keyword)">as</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Bob</span></li><li value="5"><span style="color: var(--shiki-color-text)">Would you like </span><span style="color: var(--shiki-token-keyword)">to</span><span style="color: var(--shiki-color-text)"> create an account? (only possible on devnet)</span></li><li value="6"><span style="color: var(--shiki-color-text)">y</span></li><li value="7"><span style="color: var(--shiki-color-text)">Please paste the contract information:</span></li><li value="8"><span style="color: var(--shiki-token-string-expression)">"0x132b724e55AEb074C15A5CBb7b8EeE0dBEd45F7b"</span></li><li value="9"><span style="color: var(--shiki-color-text)">Your balance is </span><span style="color: var(--shiki-token-constant)">1000</span></li><li value="10"><span style="color: var(--shiki-token-keyword)">Do</span><span style="color: var(--shiki-color-text)"> you accept the wager of </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-color-text)">?</span></li><li value="11"><span style="color: var(--shiki-color-text)">y</span></li><li value="12"><span style="color: var(--shiki-color-text)">What hand will you play?</span></li><li value="13"><span style="color: var(--shiki-color-text)">p</span></li><li value="14"><span style="color: var(--shiki-color-text)">You played Paper</span></li><li value="15"><span style="color: var(--shiki-color-text)">The outcome is: Bob wins</span></li><li value="16"><span style="color: var(--shiki-color-text)">Your balance is </span><span style="color: var(--shiki-token-function)">now</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1009.9999</span></li></ol></pre>
<p><i id="p_332" class="pid"></i>Of course, when you run the exact amounts and addresses may be different.<a href="https://docs.reach.sh/tut/rps/#p_332" class="pid">332</a></p>
<div class="note">
  <p><i id="p_333" class="pid"></i>If your version isn't working, compare with <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.rsh"><code>rps-8-interact/index.rsh</code></a> and <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.mjs"><code>rps-8-interact/index.mjs</code></a> to ensure you've copied everything down correctly!<a href="https://docs.reach.sh/tut/rps/#p_333" class="pid">333</a></p>
</div>
<p><i id="p_334" class="pid"></i>If we were to instead run<a href="https://docs.reach.sh/tut/rps/#p_334" class="pid">334</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="REACH_CONNECTOR_MODE=ALGO-devnet ./reach run" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> REACH_CONNECTOR_MODE</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)">ALGO</span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">devnet ./reach run</span></li></ol></pre>
<p><i id="p_335" class="pid"></i>in two terminals we'd see equivalent output from running our application on a private Algorand devnet.<a href="https://docs.reach.sh/tut/rps/#p_335" class="pid">335</a></p>
<p><i id="p_336" class="pid"></i>Connecting to live consensus networks is similarly easy:<a href="https://docs.reach.sh/tut/rps/#p_336" class="pid">336</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="REACH_CONNECTOR_MODE=ETH-live ETH_NODE_URI=&quot;http://some.node.fqdn:8545&quot; ./reach run" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> REACH_CONNECTOR_MODE</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)">ETH</span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">live ETH_NODE_URI</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-token-string-expression)">"http://some.node.fqdn:8545"</span><span style="color: var(--shiki-color-text)"> ./reach run</span></li></ol></pre>
<hr>
<p>
  <i id="p_337" class="pid"></i>Now our implementation of <em>Rock, Paper, Scissors!</em> is finished!
  We are protected against attacks, timeouts, and draws, and we can run interactively on non-test networks.<a href="https://docs.reach.sh/tut/rps/#p_337" class="pid">337</a>
</p>
<p>
  <i id="p_338" class="pid"></i>In this step, we made a command-line interface for our Reach program.
  In <a href="https://docs.reach.sh/tut/rps/#tut-9">the next step</a>, we'll replace this with a Web interface for the same Reach program.<a href="https://docs.reach.sh/tut/rps/#p_338" class="pid">338</a>
</p>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q11">
  <p><i id="p_339" class="pid"></i>Reach helps you build automated tests for your decentralized application, but it doesn’t support building interactive user-interfaces.<a href="https://docs.reach.sh/tut/rps/#p_339" class="pid">339</a></p>
  <div class="collapse" id="q11">
    <p><i id="p_340" class="pid"></i>False; Reach does not impose any constraints on what kind of frontend is attached to your Reach application.<a href="https://docs.reach.sh/tut/rps/#p_340" class="pid">340</a></p>
  </div>
</div>
<h2 id="tut-9" class="refHeader">Web Interaction<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9"><span class="icon icon-link"></span></a></h2>
<p>
  <i id="p_341" class="pid"></i>In the last section, we made <em>Rock, Paper, Scissors!</em> run as a command-line application, without any changes to the Reach program.
  In this section, we again won't be making any changes to the Reach program.
  Instead, we'll replace the command-line interface with a Web interface.<a href="https://docs.reach.sh/tut/rps/#p_341" class="pid">341</a>
</p>
<p><i id="p_342" class="pid"></i>We will use <a href="https://reactjs.org/">React.js</a> for this tutorial, but the same principles apply to any Web framework.<a href="https://docs.reach.sh/tut/rps/#p_342" class="pid">342</a></p>
<div class="note">
  <p><i id="p_343" class="pid"></i>If you've never used React before, here are some basics about how it works:<a href="https://docs.reach.sh/tut/rps/#p_343" class="pid">343</a></p>
  <ul>
    <li><i id="p_344" class="pid"></i>React programs are JavaScript programs that use a special library that allows you to mix HTML inside of the body of your JavaScript.<a href="https://docs.reach.sh/tut/rps/#p_344" class="pid">344</a></li>
    <li>
      <i id="p_345" class="pid"></i>React has a special compiler that combines a bundle of JavaScript programs, and all their dependencies, into one large file that can be deployed on a static Web server.
      This is called "packing".<a href="https://docs.reach.sh/tut/rps/#p_345" class="pid">345</a>
    </li>
    <li><i id="p_346" class="pid"></i>When you're developing and testing with React, you run a special development Web server that watches and updates this packed file every time you modify a source file, so you don't have to constantly run the compiler.<a href="https://docs.reach.sh/tut/rps/#p_346" class="pid">346</a></li>
    <li><i id="p_347" class="pid"></i>Reach automates the process of starting this development server for you when you run <code>./reach react</code> and gives you access to it at <code>http://localhost:3000/</code>.<a href="https://docs.reach.sh/tut/rps/#p_347" class="pid">347</a></li>
  </ul>
</div>
<p>
  <i id="p_348" class="pid"></i>Similarly, in this tutorial, we assume that we will be deploying (and testing) with Ethereum.
  Reach Web applications rely on the Web browser to provide access to a consensus network account and its associated wallet.
  On Ethereum, the standard wallet is <a href="https://metamask.io/">MetaMask</a>.
  If you want to test this code, you'll need to install it and set it up.
  Furthermore, MetaMask does not support multiple active accounts, so if you want to test <em>Rock, Paper, Scissors!</em> locally, you'll need to have two separate browser instances: one to act as Alice and another to act as Bob.<a href="https://docs.reach.sh/tut/rps/#p_348" class="pid">348</a>
</p>
<p><i id="p_349" class="pid"></i>To complete this section we'll use the <code>index.rsh</code> you've already written and create an <code>index.js</code> file from scratch which replaces <code>index.mjs</code>.<a href="https://docs.reach.sh/tut/rps/#p_349" class="pid">349</a></p>
<div class="note">
  <p>
    <i id="p_350" class="pid"></i>If you do not replace <code>index.mjs</code>, then you will get an error when you run <code>reach react</code>.
    You can avoid this error by renaming the file to <code>index.mjs.bak</code>, or by creating a totally new directory with a copy of the old <code>index.rsh.</code>
    We do the second option.<a href="https://docs.reach.sh/tut/rps/#p_350" class="pid">350</a>
  </p>
</div>
<p>
  <i id="p_351" class="pid"></i>This code is also supplemented with <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.css">index.css</a>
  and some <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views">views</a>.
  These details are not specific to Reach, and are fairly trivial,
  so we will not explain the specifics of those files.
  If you run this locally, you'll want to download those files.
  Your directory should look like:<a href="https://docs.reach.sh/tut/rps/#p_351" class="pid">351</a>
</p>
<pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text=".
├── index.css
├── index.js
├── index.rsh
└── views
    ├── AppViews.js
    ├── AttacherViews.js
    ├── DeployerViews.js
    ├── PlayerViews.js
    └── render.js" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1">.</li><li value="2">├── index.css</li><li value="3">├── index.js</li><li value="4">├── index.rsh</li><li value="5">└── views</li><li value="6">    ├── AppViews.js</li><li value="7">    ├── AttacherViews.js</li><li value="8">    ├── DeployerViews.js</li><li value="9">    ├── PlayerViews.js</li><li value="10">    └── render.js</li></ol></pre>
<hr>
<p>
  <i id="p_352" class="pid"></i>We will focus on <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.js"><code>rps-9-web/index.js</code></a>,
  because <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.rsh"><code>rps-9-web/index.rsh</code></a> is the same as previous sections.<a href="https://docs.reach.sh/tut/rps/#p_352" class="pid">352</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.js">/examples/rps-9-web/index.js</a><a class="far fa-copy copyBtn" data-clipboard-text="import React from &#39;react&#39;;
import AppViews from &#39;./views/AppViews&#39;;
import DeployerViews from &#39;./views/DeployerViews&#39;;
import AttacherViews from &#39;./views/AttacherViews&#39;;
import {renderDOM, renderView} from &#39;./views/render&#39;;
import &#39;./index.css&#39;;
import * as backend from &#39;./build/index.main.mjs&#39;;
import { loadStdlib } from &#39;@reach-sh/stdlib&#39;;
const reach = loadStdlib(process.env);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> React </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'react'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="2"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> AppViews </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./views/AppViews'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="3"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> DeployerViews </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./views/DeployerViews'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="4"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> AttacherViews </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./views/AttacherViews'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="5"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> {renderDOM</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> renderView} </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./views/render'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="6"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./index.css'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="7"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">*</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">as</span><span style="color: var(--shiki-color-text)"> backend </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./build/index.main.mjs'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="8"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> { loadStdlib } </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'@reach-sh/stdlib'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="9"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_loadStdlib" title="js: loadStdlib"><span style="color: var(--shiki-token-function)">loadStdlib</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">process</span><span style="color: var(--shiki-color-text)">.env);</span></li></ol></pre>
<p>
  <i id="p_353" class="pid"></i>On lines 1 thru 6, we import our view code and CSS.
  On line 7, we import the compiled <span class="snip"><span style="color: var(--shiki-color-text)">backend</span></span>.
  On lines 8 and 9, we load the <span class="snip"><span style="color: var(--shiki-color-text)">stdlib</span></span> as <span class="snip"><span style="color: var(--shiki-color-text)">reach</span></span>.<a href="https://docs.reach.sh/tut/rps/#p_353" class="pid">353</a>
</p>
<p>
  <i id="p_354" class="pid"></i>React compiles the Reach standard library in such a way that
  it does not have direct access to the environment variables
  which are used to select the desired standard library.
  This is why you need to pass <span class="snip"><span style="color: var(--shiki-token-constant)">process</span><span style="color: var(--shiki-color-text)">.env</span></span> as an argument
  to achieve the desired effect.<a href="https://docs.reach.sh/tut/rps/#p_354" class="pid">354</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.js">/examples/rps-9-web/index.js</a><a class="far fa-copy copyBtn" data-clipboard-text="
const handToInt = {&#39;ROCK&#39;: 0, &#39;PAPER&#39;: 1, &#39;SCISSORS&#39;: 2};
const intToOutcome = [&#39;Bob wins!&#39;, &#39;Draw!&#39;, &#39;Alice wins!&#39;];
const {standardUnit} = reach;
const defaults = {defaultFundAmt: &#39;10&#39;, defaultWager: &#39;3&#39;, standardUnit};" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="10"></li><li value="11"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handToInt</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {</span><span style="color: var(--shiki-token-string-expression)">'ROCK'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'PAPER'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'SCISSORS'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">};</span></li><li value="12"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">intToOutcome</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-string-expression)">'Bob wins!'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Draw!'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Alice wins!'</span><span style="color: var(--shiki-color-text)">];</span></li><li value="13"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> {</span><a href="https://docs.reach.sh/frontend/#js_standardUnit" title="js: standardUnit"><span style="color: var(--shiki-token-constant)">standardUnit</span></a><span style="color: var(--shiki-color-text)">} </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> reach;</span></li><li value="14"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">defaults</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {defaultFundAmt</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'10'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> defaultWager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'3'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> standardUnit};</span></li></ol></pre>
<p>
  <i id="p_355" class="pid"></i>On these lines we define a few helpful constants and defaults for later,
  some corresponding to the enumerations we defined in Reach.<a href="https://docs.reach.sh/tut/rps/#p_355" class="pid">355</a>
</p>
<h3 id="tut-9-App" class="refHeader">Application component<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-App"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_356" class="pid"></i>We start defining the main application view, <span class="snip"><span style="color: var(--shiki-color-text)">App</span></span>, as a React component,
  and tell it what to do once it mounts, which is the React term for starting.<a href="https://docs.reach.sh/tut/rps/#p_356" class="pid">356</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.js">/examples/rps-9-web/index.js</a><a class="far fa-copy copyBtn" data-clipboard-text="
class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {view: &#39;ConnectAccount&#39;, ...defaults};
  }
  async componentDidMount() {
    const acc = await reach.getDefaultAccount();
    const balAtomic = await reach.balanceOf(acc);
    const bal = reach.formatCurrency(balAtomic, 4);
    this.setState({acc, bal});
    if (await reach.canFundFromFaucet()) {
      this.setState({view: &#39;FundAccount&#39;});
    } else {
      this.setState({view: &#39;DeployerOrAttacher&#39;});
    }
  }" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="15"></li><li value="16"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">App</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">React</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">Component</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="17"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/tut/rps/undefined" title="undefined"><span style="color: var(--shiki-token-keyword)">constructor</span></a><span style="color: var(--shiki-color-text)">(props) {</span></li><li value="18"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">super</span><span style="color: var(--shiki-color-text)">(props);</span></li><li value="19"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.state </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'ConnectAccount'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">defaults};</span></li><li value="20"><span style="color: var(--shiki-color-text)">  }</span></li><li value="21"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://reactjs.org/docs/react-component.html#componentdidmount" title="js: componentDidMount"><span style="color: var(--shiki-token-function)">componentDidMount</span></a><span style="color: var(--shiki-color-text)">() {</span></li><li value="22"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-token-constant)">acc</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_getDefaultAccount" title="js: getDefaultAccount"><span style="color: var(--shiki-token-function)">.getDefaultAccount</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="23"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">balAtomic</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_acc.balanceOf" title="js: acc.balanceOf"><span style="color: var(--shiki-token-function)">.balanceOf</span></a><span style="color: var(--shiki-color-text)">(acc);</span></li><li value="24"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">bal</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_formatCurrency" title="js: formatCurrency"><span style="color: var(--shiki-token-function)">.formatCurrency</span></a><span style="color: var(--shiki-color-text)">(balAtomic</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)">);</span></li><li value="25"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({acc</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> bal});</span></li><li value="26"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_canFundFromFaucet" title="js: canFundFromFaucet"><span style="color: var(--shiki-token-function)">.canFundFromFaucet</span></a><span style="color: var(--shiki-color-text)">()) {</span></li><li value="27"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'FundAccount'</span><span style="color: var(--shiki-color-text)">});</span></li><li value="28"><span style="color: var(--shiki-color-text)">    } </span><span style="color: var(--shiki-token-keyword)">else</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="29"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'DeployerOrAttacher'</span><span style="color: var(--shiki-color-text)">});</span></li><li value="30"><span style="color: var(--shiki-color-text)">    }</span></li><li value="31"><span style="color: var(--shiki-color-text)">  }</span></li></ol></pre>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.js">/examples/rps-9-web/index.js</a><a class="far fa-copy copyBtn" data-clipboard-text="  render() { return renderView(this, AppViews); }
}" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="39"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">render</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">renderView</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> AppViews); }</span></li><li value="40"><span style="color: var(--shiki-color-text)">}</span></li><li value="41"></li></ol></pre>
<ul>
  <li><i id="p_357" class="pid"></i>On line 19, we initialize the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-ConnectAccount">Connect Account dialog</a>.<a href="https://docs.reach.sh/tut/rps/#p_357" class="pid">357</a></li>
  <li><i id="p_358" class="pid"></i>On lines 21 thru 31, we hook into <a href="https://reactjs.org/docs/react-component.html#componentdidmount">React's <span class="snip"></span></a><a href="https://reactjs.org/docs/react-component.html#componentdidmount" title="js: componentDidMount"><span style="color: var(--shiki-color-text)">componentDidMount</span></a> lifecycle event, which is called when the component starts.<a href="https://docs.reach.sh/tut/rps/#p_358" class="pid">358</a></li>
  <li>
    <i id="p_359" class="pid"></i>On line 22, we use <span class="snip"><a href="https://docs.reach.sh/frontend/#js_getDefaultAccount" title="js: getDefaultAccount"><span style="color: var(--shiki-color-text)">getDefaultAccount</span></a></span>, which accesses the default browser account.
    For example, when used with Ethereum, it can discover the currently-selected MetaMask account.<a href="https://docs.reach.sh/tut/rps/#p_359" class="pid">359</a>
  </li>
  <li><i id="p_360" class="pid"></i>On line 26, we use <span class="snip"><a href="https://docs.reach.sh/frontend/#js_canFundFromFaucet" title="js: canFundFromFaucet"><span style="color: var(--shiki-color-text)">canFundFromFaucet</span></a></span> to see if we can access the Reach developer testing network faucet.<a href="https://docs.reach.sh/tut/rps/#p_360" class="pid">360</a></li>
  <li><i id="p_361" class="pid"></i>On line 27, if <span class="snip"><a href="https://docs.reach.sh/frontend/#js_canFundFromFaucet" title="js: canFundFromFaucet"><span style="color: var(--shiki-color-text)">canFundFromFaucet</span></a></span> was <span class="snip"><span style="color: var(--shiki-token-constant)">true</span></span>, we set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-FundAccount">Fund Account dialog</a>.<a href="https://docs.reach.sh/tut/rps/#p_361" class="pid">361</a></li>
  <li><i id="p_362" class="pid"></i>On line 29, if <span class="snip"><a href="https://docs.reach.sh/frontend/#js_canFundFromFaucet" title="js: canFundFromFaucet"><span style="color: var(--shiki-color-text)">canFundFromFaucet</span></a></span> was <span class="snip"><span style="color: var(--shiki-token-constant)">false</span></span>, we set the component state to skip to <a href="https://docs.reach.sh/tut/rps/#tut-9-DeployerOrAttacher">Choose Role</a>.<a href="https://docs.reach.sh/tut/rps/#p_362" class="pid">362</a></li>
  <li><i id="p_363" class="pid"></i>On line 39, we render the appropriate view from <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/AppViews.js">rps-9-web/views/AppViews.js</a>.<a href="https://docs.reach.sh/tut/rps/#p_363" class="pid">363</a></li>
</ul>
<h3 id="tut-9-ConnectAccount" class="refHeader">Connect Account dialog<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-ConnectAccount"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_364" class="pid"></i>When we combine the application component with the view (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/AppViews.js#L19-L28">rps-9-web/views/AppViews.js</a>) it will look like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/ConnectAccount.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_364" class="pid">364</a>
</p>
<h3 id="tut-9-FundAccount" class="refHeader">Fund Account dialog<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-FundAccount"><span class="icon icon-link"></span></a></h3>
<p><i id="p_365" class="pid"></i>Next, we define callbacks on <span class="snip"><span style="color: var(--shiki-color-text)">App</span></span> for what to do when the user clicks certain buttons.<a href="https://docs.reach.sh/tut/rps/#p_365" class="pid">365</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.js">/examples/rps-9-web/index.js</a><a class="far fa-copy copyBtn" data-clipboard-text="  async fundAccount(fundAmount) {
    await reach.fundFromFaucet(this.state.acc, reach.parseCurrency(fundAmount));
    this.setState({view: &#39;DeployerOrAttacher&#39;});
  }
  async skipFundAccount() { this.setState({view: &#39;DeployerOrAttacher&#39;}); }" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="32"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">fundAccount</span><span style="color: var(--shiki-color-text)">(fundAmount) {</span></li><li value="33"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_fundFromFaucet" title="js: fundFromFaucet"><span style="color: var(--shiki-token-function)">.fundFromFaucet</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">state</span><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-color-text)">.acc</span></a><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-token-function)">.parseCurrency</span></a><span style="color: var(--shiki-color-text)">(fundAmount));</span></li><li value="34"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'DeployerOrAttacher'</span><span style="color: var(--shiki-color-text)">});</span></li><li value="35"><span style="color: var(--shiki-color-text)">  }</span></li><li value="36"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">skipFundAccount</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'DeployerOrAttacher'</span><span style="color: var(--shiki-color-text)">}); }</span></li></ol></pre>
<ul>
  <li><i id="p_366" class="pid"></i>On lines 32 thru 35, we define what happens when the user clicks the <code>Fund Account</code> button.<a href="https://docs.reach.sh/tut/rps/#p_366" class="pid">366</a></li>
  <li><i id="p_367" class="pid"></i>On line 33, we transfer funds from the faucet to the user's account.<a href="https://docs.reach.sh/tut/rps/#p_367" class="pid">367</a></li>
  <li><i id="p_368" class="pid"></i>On line 34, we set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-DeployerOrAttacher">Choose Role</a>.<a href="https://docs.reach.sh/tut/rps/#p_368" class="pid">368</a></li>
  <li>
    <i id="p_369" class="pid"></i>On line 36, we define what to do when the user clicks the <code>Skip</code> button,
    which is to set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-DeployerOrAttacher">Choose Role</a>.<a href="https://docs.reach.sh/tut/rps/#p_369" class="pid">369</a>
  </li>
</ul>
<p>
  <i id="p_370" class="pid"></i>When we combine this with the view (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/AppViews.js#L30-L54">rps-9-web/views/AppViews.js</a>) it will look like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/FundAccount.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_370" class="pid">370</a>
</p>
<h3 id="tut-9-DeployerOrAttacher" class="refHeader">Choose Role<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-DeployerOrAttacher"><span class="icon icon-link"></span></a></h3>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.js">/examples/rps-9-web/index.js</a><a class="far fa-copy copyBtn" data-clipboard-text="  selectAttacher() { this.setState({view: &#39;Wrapper&#39;, ContentView: Attacher}); }
  selectDeployer() { this.setState({view: &#39;Wrapper&#39;, ContentView: Deployer}); }" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="37"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">selectAttacher</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Wrapper'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ContentView</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> Attacher}); }</span></li><li value="38"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">selectDeployer</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Wrapper'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ContentView</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> Deployer}); }</span></li></ol></pre>
<p>
  <i id="p_371" class="pid"></i>On lines 37 and 38, we set a sub-component
  based on whether the user clicks <code>Deployer</code> or <code>Attacher</code>.<a href="https://docs.reach.sh/tut/rps/#p_371" class="pid">371</a>
</p>
<p>
  <i id="p_372" class="pid"></i>When we combine this with the view (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/AppViews.js#L56-L78">rps-9-web/views/AppViews.js</a>) it will look like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/DeployerOrAttacher.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_372" class="pid">372</a>
</p>
<h3 id="tut-9-Player" class="refHeader">Player component<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-Player"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_373" class="pid"></i>Next, we will define <span class="snip"><span style="color: var(--shiki-color-text)">Player</span></span> as a React component,
  that will hold all of the behavior of the players and
  which will be extended by the specialized components for Alice and Bob.<a href="https://docs.reach.sh/tut/rps/#p_373" class="pid">373</a>
</p>
<p><i id="p_374" class="pid"></i>Our Web frontend needs to implement the participant interact interface for players, which we defined as:<a href="https://docs.reach.sh/tut/rps/#p_374" class="pid">374</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.rsh">/examples/rps-9-web/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="const Player = {
  ...hasRandom,
  getHand: Fun([], UInt),
  seeOutcome: Fun([UInt], Null),
  informTimeout: Fun([], Null),
};" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="20"><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Player</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="21"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">...</span><a href="https://docs.reach.sh/rsh/compute/#rsh_hasRandom" title="rsh: hasRandom"><span style="color: var(--shiki-color-text)">hasRandom</span></a><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="22"><span style="color: var(--shiki-color-text)">  getHand</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> UInt)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="23"><span style="color: var(--shiki-color-text)">  seeOutcome</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([UInt]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="24"><span style="color: var(--shiki-color-text)">  informTimeout</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="25"><span style="color: var(--shiki-color-text)">};</span></li></ol></pre>
<p><i id="p_375" class="pid"></i>We will provide these callbacks via the React component directly.<a href="https://docs.reach.sh/tut/rps/#p_375" class="pid">375</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.js">/examples/rps-9-web/index.js</a><a class="far fa-copy copyBtn" data-clipboard-text="class Player extends React.Component {
  random() { return reach.hasRandom.random(); }
  async getHand() { // Fun([], UInt)
    const hand = await new Promise(resolveHandP =&gt; {
      this.setState({view: &#39;GetHand&#39;, playable: true, resolveHandP});
    });
    this.setState({view: &#39;WaitingForResults&#39;, hand});
    return handToInt[hand];
  }
  seeOutcome(i) { this.setState({view: &#39;Done&#39;, outcome: intToOutcome[i]}); }
  informTimeout() { this.setState({view: &#39;Timeout&#39;}); }
  playHand(hand) { this.state.resolveHandP(hand); }
}" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="42"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">React</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">Component</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="43"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">random</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><span style="color: var(--shiki-token-function)">.</span><a href="https://docs.reach.sh/frontend/#js_hasRandom" title="js: hasRandom"><span style="color: var(--shiki-token-constant)">hasRandom</span></a><span style="color: var(--shiki-token-function)">.random</span><span style="color: var(--shiki-color-text)">(); }</span></li><li value="44"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getHand</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-comment)">// Fun([], UInt)</span></li><li value="45"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">hand</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Promise</span><span style="color: var(--shiki-color-text)">(resolveHandP </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="46"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'GetHand'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> playable</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">true</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> resolveHandP});</span></li><li value="47"><span style="color: var(--shiki-color-text)">    });</span></li><li value="48"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'WaitingForResults'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> hand});</span></li><li value="49"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> handToInt[hand];</span></li><li value="50"><span style="color: var(--shiki-color-text)">  }</span></li><li value="51"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">seeOutcome</span><span style="color: var(--shiki-color-text)">(i) { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Done'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> outcome</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> intToOutcome[i]}); }</span></li><li value="52"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">informTimeout</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Timeout'</span><span style="color: var(--shiki-color-text)">}); }</span></li><li value="53"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">playHand</span><span style="color: var(--shiki-color-text)">(hand) { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">state</span><span style="color: var(--shiki-token-function)">.resolveHandP</span><span style="color: var(--shiki-color-text)">(hand); }</span></li><li value="54"><span style="color: var(--shiki-color-text)">}</span></li><li value="55"></li></ol></pre>
<ul>
  <li><i id="p_376" class="pid"></i>On line 43, we provide the <span class="snip"><span style="color: var(--shiki-color-text)">random</span></span> callback<a href="https://docs.reach.sh/tut/rps/#p_376" class="pid">376</a></li>
  <li><i id="p_377" class="pid"></i>On lines 44 thru 50, we provide the <span class="snip"><span style="color: var(--shiki-color-text)">getHand</span></span> callback.<a href="https://docs.reach.sh/tut/rps/#p_377" class="pid">377</a></li>
  <li>
    <i id="p_378" class="pid"></i>On lines 45 thru 47, we set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-GetHand">Get Hand dialog</a>,
    and wait for a <span class="snip"><span style="color: var(--shiki-token-constant)">Promise</span></span> which can be resolved via user interaction.<a href="https://docs.reach.sh/tut/rps/#p_378" class="pid">378</a>
  </li>
  <li>
    <i id="p_379" class="pid"></i>On line 48, which occurs after the <span class="snip"><span style="color: var(--shiki-token-constant)">Promise</span></span> is resolved,
    we set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-WaitingForResults">Waiting for results display</a>.<a href="https://docs.reach.sh/tut/rps/#p_379" class="pid">379</a>
  </li>
  <li>
    <i id="p_380" class="pid"></i>On lines 51 and 52, we provide the <span class="snip"><span style="color: var(--shiki-color-text)">seeOutcome</span></span> and <span class="snip"><span style="color: var(--shiki-color-text)">informTimeout</span></span> callbacks,
    which set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-Done">Done display</a> and <a href="https://docs.reach.sh/tut/rps/#tut-9-Timeout">Timeout display</a>, respectively.<a href="https://docs.reach.sh/tut/rps/#p_380" class="pid">380</a>
  </li>
  <li>
    <i id="p_381" class="pid"></i>On line 53, we define what happens when the user clicks <code>Rock</code>, <code>Paper</code>, or <code>Scissors</code>:
    The <span class="snip"><span style="color: var(--shiki-token-constant)">Promise</span></span> from line 45 is resolved.<a href="https://docs.reach.sh/tut/rps/#p_381" class="pid">381</a>
  </li>
</ul>
<h3 id="tut-9-GetHand" class="refHeader">Get Hand dialog<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-GetHand"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_382" class="pid"></i>The dialog used to get a hand from the player (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/PlayerViews.js#L8-L32">rps-9-web/views/PlayerViews.js</a>) looks like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/GetHand.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_382" class="pid">382</a>
</p>
<h3 id="tut-9-WaitingForResults" class="refHeader">Waiting for results display<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-WaitingForResults"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_383" class="pid"></i>The dialog used to get a hand from the player (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/PlayerViews.js#L34-L42">rps-9-web/views/PlayerViews.js</a>) looks like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/WaitingForResults.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_383" class="pid">383</a>
</p>
<h3 id="tut-9-Done" class="refHeader">Done display<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-Done"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_384" class="pid"></i>The display when the player sees the end of the game (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/PlayerViews.js#L44-L54">rps-9-web/views/PlayerViews.js</a>) looks like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/Done.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_384" class="pid">384</a>
</p>
<h3 id="tut-9-Timeout" class="refHeader">Timeout display<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-Timeout"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_385" class="pid"></i>The display when the player sees a timeout (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/PlayerViews.js#L56-L64">rps-9-web/views/PlayerViews.js</a>) looks like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/Timeout.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_385" class="pid">385</a>
</p>
<h3 id="tut-9-Deployer" class="refHeader">Deployer component<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-Deployer"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_386" class="pid"></i>Next, we will define <span class="snip"><span style="color: var(--shiki-color-text)">Deployer</span></span> as a React component for Alice,
  which extends <span class="snip"><span style="color: var(--shiki-color-text)">Player</span></span>.<a href="https://docs.reach.sh/tut/rps/#p_386" class="pid">386</a>
</p>
<p><i id="p_387" class="pid"></i>Our Web frontend needs to implement the participant interact interface for Alice, which we defined as:<a href="https://docs.reach.sh/tut/rps/#p_387" class="pid">387</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.rsh">/examples/rps-9-web/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  const Alice = Participant(&#39;Alice&#39;, {
    ...Player,
    wager: UInt, // atomic units of currency
    deadline: UInt, // time delta (blocks/rounds)
  });" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="28"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Alice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="29"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">Player</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="30"><span style="color: var(--shiki-color-text)">    wager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> UInt</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-comment)">// atomic units of currency</span></li><li value="31"><span style="color: var(--shiki-color-text)">    deadline</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> UInt</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-comment)">// time delta (blocks/rounds)</span></li><li value="32"><span style="color: var(--shiki-color-text)">  });</span></li></ol></pre>
<p>
  <i id="p_388" class="pid"></i>We will provide the <span class="snip"><span style="color: var(--shiki-color-text)">wager</span></span> and <span class="snip"><span style="color: var(--shiki-color-text)">deadline</span></span> values,
  and define some button handlers in order to trigger the deployment of the contract.<a href="https://docs.reach.sh/tut/rps/#p_388" class="pid">388</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.js">/examples/rps-9-web/index.js</a><a class="far fa-copy copyBtn" data-clipboard-text="class Deployer extends Player {
  constructor(props) {
    super(props);
    this.state = {view: &#39;SetWager&#39;};
  }
  setWager(wager) { this.setState({view: &#39;Deploy&#39;, wager}); }
  async deploy() {
    const ctc = this.props.acc.contract(backend);
    this.setState({view: &#39;Deploying&#39;, ctc});
    this.wager = reach.parseCurrency(this.state.wager); // UInt
    this.deadline = {ETH: 10, ALGO: 100, CFX: 1000}[reach.connector]; // UInt
    backend.Alice(ctc, this);
    const ctcInfoStr = JSON.stringify(await ctc.getInfo(), null, 2);
    this.setState({view: &#39;WaitingForAttacher&#39;, ctcInfoStr});
  }
  render() { return renderView(this, DeployerViews); }
}" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="56"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Deployer</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="57"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/tut/rps/undefined" title="undefined"><span style="color: var(--shiki-token-keyword)">constructor</span></a><span style="color: var(--shiki-color-text)">(props) {</span></li><li value="58"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">super</span><span style="color: var(--shiki-color-text)">(props);</span></li><li value="59"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.state </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'SetWager'</span><span style="color: var(--shiki-color-text)">};</span></li><li value="60"><span style="color: var(--shiki-color-text)">  }</span></li><li value="61"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">setWager</span><span style="color: var(--shiki-color-text)">(wager) { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Deploy'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> wager}); }</span></li><li value="62"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_deploy" title="js: deploy"><span style="color: var(--shiki-token-function)">deploy</span></a><span style="color: var(--shiki-color-text)">() {</span></li><li value="63"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">props</span><span style="color: var(--shiki-token-function)">.</span><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-token-constant)">acc</span></a><a href="https://docs.reach.sh/frontend/#js_contract" title="js: contract"><span style="color: var(--shiki-token-function)">.contract</span></a><span style="color: var(--shiki-color-text)">(backend);</span></li><li value="64"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Deploying'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ctc});</span></li><li value="65"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.wager </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-token-function)">.parseCurrency</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">state</span><span style="color: var(--shiki-color-text)">.wager); </span><span style="color: var(--shiki-token-comment)">// UInt</span></li><li value="66"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.deadline </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {ETH</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ALGO</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> CFX</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1000</span><span style="color: var(--shiki-color-text)">}[</span><span style="color: var(--shiki-token-constant)">reach</span><span style="color: var(--shiki-color-text)">.connector]; </span><span style="color: var(--shiki-token-comment)">// UInt</span></li><li value="67"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/cout/#js_backend" title="js: backend"><span style="color: var(--shiki-token-constant)">backend</span></a><span style="color: var(--shiki-token-function)">.Alice</span><span style="color: var(--shiki-color-text)">(ctc</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">);</span></li><li value="68"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">ctcInfoStr</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">JSON</span><span style="color: var(--shiki-token-function)">.stringify</span><span style="color: var(--shiki-color-text)">(</span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><a href="https://docs.reach.sh/frontend/#js_getInfo" title="js: getInfo"><span style="color: var(--shiki-token-function)">.getInfo</span></a><span style="color: var(--shiki-color-text)">()</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">null</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">);</span></li><li value="69"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'WaitingForAttacher'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ctcInfoStr});</span></li><li value="70"><span style="color: var(--shiki-color-text)">  }</span></li><li value="71"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">render</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">renderView</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> DeployerViews); }</span></li><li value="72"><span style="color: var(--shiki-color-text)">}</span></li></ol></pre>
<ul>
  <li><i id="p_389" class="pid"></i>On line 59, we set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-SetWager">Set Wager dialog</a>.<a href="https://docs.reach.sh/tut/rps/#p_389" class="pid">389</a></li>
  <li>
    <i id="p_390" class="pid"></i>On line 61, we define what to do when the user clicks the <code>Set Wager</code> button,
    which is to set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-Deploy">Deploy dialog</a>.<a href="https://docs.reach.sh/tut/rps/#p_390" class="pid">390</a>
  </li>
  <li><i id="p_391" class="pid"></i>On lines 62 thru 69, we define what to do when the user clicks the <code>Deploy</code> button.<a href="https://docs.reach.sh/tut/rps/#p_391" class="pid">391</a></li>
  <li><i id="p_392" class="pid"></i>On line 63, we call <span class="snip"><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-token-constant)">acc</span></a><a href="https://docs.reach.sh/frontend/#js_deploy" title="js: deploy"><span style="color: var(--shiki-color-text)">.deploy</span></a></span>, which triggers a deploy of the contract.<a href="https://docs.reach.sh/tut/rps/#p_392" class="pid">392</a></li>
  <li><i id="p_393" class="pid"></i>On line 64, we set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-Deploying">Deploying display</a>.<a href="https://docs.reach.sh/tut/rps/#p_393" class="pid">393</a></li>
  <li><i id="p_394" class="pid"></i>On line 65, we set the <span class="snip"><span style="color: var(--shiki-color-text)">wager</span></span> property.<a href="https://docs.reach.sh/tut/rps/#p_394" class="pid">394</a></li>
  <li><i id="p_395" class="pid"></i>On line 66, we set the <span class="snip"><span style="color: var(--shiki-color-text)">deadline</span></span> property based on which connector is being used.<a href="https://docs.reach.sh/tut/rps/#p_395" class="pid">395</a></li>
  <li>
    <i id="p_396" class="pid"></i>On line 67, we start running the Reach program as Alice, using the <span class="snip"><span style="color: var(--shiki-token-constant)">this</span></span> React component
    as the participant interact interface object.<a href="https://docs.reach.sh/tut/rps/#p_396" class="pid">396</a>
  </li>
  <li>
    <i id="p_397" class="pid"></i>On lines 68 and 69, we set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-WaitingForAttacher">Waiting for Attacher display</a>,
    which displays the deployed contract info as JSON.<a href="https://docs.reach.sh/tut/rps/#p_397" class="pid">397</a>
  </li>
  <li><i id="p_398" class="pid"></i>On line 71, we render the appropriate view from <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/DeployerViews.js">rps-9-web/views/DeployerViews.js</a>.<a href="https://docs.reach.sh/tut/rps/#p_398" class="pid">398</a></li>
</ul>
<h3 id="tut-9-SetWager" class="refHeader">Set Wager dialog<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-SetWager"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_399" class="pid"></i>The dialog used to set the wager (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/DeployerViews.js#L20-L38">rps-9-web/views/DeployerViews.js</a>) looks like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/SetWager.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_399" class="pid">399</a>
</p>
<h3 id="tut-9-Deploy" class="refHeader">Deploy dialog<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-Deploy"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_400" class="pid"></i>The dialog used to deploy (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/DeployerViews.js#L40-L53">rps-9-web/views/DeployerViews.js</a>) looks like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/Deploy.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_400" class="pid">400</a>
</p>
<h3 id="tut-9-Deploying" class="refHeader">Deploying display<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-Deploying"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_401" class="pid"></i>The display shown while deploying (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/DeployerViews.js#L55-L61">rps-9-web/views/DeployerViews.js</a>) looks like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/Deploying.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_401" class="pid">401</a>
</p>
<h3 id="tut-9-WaitingForAttacher" class="refHeader">Waiting for Attacher display<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-WaitingForAttacher"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_402" class="pid"></i>The display shown while waiting for the attacher (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/DeployerViews.js#L63-L90">rps-9-web/views/DeployerViews.js</a>) looks like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/WaitingForAttacher.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_402" class="pid">402</a>
</p>
<h3 id="tut-9-Attacher" class="refHeader">Attacher component<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-Attacher"><span class="icon icon-link"></span></a></h3>
<p><i id="p_403" class="pid"></i>Our Web frontend needs to implement the participant interact interface for Bob, which we defined as:<a href="https://docs.reach.sh/tut/rps/#p_403" class="pid">403</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.rsh">/examples/rps-9-web/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="  const Bob   = Participant(&#39;Bob&#39;, {
    ...Player,
    acceptWager: Fun([UInt], Null),
  });" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="33"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Bob</span><span style="color: var(--shiki-color-text)">   </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Bob'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="34"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">Player</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="35"><span style="color: var(--shiki-color-text)">    acceptWager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([UInt]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="36"><span style="color: var(--shiki-color-text)">  });</span></li></ol></pre>
<p>
  <i id="p_404" class="pid"></i>We will provide the <span class="snip"><span style="color: var(--shiki-color-text)">acceptWager</span></span> callback,
  and define some button handlers in order to attach to the deployed contract.<a href="https://docs.reach.sh/tut/rps/#p_404" class="pid">404</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.js">/examples/rps-9-web/index.js</a><a class="far fa-copy copyBtn" data-clipboard-text="class Attacher extends Player {
  constructor(props) {
    super(props);
    this.state = {view: &#39;Attach&#39;};
  }
  attach(ctcInfoStr) {
    const ctc = this.props.acc.contract(backend, JSON.parse(ctcInfoStr));
    this.setState({view: &#39;Attaching&#39;});
    backend.Bob(ctc, this);
  }
  async acceptWager(wagerAtomic) { // Fun([UInt], Null)
    const wager = reach.formatCurrency(wagerAtomic, 4);
    return await new Promise(resolveAcceptedP =&gt; {
      this.setState({view: &#39;AcceptTerms&#39;, wager, resolveAcceptedP});
    });
  }
  termsAccepted() {
    this.state.resolveAcceptedP();
    this.setState({view: &#39;WaitingForTurn&#39;});
  }
  render() { return renderView(this, AttacherViews); }
}" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="73"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Attacher</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="74"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/tut/rps/undefined" title="undefined"><span style="color: var(--shiki-token-keyword)">constructor</span></a><span style="color: var(--shiki-color-text)">(props) {</span></li><li value="75"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">super</span><span style="color: var(--shiki-color-text)">(props);</span></li><li value="76"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.state </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Attach'</span><span style="color: var(--shiki-color-text)">};</span></li><li value="77"><span style="color: var(--shiki-color-text)">  }</span></li><li value="78"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/frontend/#js_attach" title="js: attach"><span style="color: var(--shiki-token-function)">attach</span></a><span style="color: var(--shiki-color-text)">(ctcInfoStr) {</span></li><li value="79"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">props</span><span style="color: var(--shiki-token-function)">.</span><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-token-constant)">acc</span></a><a href="https://docs.reach.sh/frontend/#js_contract" title="js: contract"><span style="color: var(--shiki-token-function)">.contract</span></a><span style="color: var(--shiki-color-text)">(backend</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">JSON</span><span style="color: var(--shiki-token-function)">.parse</span><span style="color: var(--shiki-color-text)">(ctcInfoStr));</span></li><li value="80"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Attaching'</span><span style="color: var(--shiki-color-text)">});</span></li><li value="81"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/cout/#js_backend" title="js: backend"><span style="color: var(--shiki-token-constant)">backend</span></a><span style="color: var(--shiki-token-function)">.Bob</span><span style="color: var(--shiki-color-text)">(ctc</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">);</span></li><li value="82"><span style="color: var(--shiki-color-text)">  }</span></li><li value="83"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">acceptWager</span><span style="color: var(--shiki-color-text)">(wagerAtomic) { </span><span style="color: var(--shiki-token-comment)">// Fun([UInt], Null)</span></li><li value="84"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">wager</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_formatCurrency" title="js: formatCurrency"><span style="color: var(--shiki-token-function)">.formatCurrency</span></a><span style="color: var(--shiki-color-text)">(wagerAtomic</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)">);</span></li><li value="85"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Promise</span><span style="color: var(--shiki-color-text)">(resolveAcceptedP </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="86"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'AcceptTerms'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> wager</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> resolveAcceptedP});</span></li><li value="87"><span style="color: var(--shiki-color-text)">    });</span></li><li value="88"><span style="color: var(--shiki-color-text)">  }</span></li><li value="89"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">termsAccepted</span><span style="color: var(--shiki-color-text)">() {</span></li><li value="90"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">state</span><span style="color: var(--shiki-token-function)">.resolveAcceptedP</span><span style="color: var(--shiki-color-text)">();</span></li><li value="91"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'WaitingForTurn'</span><span style="color: var(--shiki-color-text)">});</span></li><li value="92"><span style="color: var(--shiki-color-text)">  }</span></li><li value="93"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">render</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">renderView</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> AttacherViews); }</span></li><li value="94"><span style="color: var(--shiki-color-text)">}</span></li><li value="95"></li></ol></pre>
<ul>
  <li><i id="p_405" class="pid"></i>On line 76, we initialize the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-Attach">Attach dialog</a>.<a href="https://docs.reach.sh/tut/rps/#p_405" class="pid">405</a></li>
  <li><i id="p_406" class="pid"></i>On lines 78 thru 82, we define what happens when the user clicks the <code>Attach</code> button.<a href="https://docs.reach.sh/tut/rps/#p_406" class="pid">406</a></li>
  <li><i id="p_407" class="pid"></i>On line 79, we call <span class="snip"><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-token-constant)">acc</span></a><a href="https://docs.reach.sh/frontend/#js_attach" title="js: attach"><span style="color: var(--shiki-color-text)">.attach</span></a></span><a href="https://docs.reach.sh/tut/rps/#p_407" class="pid">407</a></li>
  <li><i id="p_408" class="pid"></i>On line 80, we set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-Attaching">Attaching display</a>.<a href="https://docs.reach.sh/tut/rps/#p_408" class="pid">408</a></li>
  <li>
    <i id="p_409" class="pid"></i>On line 81, we start running the Reach program as Bob, using the <span class="snip"><span style="color: var(--shiki-token-constant)">this</span></span> React component
    as the participant interact interface object.<a href="https://docs.reach.sh/tut/rps/#p_409" class="pid">409</a>
  </li>
  <li><i id="p_410" class="pid"></i>On lines 83 thru 88, we define the <span class="snip"><span style="color: var(--shiki-color-text)">acceptWager</span></span> callback.<a href="https://docs.reach.sh/tut/rps/#p_410" class="pid">410</a></li>
  <li>
    <i id="p_411" class="pid"></i>On lines 85 thru 87, we set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-AcceptTerms">Accept Terms dialog</a>,
    and wait for a <span class="snip"><span style="color: var(--shiki-token-constant)">Promise</span></span> which can be resolved via user interaction.<a href="https://docs.reach.sh/tut/rps/#p_411" class="pid">411</a>
  </li>
  <li>
    <i id="p_412" class="pid"></i>On lines 89 thru 92, we define what happens when the user clicks the <code>Accept Terms and Pay Wager</code> button:
    the <span class="snip"><span style="color: var(--shiki-token-constant)">Promise</span></span> from line 90 is resolved, and we set the component state to display <a href="https://docs.reach.sh/tut/rps/#tut-9-WaitingForTurn">Waiting for Turn display</a>.<a href="https://docs.reach.sh/tut/rps/#p_412" class="pid">412</a>
  </li>
  <li><i id="p_413" class="pid"></i>On line 93, we render the appropriate view from <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/AttacherViews.js">rps-9-web/views/AttacherViews.js</a><a href="https://docs.reach.sh/tut/rps/#p_413" class="pid">413</a></li>
</ul>
<h3 id="tut-9-Attach" class="refHeader">Attach dialog<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-Attach"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_414" class="pid"></i>The dialog used to attach (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/AttacherViews.js#L18-L39">rps-9-web/views/AttacherViews.js</a>) looks like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/Attach.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_414" class="pid">414</a>
</p>
<h3 id="tut-9-Attaching" class="refHeader">Attaching display<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-Attaching"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_415" class="pid"></i>The display when attaching (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/AttacherViews.js#L41-L49">rps-9-web/views/AttacherViews.js</a>) looks like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/Attaching.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_415" class="pid">415</a>
</p>
<h3 id="tut-9-AcceptTerms" class="refHeader">Accept Terms dialog<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-AcceptTerms"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_416" class="pid"></i>The dialog used to accept the terms of the wager (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/AttacherViews.js#L51-L70">rps-9-web/views/AttacherViews.js</a>) looks like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/AcceptTerms.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_416" class="pid">416</a>
</p>
<h3 id="tut-9-WaitingForTurn" class="refHeader">Waiting for Turn display<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-WaitingForTurn"><span class="icon icon-link"></span></a></h3>
<p>
  <i id="p_417" class="pid"></i>The display when waiting for a turn (<a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/AttacherViews.js#L72-L81">rps-9-web/views/AttacherViews.js</a>) looks like:
  
  <img src="./Reach _ Rock, Paper, Scissors!_files/WaitingForTurn.png" alt=""><a href="https://docs.reach.sh/tut/rps/#p_417" class="pid">417</a>
</p>
<h3 id="tut-9-Final" class="refHeader">Putting it all together<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-9-Final"><span class="icon icon-link"></span></a></h3>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.js">/examples/rps-9-web/index.js</a><a class="far fa-copy copyBtn" data-clipboard-text="renderDOM(&lt;App /&gt;);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="96"><span style="color: var(--shiki-token-function)">renderDOM</span><span style="color: var(--shiki-color-text)">(&lt;</span><span style="color: var(--shiki-token-constant)">App</span><span style="color: var(--shiki-color-text)"> /&gt;);</span></li></ol></pre>
<p>
  <i id="p_418" class="pid"></i>Finally, we call a small helper function from <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/views/render.js">rps-9-web/views/render.js</a>
  to render our App component.<a href="https://docs.reach.sh/tut/rps/#p_418" class="pid">418</a>
</p>
<hr>
<p>
  <i id="p_419" class="pid"></i>As a convenience for running the React development server,
  you can call:<a href="https://docs.reach.sh/tut/rps/#p_419" class="pid">419</a>
</p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach react" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach react</span></li></ol></pre>
<div class="note">
  <p>
    <i id="p_420" class="pid"></i>If you get an error or it does not seem to be working correctly, make sure that the folder does not have an <code>index.mjs</code> file.
    If you do, you can rename it to <code>index.mjs.bak</code> or move it to a new directory with a copy of the old <code>index.rsh</code>.<a href="https://docs.reach.sh/tut/rps/#p_420" class="pid">420</a>
  </p>
</div>
<hr>
<p>
  <i id="p_421" class="pid"></i>To run the React development server with Algorand,
  you can call:<a href="https://docs.reach.sh/tut/rps/#p_421" class="pid">421</a>
</p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="REACH_CONNECTOR_MODE=ALGO ./reach react" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> REACH_CONNECTOR_MODE</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)">ALGO ./reach react</span></li></ol></pre>
<div class="note">
  <p><i id="p_422" class="pid"></i>If you expect that your Algorand users do not have access to an <a href="https://github.com/algorandfoundation/ARCs/blob/main/ARCs/arc-0011.md">ARC-0011</a> browser wallet, you want to provide a fallback.<a href="https://docs.reach.sh/tut/rps/#p_422" class="pid">422</a></p>
  <p><i id="p_423" class="pid"></i>If you add the following to your program, then you can provide a simple wallet where the user copies and pastes their mnemonic for each interaction.<a href="https://docs.reach.sh/tut/rps/#p_423" class="pid">423</a></p>
  <pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="reach.setWalletFallback(reach.walletFallback({}));" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_setWalletFallback" title="js: setWalletFallback"><span style="color: var(--shiki-token-function)">.setWalletFallback</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_walletFallback" title="js: walletFallback"><span style="color: var(--shiki-token-function)">.walletFallback</span></a><span style="color: var(--shiki-color-text)">({}));</span></li></ol></pre>
  <p><i id="p_424" class="pid"></i>Instead, if you would like to allow your users to use <a href="https://wallet.myalgo.com/home">MyAlgo</a>, then you can add the following:<a href="https://docs.reach.sh/tut/rps/#p_424" class="pid">424</a></p>
  <pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="import { ALGO_MyAlgoConnect as MyAlgoConnect } from &#39;@reach-sh/stdlib&#39;;
reach.setWalletFallback(reach.walletFallback({
  providerEnv: &#39;TestNet&#39;, MyAlgoConnect }));" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> { ALGO_MyAlgoConnect </span><span style="color: var(--shiki-token-keyword)">as</span><span style="color: var(--shiki-color-text)"> MyAlgoConnect } </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'@reach-sh/stdlib'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="2"><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_setWalletFallback" title="js: setWalletFallback"><span style="color: var(--shiki-token-function)">.setWalletFallback</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_walletFallback" title="js: walletFallback"><span style="color: var(--shiki-token-function)">.walletFallback</span></a><span style="color: var(--shiki-color-text)">({</span></li><li value="3"><span style="color: var(--shiki-color-text)">  providerEnv</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'TestNet'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> MyAlgoConnect }));</span></li></ol></pre>
  <p><i id="p_425" class="pid"></i>Or, you could have your users use <a href="https://walletconnect.com/">WalletConnect</a> to connect to the <a href="https://algorandwallet.com/">Algorand Wallet</a>, by adding the following:<a href="https://docs.reach.sh/tut/rps/#p_425" class="pid">425</a></p>
  <pre class="snippet numbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="import { ALGO_WalletConnect as WalletConnect } from &#39;@reach-sh/stdlib&#39;;
reach.setWalletFallback(reach.walletFallback({
  providerEnv: &#39;TestNet&#39;, WalletConnect }));" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> { ALGO_WalletConnect </span><span style="color: var(--shiki-token-keyword)">as</span><span style="color: var(--shiki-color-text)"> WalletConnect } </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'@reach-sh/stdlib'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="2"><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_setWalletFallback" title="js: setWalletFallback"><span style="color: var(--shiki-token-function)">.setWalletFallback</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_walletFallback" title="js: walletFallback"><span style="color: var(--shiki-token-function)">.walletFallback</span></a><span style="color: var(--shiki-color-text)">({</span></li><li value="3"><span style="color: var(--shiki-color-text)">  providerEnv</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'TestNet'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> WalletConnect }));</span></li></ol></pre>
  <p><i id="p_426" class="pid"></i>(Of course, you may want to replace <code>'TestNet'</code> in either of these samples with a different network name, like <code>'MainNet'</code>.)<a href="https://docs.reach.sh/tut/rps/#p_426" class="pid">426</a></p>
  <p><i id="p_427" class="pid"></i>Because these are fallbacks, you need to decide for your users which wallet they'll use, or make a user interface element to let them select which wallet fallback to use.<a href="https://docs.reach.sh/tut/rps/#p_427" class="pid">427</a></p>
</div>
<p><i id="p_428" class="pid"></i>Similarly, to run with Conflux:<a href="https://docs.reach.sh/tut/rps/#p_428" class="pid">428</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="REACH_CONNECTOR_MODE=CFX ./reach react" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> REACH_CONNECTOR_MODE</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)">CFX ./reach react</span></li></ol></pre>
<div class="note">
  <p>
    <i id="p_429" class="pid"></i>To adapt this example for Conflux TestNet or MainNet,
    you can add this after the imports:<a href="https://docs.reach.sh/tut/rps/#p_429" class="pid">429</a>
  </p>
  <pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="reach.setProviderByName(&#39;TestNet&#39;); // or &#39;MainNet&#39;" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_setProviderByName" title="js: setProviderByName"><span style="color: var(--shiki-token-function)">.setProviderByName</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'TestNet'</span><span style="color: var(--shiki-color-text)">); </span><span style="color: var(--shiki-token-comment)">// or 'MainNet'</span></li></ol></pre>
  <p><i id="p_430" class="pid"></i>For details, see <a href="https://docs.reach.sh/networks/#cfx-faq-mainnet">the Conflux FAQ</a>.<a href="https://docs.reach.sh/tut/rps/#p_430" class="pid">430</a></p>
</div>
<hr>
<p>
  <i id="p_431" class="pid"></i>If you'd like to instead use Reach in your own JavaScript project,
  you can call:<a href="https://docs.reach.sh/tut/rps/#p_431" class="pid">431</a>
</p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="npm install @reach-sh/stdlib" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> npm install @reach</span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">sh/stdlib</span></li></ol></pre>
<div class="note">
  <p>
    <i id="p_432" class="pid"></i>The Reach standard library is undergoing continual improvement and is updated often.
    If you are experiencing issues with the Node.js package, try updating!<a href="https://docs.reach.sh/tut/rps/#p_432" class="pid">432</a>
  </p>
</div>
<p><i id="p_433" class="pid"></i>As usual, you can compile your Reach program <code>index.rsh</code> to the <span class="snip"><a href="https://docs.reach.sh/cout/#js_backend" title="js: backend"><span style="color: var(--shiki-color-text)">backend</span></a></span> build artifact <code>build/index.main.mjs</code> with:<a href="https://docs.reach.sh/tut/rps/#p_433" class="pid">433</a></p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="./reach compile" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-keyword)">$</span><span style="color: var(--shiki-color-text)"> ./reach compile</span></li></ol></pre>
<hr>
<p>
  <i id="p_434" class="pid"></i>Now our implementation of <em>Rock, Paper, Scissors!</em> is live in the browser!
  We can leverage callbacks in the participant interact interface to display to and gather information from the user,
  through any Web UI framework of our choice.<a href="https://docs.reach.sh/tut/rps/#p_434" class="pid">434</a>
</p>
<p>
  <i id="p_435" class="pid"></i>If we wanted to deploy this application to the world, then we would take the static files that React produces and host them on a Web server.
  These files embed your compiled Reach program, so there's nothing more to do than provide them to the world.<a href="https://docs.reach.sh/tut/rps/#p_435" class="pid">435</a>
</p>
<p><i id="p_436" class="pid"></i>In <a href="https://docs.reach.sh/tut/rps/#tut-10">the next section</a>, we'll summarize where we've gone and direct you to the next step of your journey to decentralized application mastery.<a href="https://docs.reach.sh/tut/rps/#p_436" class="pid">436</a></p>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q12">
  <p><i id="p_437" class="pid"></i>Reach integrates with all Web interface libraries, like React, Vue, and so on, because Reach frontends are just normal JavaScript programs.<a href="https://docs.reach.sh/tut/rps/#p_437" class="pid">437</a></p>
  <div class="collapse" id="q12">
    <p><i id="p_438" class="pid"></i>True<a href="https://docs.reach.sh/tut/rps/#p_438" class="pid">438</a></p>
  </div>
</div>
<div class="q-and-a" data-bs-toggle="collapse" aria-expanded="false" href="#q13">
  <p><i id="p_439" class="pid"></i>Reach accelerates your development with React by baking-in a React development server and the deployment process to test React programs locally.<a href="https://docs.reach.sh/tut/rps/#p_439" class="pid">439</a></p>
  <div class="collapse" id="q13">
    <p><i id="p_440" class="pid"></i>True<a href="https://docs.reach.sh/tut/rps/#p_440" class="pid">440</a></p>
  </div>
</div>
<h2 id="tut-10" class="refHeader">Onward and Further<a aria-hidden="true" tabindex="-1" href="https://docs.reach.sh/tut/rps/#tut-10"><span class="icon icon-link"></span></a></h2>
<p><i id="p_441" class="pid"></i>Let's review what we've done through this tutorial:<a href="https://docs.reach.sh/tut/rps/#p_441" class="pid">441</a></p>
<ul>
  <li><i id="p_442" class="pid"></i>In <a href="https://docs.reach.sh/tut/rps/#tut-1">part one</a>, we saw how Reach can be installed with one command on almost any system without any dependencies beyond what most developers have anyways.<a href="https://docs.reach.sh/tut/rps/#p_442" class="pid">442</a></li>
  <li><i id="p_443" class="pid"></i>In <a href="https://docs.reach.sh/tut/rps/#tut-2">part two</a>, we saw how Reach programs have a succinct setup that easily abstracts the details of your chosen consensus network into a couple lines and three key API calls.<a href="https://docs.reach.sh/tut/rps/#p_443" class="pid">443</a></li>
  <li><i id="p_444" class="pid"></i>In <a href="https://docs.reach.sh/tut/rps/#tut-3">part three</a>, we saw how Reach allows developers to focus on the business logic of their decentralized application and look past the nitty-gritty details of blockchain interaction and protocol design.<a href="https://docs.reach.sh/tut/rps/#p_444" class="pid">444</a></li>
  <li><i id="p_445" class="pid"></i>In <a href="https://docs.reach.sh/tut/rps/#tut-4">part four</a>, we saw that it is just as easy for Reach to deal with tokens and network transactions as it is to deal with data sharing.<a href="https://docs.reach.sh/tut/rps/#p_445" class="pid">445</a></li>
  <li><i id="p_446" class="pid"></i>In <a href="https://docs.reach.sh/tut/rps/#tut-5">part five</a>, we introduced you to the Reach <a href="https://docs.reach.sh/guide/assert/#guide-assert">automatic formal verification</a> engine and its ability to ensure our program doesn't have entire categories of flaws and security vulnerabilities.<a href="https://docs.reach.sh/tut/rps/#p_446" class="pid">446</a></li>
  <li><i id="p_447" class="pid"></i>In <a href="https://docs.reach.sh/tut/rps/#tut-6">part six</a>, we saw how Reach allows you to specify how to deal with <a href="https://docs.reach.sh/guide/timeout/#guide-timeout">non-participation</a> and protect against funds being locked in contracts.<a href="https://docs.reach.sh/tut/rps/#p_447" class="pid">447</a></li>
  <li><i id="p_448" class="pid"></i>In <a href="https://docs.reach.sh/tut/rps/#tut-7">part seven</a>, we saw how Reach can express arbitrary length interactions and how flexible the Reach frontends are to variations in the backend.<a href="https://docs.reach.sh/tut/rps/#p_448" class="pid">448</a></li>
  <li><i id="p_449" class="pid"></i>In <a href="https://docs.reach.sh/tut/rps/#tut-8">part eight</a>, we saw how to decouple your Reach program from the Reach standard testing environment and launch an interactive version on a real network.<a href="https://docs.reach.sh/tut/rps/#p_449" class="pid">449</a></li>
  <li><i id="p_450" class="pid"></i>In <a href="https://docs.reach.sh/tut/rps/#tut-9">part nine</a>, we saw how to deploy your Reach program as a fully decentralized Web application.<a href="https://docs.reach.sh/tut/rps/#p_450" class="pid">450</a></li>
</ul>
<p><i id="p_451" class="pid"></i>Despite having done so much, this is really just a brief introduction to what is possible with Reach.<a href="https://docs.reach.sh/tut/rps/#p_451" class="pid">451</a></p>
<p>
  <i id="p_452" class="pid"></i>How difficult was all this?
  Let's look at the final versions of our programs.<a href="https://docs.reach.sh/tut/rps/#p_452" class="pid">452</a>
</p>
<p><i id="p_453" class="pid"></i>First, let's look at the Reach program:<a href="https://docs.reach.sh/tut/rps/#p_453" class="pid">453</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.rsh">/examples/rps-8-interact/index.rsh</a><a class="far fa-copy copyBtn" data-clipboard-text="&#39;reach 0.1&#39;;

const [ isHand, ROCK, PAPER, SCISSORS ] = makeEnum(3);
const [ isOutcome, B_WINS, DRAW, A_WINS ] = makeEnum(3);

const winner = (handAlice, handBob) =&gt;
  ((handAlice + (4 - handBob)) % 3);

assert(winner(ROCK, PAPER) == B_WINS);
assert(winner(PAPER, ROCK) == A_WINS);
assert(winner(ROCK, ROCK) == DRAW);

forall(UInt, handAlice =&gt;
  forall(UInt, handBob =&gt;
    assert(isOutcome(winner(handAlice, handBob)))));

forall(UInt, (hand) =&gt;
  assert(winner(hand, hand) == DRAW));

const Player = {
  ...hasRandom,
  getHand: Fun([], UInt),
  seeOutcome: Fun([UInt], Null),
  informTimeout: Fun([], Null),
};

export const main = Reach.App(() =&gt; {
  const Alice = Participant(&#39;Alice&#39;, {
    ...Player,
    wager: UInt, // atomic units of currency
    deadline: UInt, // time delta (blocks/rounds)
  });
  const Bob   = Participant(&#39;Bob&#39;, {
    ...Player,
    acceptWager: Fun([UInt], Null),
  });
  init();

  const informTimeout = () =&gt; {
    each([Alice, Bob], () =&gt; {
      interact.informTimeout();
    });
  };

  Alice.only(() =&gt; {
    const wager = declassify(interact.wager);
    const deadline = declassify(interact.deadline);
  });
  Alice.publish(wager, deadline)
    .pay(wager);
  commit();

  Bob.only(() =&gt; {
    interact.acceptWager(wager);
  });
  Bob.pay(wager)
    .timeout(relativeTime(deadline), () =&gt; closeTo(Alice, informTimeout));

  var outcome = DRAW;
  invariant( balance() == 2 * wager &amp;&amp; isOutcome(outcome) );
  while ( outcome == DRAW ) {
    commit();

    Alice.only(() =&gt; {
      const _handAlice = interact.getHand();
      const [_commitAlice, _saltAlice] = makeCommitment(interact, _handAlice);
      const commitAlice = declassify(_commitAlice);
    });
    Alice.publish(commitAlice)
      .timeout(relativeTime(deadline), () =&gt; closeTo(Bob, informTimeout));
    commit();

    unknowable(Bob, Alice(_handAlice, _saltAlice));
    Bob.only(() =&gt; {
      const handBob = declassify(interact.getHand());
    });
    Bob.publish(handBob)
      .timeout(relativeTime(deadline), () =&gt; closeTo(Alice, informTimeout));
    commit();

    Alice.only(() =&gt; {
      const saltAlice = declassify(_saltAlice);
      const handAlice = declassify(_handAlice);
    });
    Alice.publish(saltAlice, handAlice)
      .timeout(relativeTime(deadline), () =&gt; closeTo(Bob, informTimeout));
    checkCommitment(commitAlice, saltAlice, handAlice);

    outcome = winner(handAlice, handBob);
    continue;
  }

  assert(outcome == A_WINS || outcome == B_WINS);
  transfer(2 * wager).to(outcome == A_WINS ? Alice : Bob);
  commit();

  each([Alice, Bob], () =&gt; {
    interact.seeOutcome(outcome);
  });
});" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><span style="color: var(--shiki-token-string-expression)">'reach 0.1'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="2"></li><li value="3"><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> [ </span><span style="color: var(--shiki-token-constant)">isHand</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">ROCK</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">PAPER</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">SCISSORS</span><span style="color: var(--shiki-color-text)"> ] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_makeEnum" title="rsh: makeEnum"><span style="color: var(--shiki-token-function)">makeEnum</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></li><li value="4"><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> [ </span><span style="color: var(--shiki-token-constant)">isOutcome</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">B_WINS</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">DRAW</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">A_WINS</span><span style="color: var(--shiki-color-text)"> ] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_makeEnum" title="rsh: makeEnum"><span style="color: var(--shiki-token-function)">makeEnum</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></li><li value="5"></li><li value="6"><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (handAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handBob) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a></li><li value="7"><span style="color: var(--shiki-color-text)">  ((handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_+" title="rsh: +"><span style="color: var(--shiki-token-keyword)">+</span></a><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_-" title="rsh: -"><span style="color: var(--shiki-token-keyword)">-</span></a><span style="color: var(--shiki-color-text)"> handBob)) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%25" title="rsh: %"><span style="color: var(--shiki-token-keyword)">%</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></li><li value="8"></li><li value="9"><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">ROCK</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">PAPER</span><span style="color: var(--shiki-color-text)">) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">B_WINS</span><span style="color: var(--shiki-color-text)">);</span></li><li value="10"><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">PAPER</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">ROCK</span><span style="color: var(--shiki-color-text)">) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">A_WINS</span><span style="color: var(--shiki-color-text)">);</span></li><li value="11"><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">ROCK</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">ROCK</span><span style="color: var(--shiki-color-text)">) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">DRAW</span><span style="color: var(--shiki-color-text)">);</span></li><li value="12"></li><li value="13"><a href="https://docs.reach.sh/rsh/compute/#rsh_forall" title="rsh: forall"><span style="color: var(--shiki-token-function)">forall</span></a><span style="color: var(--shiki-color-text)">(UInt</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handAlice </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a></li><li value="14"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_forall" title="rsh: forall"><span style="color: var(--shiki-token-function)">forall</span></a><span style="color: var(--shiki-color-text)">(UInt</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handBob </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a></li><li value="15"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">isOutcome</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(handAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handBob)))));</span></li><li value="16"></li><li value="17"><a href="https://docs.reach.sh/rsh/compute/#rsh_forall" title="rsh: forall"><span style="color: var(--shiki-token-function)">forall</span></a><span style="color: var(--shiki-color-text)">(UInt</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> (hand) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a></li><li value="18"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(hand</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> hand) </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">DRAW</span><span style="color: var(--shiki-color-text)">));</span></li><li value="19"></li><li value="20"><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Player</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="21"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">...</span><a href="https://docs.reach.sh/rsh/compute/#rsh_hasRandom" title="rsh: hasRandom"><span style="color: var(--shiki-color-text)">hasRandom</span></a><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="22"><span style="color: var(--shiki-color-text)">  getHand</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> UInt)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="23"><span style="color: var(--shiki-color-text)">  seeOutcome</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([UInt]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="24"><span style="color: var(--shiki-color-text)">  informTimeout</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="25"><span style="color: var(--shiki-color-text)">};</span></li><li value="26"></li><li value="27"><a href="https://docs.reach.sh/rsh/module/#rsh_export" title="rsh: export"><span style="color: var(--shiki-token-keyword)">export</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">main</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/module/#rsh_Reach" title="rsh: Reach"><span style="color: var(--shiki-token-constant)">Reach</span></a><a href="https://docs.reach.sh/rsh/module/#rsh_Reach.App" title="rsh: Reach.App"><span style="color: var(--shiki-token-function)">.App</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="28"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Alice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="29"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">Player</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="30"><span style="color: var(--shiki-color-text)">    wager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> UInt</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-comment)">// atomic units of currency</span></li><li value="31"><span style="color: var(--shiki-color-text)">    deadline</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> UInt</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-comment)">// time delta (blocks/rounds)</span></li><li value="32"><span style="color: var(--shiki-color-text)">  });</span></li><li value="33"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Bob</span><span style="color: var(--shiki-color-text)">   </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_Participant" title="rsh: Participant"><span style="color: var(--shiki-token-function)">Participant</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">'Bob'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="34"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">Player</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="35"><span style="color: var(--shiki-color-text)">    acceptWager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_Fun" title="rsh: Fun"><span style="color: var(--shiki-token-function)">Fun</span></a><span style="color: var(--shiki-color-text)">([UInt]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Null)</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="36"><span style="color: var(--shiki-color-text)">  });</span></li><li value="37"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/appinit/#rsh_init" title="rsh: init"><span style="color: var(--shiki-token-function)">init</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="38"></li><li value="39"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">informTimeout</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="40"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_each" title="rsh: each"><span style="color: var(--shiki-token-function)">each</span></a><span style="color: var(--shiki-color-text)">([Alice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Bob]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="41"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.informTimeout</span><span style="color: var(--shiki-color-text)">();</span></li><li value="42"><span style="color: var(--shiki-color-text)">    });</span></li><li value="43"><span style="color: var(--shiki-color-text)">  };</span></li><li value="44"></li><li value="45"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="46"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">wager</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-color-text)">.wager);</span></li><li value="47"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">deadline</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-color-text)">.deadline);</span></li><li value="48"><span style="color: var(--shiki-color-text)">  });</span></li><li value="49"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(wager</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> deadline)</span></li><li value="50"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="51"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="52"></li><li value="53"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="54"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.acceptWager</span><span style="color: var(--shiki-color-text)">(wager);</span></li><li value="55"><span style="color: var(--shiki-color-text)">  });</span></li><li value="56"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_pay" title="rsh: pay"><span style="color: var(--shiki-token-function)">.pay</span></a><span style="color: var(--shiki-color-text)">(wager)</span></li><li value="57"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_timeout" title="rsh: timeout"><span style="color: var(--shiki-token-function)">.timeout</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/compute/#rsh_relativeTime" title="rsh: relativeTime"><span style="color: var(--shiki-token-function)">relativeTime</span></a><span style="color: var(--shiki-color-text)">(deadline)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/step/#rsh_closeTo" title="rsh: closeTo"><span style="color: var(--shiki-token-function)">closeTo</span></a><span style="color: var(--shiki-color-text)">(Alice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> informTimeout));</span></li><li value="58"></li><li value="59"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_var" title="rsh: var"><span style="color: var(--shiki-token-keyword)">var</span></a><span style="color: var(--shiki-color-text)"> outcome </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">DRAW</span><span style="color: var(--shiki-color-text)">;</span></li><li value="60"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_invariant" title="rsh: invariant"><span style="color: var(--shiki-token-function)">invariant</span></a><span style="color: var(--shiki-color-text)">( </span><a href="https://docs.reach.sh/rsh/compute/#rsh_balance" title="rsh: balance"><span style="color: var(--shiki-token-function)">balance</span></a><span style="color: var(--shiki-color-text)">() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_*" title="rsh: *"><span style="color: var(--shiki-token-keyword)">*</span></a><span style="color: var(--shiki-color-text)"> wager </span><a href="https://docs.reach.sh/rsh/compute/#rsh_&amp;&amp;" title="rsh: &amp;&amp;"><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">isOutcome</span><span style="color: var(--shiki-color-text)">(outcome) );</span></li><li value="61"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_while" title="rsh: while"><span style="color: var(--shiki-token-keyword)">while</span></a><span style="color: var(--shiki-color-text)"> ( outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">DRAW</span><span style="color: var(--shiki-color-text)"> ) {</span></li><li value="62"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="63"></li><li value="64"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="65"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">_handAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">();</span></li><li value="66"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-constant)">_commitAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">_saltAlice</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_makeCommitment" title="rsh: makeCommitment"><span style="color: var(--shiki-token-function)">makeCommitment</span></a><span style="color: var(--shiki-color-text)">(interact</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> _handAlice);</span></li><li value="67"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">commitAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(_commitAlice);</span></li><li value="68"><span style="color: var(--shiki-color-text)">    });</span></li><li value="69"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(commitAlice)</span></li><li value="70"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/step/#rsh_timeout" title="rsh: timeout"><span style="color: var(--shiki-token-function)">.timeout</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/compute/#rsh_relativeTime" title="rsh: relativeTime"><span style="color: var(--shiki-token-function)">relativeTime</span></a><span style="color: var(--shiki-color-text)">(deadline)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/step/#rsh_closeTo" title="rsh: closeTo"><span style="color: var(--shiki-token-function)">closeTo</span></a><span style="color: var(--shiki-color-text)">(Bob</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> informTimeout));</span></li><li value="71"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="72"></li><li value="73"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/step/#rsh_unknowable" title="rsh: unknowable"><span style="color: var(--shiki-token-function)">unknowable</span></a><span style="color: var(--shiki-color-text)">(Bob</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Alice</span><span style="color: var(--shiki-color-text)">(_handAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> _saltAlice));</span></li><li value="74"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="75"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handBob</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.getHand</span><span style="color: var(--shiki-color-text)">());</span></li><li value="76"><span style="color: var(--shiki-color-text)">    });</span></li><li value="77"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Bob</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(handBob)</span></li><li value="78"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/step/#rsh_timeout" title="rsh: timeout"><span style="color: var(--shiki-token-function)">.timeout</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/compute/#rsh_relativeTime" title="rsh: relativeTime"><span style="color: var(--shiki-token-function)">relativeTime</span></a><span style="color: var(--shiki-color-text)">(deadline)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/step/#rsh_closeTo" title="rsh: closeTo"><span style="color: var(--shiki-token-function)">closeTo</span></a><span style="color: var(--shiki-color-text)">(Alice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> informTimeout));</span></li><li value="79"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="80"></li><li value="81"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_only" title="rsh: only"><span style="color: var(--shiki-token-function)">.only</span></a><span style="color: var(--shiki-color-text)">(() </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="82"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">saltAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(_saltAlice);</span></li><li value="83"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/compute/#rsh_const" title="rsh: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/local/#rsh_declassify" title="rsh: declassify"><span style="color: var(--shiki-token-function)">declassify</span></a><span style="color: var(--shiki-color-text)">(_handAlice);</span></li><li value="84"><span style="color: var(--shiki-color-text)">    });</span></li><li value="85"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Alice</span><a href="https://docs.reach.sh/rsh/step/#rsh_publish" title="rsh: publish"><span style="color: var(--shiki-token-function)">.publish</span></a><span style="color: var(--shiki-color-text)">(saltAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handAlice)</span></li><li value="86"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/rsh/step/#rsh_timeout" title="rsh: timeout"><span style="color: var(--shiki-token-function)">.timeout</span></a><span style="color: var(--shiki-color-text)">(</span><a href="https://docs.reach.sh/rsh/compute/#rsh_relativeTime" title="rsh: relativeTime"><span style="color: var(--shiki-token-function)">relativeTime</span></a><span style="color: var(--shiki-color-text)">(deadline)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/step/#rsh_closeTo" title="rsh: closeTo"><span style="color: var(--shiki-token-function)">closeTo</span></a><span style="color: var(--shiki-color-text)">(Bob</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> informTimeout));</span></li><li value="87"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_checkCommitment" title="rsh: checkCommitment"><span style="color: var(--shiki-token-function)">checkCommitment</span></a><span style="color: var(--shiki-color-text)">(commitAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> saltAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handAlice);</span></li><li value="88"></li><li value="89"><span style="color: var(--shiki-color-text)">    outcome </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">winner</span><span style="color: var(--shiki-color-text)">(handAlice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> handBob);</span></li><li value="90"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_continue" title="rsh: continue"><span style="color: var(--shiki-token-keyword)">continue</span></a><span style="color: var(--shiki-color-text)">;</span></li><li value="91"><span style="color: var(--shiki-color-text)">  }</span></li><li value="92"></li><li value="93"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/compute/#rsh_assert" title="rsh: assert"><span style="color: var(--shiki-token-function)">assert</span></a><span style="color: var(--shiki-color-text)">(outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">A_WINS</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_%7C%7C" title="rsh: ||"><span style="color: var(--shiki-token-keyword)">||</span></a><span style="color: var(--shiki-color-text)"> outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">B_WINS</span><span style="color: var(--shiki-color-text)">);</span></li><li value="94"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer" title="rsh: transfer"><span style="color: var(--shiki-token-function)">transfer</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_*" title="rsh: *"><span style="color: var(--shiki-token-keyword)">*</span></a><span style="color: var(--shiki-color-text)"> wager)</span><a href="https://docs.reach.sh/rsh/consensus/#rsh_transfer.to" title="rsh: transfer.to"><span style="color: var(--shiki-token-function)">.to</span></a><span style="color: var(--shiki-color-text)">(outcome </span><a href="https://docs.reach.sh/rsh/compute/#rsh_==" title="rsh: =="><span style="color: var(--shiki-token-keyword)">==</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">A_WINS</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/rsh/compute/#rsh_?" title="rsh: ?"><span style="color: var(--shiki-token-keyword)">?</span></a><span style="color: var(--shiki-color-text)"> Alice </span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> Bob);</span></li><li value="95"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/consensus/#rsh_commit" title="rsh: commit"><span style="color: var(--shiki-token-function)">commit</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="96"></li><li value="97"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/rsh/step/#rsh_each" title="rsh: each"><span style="color: var(--shiki-token-function)">each</span></a><span style="color: var(--shiki-color-text)">([Alice</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> Bob]</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><a href="https://docs.reach.sh/rsh/compute/#rsh_=%3E" title="rsh: =&gt;"><span style="color: var(--shiki-token-keyword)">=&gt;</span></a><span style="color: var(--shiki-color-text)"> {</span></li><li value="98"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/rsh/local/#rsh_interact" title="rsh: interact"><span style="color: var(--shiki-token-constant)">interact</span></a><span style="color: var(--shiki-token-function)">.seeOutcome</span><span style="color: var(--shiki-color-text)">(outcome);</span></li><li value="99"><span style="color: var(--shiki-color-text)">  });</span></li><li value="100"><span style="color: var(--shiki-color-text)">});</span></li></ol></pre>
<p><i id="p_454" class="pid"></i>Next, the JavaScript command-line frontend:<a href="https://docs.reach.sh/tut/rps/#p_454" class="pid">454</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/index.mjs">/examples/rps-8-interact/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="import { loadStdlib, ask } from &#39;@reach-sh/stdlib&#39;;
import * as backend from &#39;./build/index.main.mjs&#39;;
const stdlib = loadStdlib();

const isAlice = await ask.ask(
  `Are you Alice?`,
  ask.yesno
);
const who = isAlice ? &#39;Alice&#39; : &#39;Bob&#39;;

console.log(`Starting Rock, Paper, Scissors! as ${who}`);

let acc = null;
const createAcc = await ask.ask(
  `Would you like to create an account? (only possible on devnet)`,
  ask.yesno
);
if (createAcc) {
  acc = await stdlib.newTestAccount(stdlib.parseCurrency(1000));
} else {
  const secret = await ask.ask(
    `What is your account secret?`,
    (x =&gt; x)
  );
  acc = await stdlib.newAccountFromSecret(secret);
}

let ctc = null;
if (isAlice) {
  ctc = acc.contract(backend);
  ctc.getInfo().then((info) =&gt; {
    console.log(`The contract is deployed as = ${JSON.stringify(info)}`); });
} else {
  const info = await ask.ask(
    `Please paste the contract information:`,
    JSON.parse
  );
  ctc = acc.contract(backend, info);
}

const fmt = (x) =&gt; stdlib.formatCurrency(x, 4);
const getBalance = async () =&gt; fmt(await stdlib.balanceOf(acc));

const before = await getBalance();
console.log(`Your balance is ${before}`);

const interact = { ...stdlib.hasRandom };

interact.informTimeout = () =&gt; {
  console.log(`There was a timeout.`);
  process.exit(1);
};

if (isAlice) {
  const amt = await ask.ask(
    `How much do you want to wager?`,
    stdlib.parseCurrency
  );
  interact.wager = amt;
  interact.deadline = { ETH: 100, ALGO: 100, CFX: 1000 }[stdlib.connector];
} else {
  interact.acceptWager = async (amt) =&gt; {
    const accepted = await ask.ask(
      `Do you accept the wager of ${fmt(amt)}?`,
      ask.yesno
    );
    if (!accepted) {
      process.exit(0);
    }
  };
}

const HAND = [&#39;Rock&#39;, &#39;Paper&#39;, &#39;Scissors&#39;];
const HANDS = {
  &#39;Rock&#39;: 0, &#39;R&#39;: 0, &#39;r&#39;: 0,
  &#39;Paper&#39;: 1, &#39;P&#39;: 1, &#39;p&#39;: 1,
  &#39;Scissors&#39;: 2, &#39;S&#39;: 2, &#39;s&#39;: 2,
};

interact.getHand = async () =&gt; {
  const hand = await ask.ask(`What hand will you play?`, (x) =&gt; {
    const hand = HANDS[x];
    if ( hand === undefined ) {
      throw Error(`Not a valid hand ${hand}`);
    }
    return hand;
  });
  console.log(`You played ${HAND[hand]}`);
  return hand;
};

const OUTCOME = [&#39;Bob wins&#39;, &#39;Draw&#39;, &#39;Alice wins&#39;];
interact.seeOutcome = async (outcome) =&gt; {
  console.log(`The outcome is: ${OUTCOME[outcome]}`);
};

const part = isAlice ? ctc.p.Alice : ctc.p.Bob;
await part(interact);

const after = await getBalance();
console.log(`Your balance is now ${after}`);

ask.done();" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> { loadStdlib</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ask } </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'@reach-sh/stdlib'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="2"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">*</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">as</span><span style="color: var(--shiki-color-text)"> backend </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./build/index.main.mjs'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="3"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_loadStdlib" title="js: loadStdlib"><span style="color: var(--shiki-token-function)">loadStdlib</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="4"></li><li value="5"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">isAlice</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask" title="js: ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span></li><li value="6"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">`Are you Alice?`</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="7"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.yesno" title="js: ask.yesno"><span style="color: var(--shiki-color-text)">.yesno</span></a></li><li value="8"><span style="color: var(--shiki-color-text)">);</span></li><li value="9"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">who</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> isAlice </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Alice'</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Bob'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="10"></li><li value="11"><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Starting Rock, Paper, Scissors! as </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">who</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="12"></li><li value="13"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let" title="js: let"><span style="color: var(--shiki-token-keyword)">let</span></a><span style="color: var(--shiki-color-text)"> acc </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">null</span><span style="color: var(--shiki-color-text)">;</span></li><li value="14"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">createAcc</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span></li><li value="15"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">`Would you like to create an account? (only possible on devnet)`</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="16"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.yesno" title="js: ask.yesno"><span style="color: var(--shiki-color-text)">.yesno</span></a></li><li value="17"><span style="color: var(--shiki-color-text)">);</span></li><li value="18"><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (createAcc) {</span></li><li value="19"><span style="color: var(--shiki-color-text)">  acc </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.newTestAccount" title="js: stdlib.newTestAccount"><span style="color: var(--shiki-token-function)">.newTestAccount</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-token-function)">.parseCurrency</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">1000</span><span style="color: var(--shiki-color-text)">));</span></li><li value="20"><span style="color: var(--shiki-color-text)">} </span><span style="color: var(--shiki-token-keyword)">else</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="21"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">secret</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span></li><li value="22"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-string-expression)">`What is your account secret?`</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="23"><span style="color: var(--shiki-color-text)">    (x </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> x)</span></li><li value="24"><span style="color: var(--shiki-color-text)">  );</span></li><li value="25"><span style="color: var(--shiki-color-text)">  acc </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_newAccountFromSecret" title="js: newAccountFromSecret"><span style="color: var(--shiki-token-function)">.newAccountFromSecret</span></a><span style="color: var(--shiki-color-text)">(secret);</span></li><li value="26"><span style="color: var(--shiki-color-text)">}</span></li><li value="27"></li><li value="28"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let" title="js: let"><span style="color: var(--shiki-token-keyword)">let</span></a><span style="color: var(--shiki-color-text)"> ctc </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">null</span><span style="color: var(--shiki-color-text)">;</span></li><li value="29"><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (isAlice) {</span></li><li value="30"><span style="color: var(--shiki-color-text)">  ctc </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-token-constant)">acc</span></a><a href="https://docs.reach.sh/frontend/#js_contract" title="js: contract"><span style="color: var(--shiki-token-function)">.contract</span></a><span style="color: var(--shiki-color-text)">(backend);</span></li><li value="31"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><a href="https://docs.reach.sh/frontend/#js_getInfo" title="js: getInfo"><span style="color: var(--shiki-token-function)">.getInfo</span></a><span style="color: var(--shiki-color-text)">()</span><span style="color: var(--shiki-token-function)">.then</span><span style="color: var(--shiki-color-text)">((info) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="32"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`The contract is deployed as = </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">JSON</span><span style="color: var(--shiki-token-function)">.stringify</span><span style="color: var(--shiki-color-text)">(info)</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">); });</span></li><li value="33"><span style="color: var(--shiki-color-text)">} </span><span style="color: var(--shiki-token-keyword)">else</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="34"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">info</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span></li><li value="35"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-string-expression)">`Please paste the contract information:`</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="36"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">JSON</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">parse</span></li><li value="37"><span style="color: var(--shiki-color-text)">  );</span></li><li value="38"><span style="color: var(--shiki-color-text)">  ctc </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-token-constant)">acc</span></a><a href="https://docs.reach.sh/frontend/#js_contract" title="js: contract"><span style="color: var(--shiki-token-function)">.contract</span></a><span style="color: var(--shiki-color-text)">(backend</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> info);</span></li><li value="39"><span style="color: var(--shiki-color-text)">}</span></li><li value="40"></li><li value="41"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">fmt</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> (x) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_formatCurrency" title="js: formatCurrency"><span style="color: var(--shiki-token-function)">.formatCurrency</span></a><span style="color: var(--shiki-color-text)">(x</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)">);</span></li><li value="42"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getBalance</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">fmt</span><span style="color: var(--shiki-color-text)">(</span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_stdlib.balanceOf" title="js: stdlib.balanceOf"><span style="color: var(--shiki-token-function)">.balanceOf</span></a><span style="color: var(--shiki-color-text)">(acc));</span></li><li value="43"></li><li value="44"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">before</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getBalance</span><span style="color: var(--shiki-color-text)">();</span></li><li value="45"><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Your balance is </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">before</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="46"></li><li value="47"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> { </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-constant)">stdlib</span><span style="color: var(--shiki-color-text)">.hasRandom };</span></li><li value="48"></li><li value="49"><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">informTimeout</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="50"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`There was a timeout.`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="51"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">process</span><span style="color: var(--shiki-token-function)">.exit</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">);</span></li><li value="52"><span style="color: var(--shiki-color-text)">};</span></li><li value="53"></li><li value="54"><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (isAlice) {</span></li><li value="55"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">amt</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span></li><li value="56"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-string-expression)">`How much do you want to wager?`</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="57"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">stdlib</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-color-text)">.parseCurrency</span></a></li><li value="58"><span style="color: var(--shiki-color-text)">  );</span></li><li value="59"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)">.wager </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> amt;</span></li><li value="60"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)">.deadline </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> { ETH</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ALGO</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> CFX</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1000</span><span style="color: var(--shiki-color-text)"> }[</span><span style="color: var(--shiki-token-constant)">stdlib</span><span style="color: var(--shiki-color-text)">.connector];</span></li><li value="61"><span style="color: var(--shiki-color-text)">} </span><span style="color: var(--shiki-token-keyword)">else</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="62"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">acceptWager</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> (amt) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="63"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">accepted</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span></li><li value="64"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-string-expression)">`Do you accept the wager of </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-function)">fmt</span><span style="color: var(--shiki-color-text)">(amt)</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">?`</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="65"><span style="color: var(--shiki-color-text)">      </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.yesno" title="js: ask.yesno"><span style="color: var(--shiki-color-text)">.yesno</span></a></li><li value="66"><span style="color: var(--shiki-color-text)">    );</span></li><li value="67"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">!</span><span style="color: var(--shiki-color-text)">accepted) {</span></li><li value="68"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">process</span><span style="color: var(--shiki-token-function)">.exit</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">);</span></li><li value="69"><span style="color: var(--shiki-color-text)">    }</span></li><li value="70"><span style="color: var(--shiki-color-text)">  };</span></li><li value="71"><span style="color: var(--shiki-color-text)">}</span></li><li value="72"></li><li value="73"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">HAND</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-string-expression)">'Rock'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Paper'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Scissors'</span><span style="color: var(--shiki-color-text)">];</span></li><li value="74"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">HANDS</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="75"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">'Rock'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'R'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'r'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="76"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">'Paper'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'P'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'p'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="77"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">'Scissors'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'S'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'s'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span></li><li value="78"><span style="color: var(--shiki-color-text)">};</span></li><li value="79"></li><li value="80"><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">getHand</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="81"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">hand</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-function)">.ask</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`What hand will you play?`</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> (x) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="82"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">hand</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">HANDS</span><span style="color: var(--shiki-color-text)">[x];</span></li><li value="83"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> ( hand </span><span style="color: var(--shiki-token-keyword)">===</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">undefined</span><span style="color: var(--shiki-color-text)"> ) {</span></li><li value="84"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-keyword)">throw</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Error</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Not a valid hand </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">hand</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="85"><span style="color: var(--shiki-color-text)">    }</span></li><li value="86"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> hand;</span></li><li value="87"><span style="color: var(--shiki-color-text)">  });</span></li><li value="88"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`You played </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">HAND</span><span style="color: var(--shiki-color-text)">[hand]</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="89"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> hand;</span></li><li value="90"><span style="color: var(--shiki-color-text)">};</span></li><li value="91"></li><li value="92"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">OUTCOME</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-string-expression)">'Bob wins'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Draw'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Alice wins'</span><span style="color: var(--shiki-color-text)">];</span></li><li value="93"><span style="color: var(--shiki-token-constant)">interact</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">seeOutcome</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> (outcome) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="94"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`The outcome is: </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-token-constant)">OUTCOME</span><span style="color: var(--shiki-color-text)">[outcome]</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="95"><span style="color: var(--shiki-color-text)">};</span></li><li value="96"></li><li value="97"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">part</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> isAlice </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><span style="color: var(--shiki-color-text)">.</span><a href="https://docs.reach.sh/frontend/#js_ctc.p" title="js: ctc.p"><span style="color: var(--shiki-token-constant)">p</span></a><span style="color: var(--shiki-color-text)">.Alice </span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><span style="color: var(--shiki-color-text)">.</span><a href="https://docs.reach.sh/frontend/#js_ctc.p" title="js: ctc.p"><span style="color: var(--shiki-token-constant)">p</span></a><span style="color: var(--shiki-color-text)">.Bob;</span></li><li value="98"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">part</span><span style="color: var(--shiki-color-text)">(interact);</span></li><li value="99"></li><li value="100"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">after</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getBalance</span><span style="color: var(--shiki-color-text)">();</span></li><li value="101"><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">`Your balance is now </span><span style="color: var(--shiki-token-keyword)">${</span><span style="color: var(--shiki-color-text)">after</span><span style="color: var(--shiki-token-keyword)">}</span><span style="color: var(--shiki-token-string-expression)">`</span><span style="color: var(--shiki-color-text)">);</span></li><li value="102"></li><li value="103"><a href="https://docs.reach.sh/frontend/#js_ask.ask" title="js: ask.ask"><span style="color: var(--shiki-token-constant)">ask</span></a><a href="https://docs.reach.sh/frontend/#js_ask.done" title="js: ask.done"><span style="color: var(--shiki-token-function)">.done</span></a><span style="color: var(--shiki-color-text)">();</span></li></ol></pre>
<p><i id="p_455" class="pid"></i>And finally, the Web frontend:<a href="https://docs.reach.sh/tut/rps/#p_455" class="pid">455</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-9-web/index.js">/examples/rps-9-web/index.js</a><a class="far fa-copy copyBtn" data-clipboard-text="import React from &#39;react&#39;;
import AppViews from &#39;./views/AppViews&#39;;
import DeployerViews from &#39;./views/DeployerViews&#39;;
import AttacherViews from &#39;./views/AttacherViews&#39;;
import {renderDOM, renderView} from &#39;./views/render&#39;;
import &#39;./index.css&#39;;
import * as backend from &#39;./build/index.main.mjs&#39;;
import { loadStdlib } from &#39;@reach-sh/stdlib&#39;;
const reach = loadStdlib(process.env);

const handToInt = {&#39;ROCK&#39;: 0, &#39;PAPER&#39;: 1, &#39;SCISSORS&#39;: 2};
const intToOutcome = [&#39;Bob wins!&#39;, &#39;Draw!&#39;, &#39;Alice wins!&#39;];
const {standardUnit} = reach;
const defaults = {defaultFundAmt: &#39;10&#39;, defaultWager: &#39;3&#39;, standardUnit};

class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {view: &#39;ConnectAccount&#39;, ...defaults};
  }
  async componentDidMount() {
    const acc = await reach.getDefaultAccount();
    const balAtomic = await reach.balanceOf(acc);
    const bal = reach.formatCurrency(balAtomic, 4);
    this.setState({acc, bal});
    if (await reach.canFundFromFaucet()) {
      this.setState({view: &#39;FundAccount&#39;});
    } else {
      this.setState({view: &#39;DeployerOrAttacher&#39;});
    }
  }
  async fundAccount(fundAmount) {
    await reach.fundFromFaucet(this.state.acc, reach.parseCurrency(fundAmount));
    this.setState({view: &#39;DeployerOrAttacher&#39;});
  }
  async skipFundAccount() { this.setState({view: &#39;DeployerOrAttacher&#39;}); }
  selectAttacher() { this.setState({view: &#39;Wrapper&#39;, ContentView: Attacher}); }
  selectDeployer() { this.setState({view: &#39;Wrapper&#39;, ContentView: Deployer}); }
  render() { return renderView(this, AppViews); }
}

class Player extends React.Component {
  random() { return reach.hasRandom.random(); }
  async getHand() { // Fun([], UInt)
    const hand = await new Promise(resolveHandP =&gt; {
      this.setState({view: &#39;GetHand&#39;, playable: true, resolveHandP});
    });
    this.setState({view: &#39;WaitingForResults&#39;, hand});
    return handToInt[hand];
  }
  seeOutcome(i) { this.setState({view: &#39;Done&#39;, outcome: intToOutcome[i]}); }
  informTimeout() { this.setState({view: &#39;Timeout&#39;}); }
  playHand(hand) { this.state.resolveHandP(hand); }
}

class Deployer extends Player {
  constructor(props) {
    super(props);
    this.state = {view: &#39;SetWager&#39;};
  }
  setWager(wager) { this.setState({view: &#39;Deploy&#39;, wager}); }
  async deploy() {
    const ctc = this.props.acc.contract(backend);
    this.setState({view: &#39;Deploying&#39;, ctc});
    this.wager = reach.parseCurrency(this.state.wager); // UInt
    this.deadline = {ETH: 10, ALGO: 100, CFX: 1000}[reach.connector]; // UInt
    backend.Alice(ctc, this);
    const ctcInfoStr = JSON.stringify(await ctc.getInfo(), null, 2);
    this.setState({view: &#39;WaitingForAttacher&#39;, ctcInfoStr});
  }
  render() { return renderView(this, DeployerViews); }
}
class Attacher extends Player {
  constructor(props) {
    super(props);
    this.state = {view: &#39;Attach&#39;};
  }
  attach(ctcInfoStr) {
    const ctc = this.props.acc.contract(backend, JSON.parse(ctcInfoStr));
    this.setState({view: &#39;Attaching&#39;});
    backend.Bob(ctc, this);
  }
  async acceptWager(wagerAtomic) { // Fun([UInt], Null)
    const wager = reach.formatCurrency(wagerAtomic, 4);
    return await new Promise(resolveAcceptedP =&gt; {
      this.setState({view: &#39;AcceptTerms&#39;, wager, resolveAcceptedP});
    });
  }
  termsAccepted() {
    this.state.resolveAcceptedP();
    this.setState({view: &#39;WaitingForTurn&#39;});
  }
  render() { return renderView(this, AttacherViews); }
}

renderDOM(&lt;App /&gt;);" href="https://docs.reach.sh/tut/rps/#"></a></div><ol class="snippet"><li value="1"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> React </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'react'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="2"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> AppViews </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./views/AppViews'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="3"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> DeployerViews </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./views/DeployerViews'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="4"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> AttacherViews </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./views/AttacherViews'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="5"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> {renderDOM</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> renderView} </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./views/render'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="6"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./index.css'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="7"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">*</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">as</span><span style="color: var(--shiki-color-text)"> backend </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'./build/index.main.mjs'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="8"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" title="js: import"><span style="color: var(--shiki-token-keyword)">import</span></a><span style="color: var(--shiki-color-text)"> { loadStdlib } </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'@reach-sh/stdlib'</span><span style="color: var(--shiki-color-text)">;</span></li><li value="9"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_loadStdlib" title="js: loadStdlib"><span style="color: var(--shiki-token-function)">loadStdlib</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">process</span><span style="color: var(--shiki-color-text)">.env);</span></li><li value="10"></li><li value="11"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">handToInt</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {</span><span style="color: var(--shiki-token-string-expression)">'ROCK'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'PAPER'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'SCISSORS'</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">};</span></li><li value="12"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">intToOutcome</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-string-expression)">'Bob wins!'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Draw!'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Alice wins!'</span><span style="color: var(--shiki-color-text)">];</span></li><li value="13"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> {</span><a href="https://docs.reach.sh/frontend/#js_standardUnit" title="js: standardUnit"><span style="color: var(--shiki-token-constant)">standardUnit</span></a><span style="color: var(--shiki-color-text)">} </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> reach;</span></li><li value="14"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">defaults</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {defaultFundAmt</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'10'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> defaultWager</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'3'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> standardUnit};</span></li><li value="15"></li><li value="16"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">App</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">React</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">Component</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="17"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/tut/rps/undefined" title="undefined"><span style="color: var(--shiki-token-keyword)">constructor</span></a><span style="color: var(--shiki-color-text)">(props) {</span></li><li value="18"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">super</span><span style="color: var(--shiki-color-text)">(props);</span></li><li value="19"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.state </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'ConnectAccount'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">defaults};</span></li><li value="20"><span style="color: var(--shiki-color-text)">  }</span></li><li value="21"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://reactjs.org/docs/react-component.html#componentdidmount" title="js: componentDidMount"><span style="color: var(--shiki-token-function)">componentDidMount</span></a><span style="color: var(--shiki-color-text)">() {</span></li><li value="22"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-token-constant)">acc</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_getDefaultAccount" title="js: getDefaultAccount"><span style="color: var(--shiki-token-function)">.getDefaultAccount</span></a><span style="color: var(--shiki-color-text)">();</span></li><li value="23"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">balAtomic</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_acc.balanceOf" title="js: acc.balanceOf"><span style="color: var(--shiki-token-function)">.balanceOf</span></a><span style="color: var(--shiki-color-text)">(acc);</span></li><li value="24"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">bal</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_formatCurrency" title="js: formatCurrency"><span style="color: var(--shiki-token-function)">.formatCurrency</span></a><span style="color: var(--shiki-color-text)">(balAtomic</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)">);</span></li><li value="25"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({acc</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> bal});</span></li><li value="26"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_canFundFromFaucet" title="js: canFundFromFaucet"><span style="color: var(--shiki-token-function)">.canFundFromFaucet</span></a><span style="color: var(--shiki-color-text)">()) {</span></li><li value="27"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'FundAccount'</span><span style="color: var(--shiki-color-text)">});</span></li><li value="28"><span style="color: var(--shiki-color-text)">    } </span><span style="color: var(--shiki-token-keyword)">else</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="29"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'DeployerOrAttacher'</span><span style="color: var(--shiki-color-text)">});</span></li><li value="30"><span style="color: var(--shiki-color-text)">    }</span></li><li value="31"><span style="color: var(--shiki-color-text)">  }</span></li><li value="32"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">fundAccount</span><span style="color: var(--shiki-color-text)">(fundAmount) {</span></li><li value="33"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_fundFromFaucet" title="js: fundFromFaucet"><span style="color: var(--shiki-token-function)">.fundFromFaucet</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">state</span><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-color-text)">.acc</span></a><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-token-function)">.parseCurrency</span></a><span style="color: var(--shiki-color-text)">(fundAmount));</span></li><li value="34"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'DeployerOrAttacher'</span><span style="color: var(--shiki-color-text)">});</span></li><li value="35"><span style="color: var(--shiki-color-text)">  }</span></li><li value="36"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">skipFundAccount</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'DeployerOrAttacher'</span><span style="color: var(--shiki-color-text)">}); }</span></li><li value="37"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">selectAttacher</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Wrapper'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ContentView</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> Attacher}); }</span></li><li value="38"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">selectDeployer</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Wrapper'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ContentView</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> Deployer}); }</span></li><li value="39"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">render</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">renderView</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> AppViews); }</span></li><li value="40"><span style="color: var(--shiki-color-text)">}</span></li><li value="41"></li><li value="42"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">React</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">Component</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="43"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">random</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><span style="color: var(--shiki-token-function)">.</span><a href="https://docs.reach.sh/frontend/#js_hasRandom" title="js: hasRandom"><span style="color: var(--shiki-token-constant)">hasRandom</span></a><span style="color: var(--shiki-token-function)">.random</span><span style="color: var(--shiki-color-text)">(); }</span></li><li value="44"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getHand</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-comment)">// Fun([], UInt)</span></li><li value="45"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">hand</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Promise</span><span style="color: var(--shiki-color-text)">(resolveHandP </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="46"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'GetHand'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> playable</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">true</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> resolveHandP});</span></li><li value="47"><span style="color: var(--shiki-color-text)">    });</span></li><li value="48"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'WaitingForResults'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> hand});</span></li><li value="49"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> handToInt[hand];</span></li><li value="50"><span style="color: var(--shiki-color-text)">  }</span></li><li value="51"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">seeOutcome</span><span style="color: var(--shiki-color-text)">(i) { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Done'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> outcome</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> intToOutcome[i]}); }</span></li><li value="52"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">informTimeout</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Timeout'</span><span style="color: var(--shiki-color-text)">}); }</span></li><li value="53"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">playHand</span><span style="color: var(--shiki-color-text)">(hand) { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">state</span><span style="color: var(--shiki-token-function)">.resolveHandP</span><span style="color: var(--shiki-color-text)">(hand); }</span></li><li value="54"><span style="color: var(--shiki-color-text)">}</span></li><li value="55"></li><li value="56"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Deployer</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="57"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/tut/rps/undefined" title="undefined"><span style="color: var(--shiki-token-keyword)">constructor</span></a><span style="color: var(--shiki-color-text)">(props) {</span></li><li value="58"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">super</span><span style="color: var(--shiki-color-text)">(props);</span></li><li value="59"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.state </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'SetWager'</span><span style="color: var(--shiki-color-text)">};</span></li><li value="60"><span style="color: var(--shiki-color-text)">  }</span></li><li value="61"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">setWager</span><span style="color: var(--shiki-color-text)">(wager) { </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Deploy'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> wager}); }</span></li><li value="62"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_deploy" title="js: deploy"><span style="color: var(--shiki-token-function)">deploy</span></a><span style="color: var(--shiki-color-text)">() {</span></li><li value="63"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">props</span><span style="color: var(--shiki-token-function)">.</span><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-token-constant)">acc</span></a><a href="https://docs.reach.sh/frontend/#js_contract" title="js: contract"><span style="color: var(--shiki-token-function)">.contract</span></a><span style="color: var(--shiki-color-text)">(backend);</span></li><li value="64"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Deploying'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ctc});</span></li><li value="65"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.wager </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_parseCurrency" title="js: parseCurrency"><span style="color: var(--shiki-token-function)">.parseCurrency</span></a><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">state</span><span style="color: var(--shiki-color-text)">.wager); </span><span style="color: var(--shiki-token-comment)">// UInt</span></li><li value="66"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.deadline </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {ETH</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ALGO</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">100</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> CFX</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1000</span><span style="color: var(--shiki-color-text)">}[</span><span style="color: var(--shiki-token-constant)">reach</span><span style="color: var(--shiki-color-text)">.connector]; </span><span style="color: var(--shiki-token-comment)">// UInt</span></li><li value="67"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/cout/#js_backend" title="js: backend"><span style="color: var(--shiki-token-constant)">backend</span></a><span style="color: var(--shiki-token-function)">.Alice</span><span style="color: var(--shiki-color-text)">(ctc</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">);</span></li><li value="68"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">ctcInfoStr</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">JSON</span><span style="color: var(--shiki-token-function)">.stringify</span><span style="color: var(--shiki-color-text)">(</span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><a href="https://docs.reach.sh/frontend/#js_getInfo" title="js: getInfo"><span style="color: var(--shiki-token-function)">.getInfo</span></a><span style="color: var(--shiki-color-text)">()</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">null</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">);</span></li><li value="69"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'WaitingForAttacher'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ctcInfoStr});</span></li><li value="70"><span style="color: var(--shiki-color-text)">  }</span></li><li value="71"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">render</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">renderView</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> DeployerViews); }</span></li><li value="72"><span style="color: var(--shiki-color-text)">}</span></li><li value="73"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Attacher</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Player</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="74"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/tut/rps/undefined" title="undefined"><span style="color: var(--shiki-token-keyword)">constructor</span></a><span style="color: var(--shiki-color-text)">(props) {</span></li><li value="75"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">super</span><span style="color: var(--shiki-color-text)">(props);</span></li><li value="76"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.state </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> {view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Attach'</span><span style="color: var(--shiki-color-text)">};</span></li><li value="77"><span style="color: var(--shiki-color-text)">  }</span></li><li value="78"><span style="color: var(--shiki-color-text)">  </span><a href="https://docs.reach.sh/frontend/#js_attach" title="js: attach"><span style="color: var(--shiki-token-function)">attach</span></a><span style="color: var(--shiki-color-text)">(ctcInfoStr) {</span></li><li value="79"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><a href="https://docs.reach.sh/frontend/#js_ctc" title="js: ctc"><span style="color: var(--shiki-token-constant)">ctc</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">props</span><span style="color: var(--shiki-token-function)">.</span><a href="https://docs.reach.sh/frontend/#js_acc" title="js: acc"><span style="color: var(--shiki-token-constant)">acc</span></a><a href="https://docs.reach.sh/frontend/#js_contract" title="js: contract"><span style="color: var(--shiki-token-function)">.contract</span></a><span style="color: var(--shiki-color-text)">(backend</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">JSON</span><span style="color: var(--shiki-token-function)">.parse</span><span style="color: var(--shiki-color-text)">(ctcInfoStr));</span></li><li value="80"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'Attaching'</span><span style="color: var(--shiki-color-text)">});</span></li><li value="81"><span style="color: var(--shiki-color-text)">    </span><a href="https://docs.reach.sh/cout/#js_backend" title="js: backend"><span style="color: var(--shiki-token-constant)">backend</span></a><span style="color: var(--shiki-token-function)">.Bob</span><span style="color: var(--shiki-color-text)">(ctc</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">);</span></li><li value="82"><span style="color: var(--shiki-color-text)">  }</span></li><li value="83"><span style="color: var(--shiki-color-text)">  </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="js: async"><span style="color: var(--shiki-token-keyword)">async</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">acceptWager</span><span style="color: var(--shiki-color-text)">(wagerAtomic) { </span><span style="color: var(--shiki-token-comment)">// Fun([UInt], Null)</span></li><li value="84"><span style="color: var(--shiki-color-text)">    </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" title="js: const"><span style="color: var(--shiki-token-keyword)">const</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">wager</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">reach</span><a href="https://docs.reach.sh/frontend/#js_formatCurrency" title="js: formatCurrency"><span style="color: var(--shiki-token-function)">.formatCurrency</span></a><span style="color: var(--shiki-color-text)">(wagerAtomic</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)">);</span></li><li value="85"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" title="js: await"><span style="color: var(--shiki-token-keyword)">await</span></a><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Promise</span><span style="color: var(--shiki-color-text)">(resolveAcceptedP </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></li><li value="86"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'AcceptTerms'</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> wager</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> resolveAcceptedP});</span></li><li value="87"><span style="color: var(--shiki-color-text)">    });</span></li><li value="88"><span style="color: var(--shiki-color-text)">  }</span></li><li value="89"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">termsAccepted</span><span style="color: var(--shiki-color-text)">() {</span></li><li value="90"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">state</span><span style="color: var(--shiki-token-function)">.resolveAcceptedP</span><span style="color: var(--shiki-color-text)">();</span></li><li value="91"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setState</span><span style="color: var(--shiki-color-text)">({view</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">'WaitingForTurn'</span><span style="color: var(--shiki-color-text)">});</span></li><li value="92"><span style="color: var(--shiki-color-text)">  }</span></li><li value="93"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">render</span><span style="color: var(--shiki-color-text)">() { </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">renderView</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> AttacherViews); }</span></li><li value="94"><span style="color: var(--shiki-color-text)">}</span></li><li value="95"></li><li value="96"><span style="color: var(--shiki-token-function)">renderDOM</span><span style="color: var(--shiki-color-text)">(&lt;</span><span style="color: var(--shiki-token-constant)">App</span><span style="color: var(--shiki-color-text)"> /&gt;);</span></li></ol></pre>
<p>
  <i id="p_456" class="pid"></i>We wrote about a hundred lines of Reach and two different frontends.
  Our command-line version is about a hundred lines of JavaScript, while our Web version is about the same length, but has a lot of presentation code as well.<a href="https://docs.reach.sh/tut/rps/#p_456" class="pid">456</a>
</p>
<p>
  <i id="p_457" class="pid"></i>Behind the scenes, Reach generated hundreds of lines of Solidity (which you can look at here: <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/build/index.main.sol"><code>rps-8-interact/build/index.main.sol</code></a>), almost two thousand lines of TEAL (which you can look at here: <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/build/index.main.appApproval.teal"><code>rps-8-interact/build/index.main.appApproval.teal</code></a>), as well as over a thousand lines of JavaScript (which you can look at here: <a href="https://github.com/reach-sh/reach-lang/tree/master/examples/rps-8-interact/build/index.main.mjs"><code>rps-8-interact/build/index.main.mjs</code></a>).
  If we weren't using Reach, then we'd have to write all this code ourselves and ensure that they are consistent and updated at every change to the application.<a href="https://docs.reach.sh/tut/rps/#p_457" class="pid">457</a>
</p>
<p><i id="p_458" class="pid"></i>Now that you've seen an entire Reach application from beginning to end, it's time for you to start working on your own applications!<a href="https://docs.reach.sh/tut/rps/#p_458" class="pid">458</a></p>
<ul>
  <li><i id="p_459" class="pid"></i>You may want to start <a href="https://docs.reach.sh/workshop/#workshop">the workshop</a>, which is a self-study course on practicing and learning Reach through different specific projects.<a href="https://docs.reach.sh/tut/rps/#p_459" class="pid">459</a></li>
  <li><i id="p_460" class="pid"></i>Or, maybe you'd like to spend some time in <a href="https://docs.reach.sh/guide/#guide">the guide</a> learning about the background of some of the concepts used in Reach programs.<a href="https://docs.reach.sh/tut/rps/#p_460" class="pid">460</a></li>
  <li><i id="p_461" class="pid"></i>Or, maybe it's time for you to dive into <a href="https://docs.reach.sh/tool/#ref">the reference</a> and look into the minutiae of Reach's features.<a href="https://docs.reach.sh/tut/rps/#p_461" class="pid">461</a></li>
  <li><i id="p_462" class="pid"></i>Finally, you may like to repeat a portion of this tutorial, but using <a href="https://docs.reach.sh/tut/rps/7-rpc/#tut-7-rpc">a language other than JavaScript</a>, like Python or Go!<a href="https://docs.reach.sh/tut/rps/#p_462" class="pid">462</a></li>
</ul>
<p>
  <i id="p_463" class="pid"></i>No matter what you decide to read or work on next, we hope you'll join us on <a href="https://discord.gg/AZsgcXu">the Discord community</a>.
  Once you join, message <code>@team, I just completed the tutorial!</code> and we'll give you the <code>tutorial veteran</code> role, so you can more easily help others work through it!<a href="https://docs.reach.sh/tut/rps/#p_463" class="pid">463</a>
</p>
<p><i id="p_464" class="pid"></i>Thanks for spending your afternoon with us!<a href="https://docs.reach.sh/tut/rps/#p_464" class="pid">464</a></p></div></div></div><div id="otp-col" class="col display" style="display: none; max-width: 280px;"><ul><li class="active top"><div class="row"><div class="col my-auto"><a href="https://docs.reach.sh/tut/rps/#on-this-page" class="otp-link">On This Page</a></div><div class="col-auto my-auto"><button class="btn btn-outline-secondary btn-sm hide-otp-icon" onclick="setItemToNone(event,&quot;otp-col&quot;)"><img alt="close right sidebar" src="./Reach _ Rock, Paper, Scissors!_files/Colorway=Dark Mode, State=Hover, Action=Expand.svg"></button></div></div><ul class="dynamic">
      <li class="dynamic">
        <a href="https://docs.reach.sh/tut/rps/#tut-1" class="">Install and Initialize</a>
      </li>
      <li class="dynamic">
        <a href="https://docs.reach.sh/tut/rps/#tut-2" class="">Scaffolding and Setup</a>
      </li>
      <li class="dynamic">
        <a href="https://docs.reach.sh/tut/rps/#tut-3" class="">Rock, Paper, and Scissors</a>
      </li>
      <li class="dynamic">
        <a href="https://docs.reach.sh/tut/rps/#tut-4" class="">Bets and Wagers</a>
      </li>
      <li class="dynamic">
        <a href="https://docs.reach.sh/tut/rps/#tut-5" class="">Trust and Commitments</a>
      </li>
      <li class="dynamic">
        <a href="https://docs.reach.sh/tut/rps/#tut-6" class="">Timeouts and Participation</a>
      </li>
      <li class="dynamic">
        <a href="https://docs.reach.sh/tut/rps/#tut-7" class="">Play and Play Again</a>
      </li>
      <li class="dynamic">
        <a href="https://docs.reach.sh/tut/rps/#tut-8" class="">Interaction and Independence</a>
      </li>
      <li class="dynamic">
        <a href="https://docs.reach.sh/tut/rps/#tut-9" class="">Web Interaction</a>
        <ul class="dynamic">
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-App" class="">Application component</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-ConnectAccount" class="">Connect Account dialog</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-FundAccount" class="">Fund Account dialog</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-DeployerOrAttacher" class="">Choose Role</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-Player" class="">Player component</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-GetHand" class="">Get Hand dialog</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-WaitingForResults" class="">Waiting for results display</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-Done" class="">Done display</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-Timeout" class="">Timeout display</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-Deployer" class="">Deployer component</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-SetWager" class="">Set Wager dialog</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-Deploy" class="">Deploy dialog</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-Deploying" class="">Deploying display</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-WaitingForAttacher" class="">Waiting for Attacher display</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-Attacher" class="">Attacher component</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-Attach" class="">Attach dialog</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-Attaching" class="">Attaching display</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-AcceptTerms" class="">Accept Terms dialog</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-WaitingForTurn" class="">Waiting for Turn display</a></li>
          <li class="dynamic"><a href="https://docs.reach.sh/tut/rps/#tut-9-Final" class="">Putting it all together</a></li>
        </ul>
      </li>
      <li class="dynamic">
        <a href="https://docs.reach.sh/tut/rps/#tut-10" class="active">Onward and Further</a>
      </li>
    </ul></li></ul></div></main><script src="https://cdn.jsdelivr.net/npm/axios@0.24.0/dist/axios.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script><script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.5.1/dist/algoliasearch-lite.umd.js" integrity="sha256-EXPXz4W6pQgfYY3yTpnDa3OH8/EPn16ciVsPQ/ypsjk=" crossorigin="anonymous"></script><script src="./Reach _ Rock, Paper, Scissors!_files/scripts.js" type="module"></script></body></html>